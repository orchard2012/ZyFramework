2014-01-21 00:01:01,649 [16292] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:01:02,073 [16292] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:01:02,075 [16292] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:01:02,079 [16292] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:01:02,079 [16292] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:01:21,136 [16708] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:01:21,150 [16708] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:01:21,150 [16708] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:01:21,153 [16708] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:01:21,153 [16708] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:01:21,183 [18384] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:01:21,185 [18384] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:01:21,186 [18384] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:01:21,187 [18384] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:01:21,187 [18384] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:01:34,292 [16120] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:01:34,292 [16120] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:01:34,319 [16120] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:04:28,294 [15004] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:04:28,295 [15004] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:04:28,374 [17568] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:08:10,056 [16120] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:10:06,846 [16772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-21 00:10:06,918 [16772] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:10:06,919 [16772] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:10:06,921 [16772] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:10:06,922 [16772] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-21 00:10:06,924 [16772] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:10:06,924 [16772] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-21 00:10:37,578 [16772] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-21 00:10:37,580 [16772] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2014-01-21 00:10:37,610 [16772] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-21 00:10:37,611 [16772] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2014-01-21 00:10:38,654 [18348] DEBUG Servicemms_send - 获取动态列表
2014-01-21 00:10:38,654 [18348] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:10:38,716 [18348] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:12:02,195 [18600] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:12:02,212 [18600] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:12:02,214 [18600] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:12:02,217 [18600] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:12:02,217 [18600] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:12:02,752 [17176] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:12:02,756 [17176] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:12:02,774 [17176] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:13:01,060 [16292] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-21 00:13:01,066 [16292] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:13:01,066 [16292] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:13:01,067 [16292] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:13:01,068 [16292] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-21 00:13:01,068 [16292] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:13:01,068 [16292] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-21 00:13:01,093 [16292] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-21 00:13:01,094 [16292] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2014-01-21 00:13:01,095 [16292] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-21 00:13:01,099 [16292] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2014-01-21 00:13:01,672 [16292] DEBUG Servicemms_send - 获取动态列表
2014-01-21 00:13:01,672 [16292] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:13:01,680 [16292] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:17:18,132 [19316] DEBUG Servicemms_send - 获取动态列表
2014-01-21 00:17:18,132 [19316] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:17:18,134 [19316] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:17:50,362 [18872] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:17:50,367 [18872] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:17:50,367 [18872] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:17:50,367 [18872] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:17:50,368 [18872] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:17:50,930 [19316] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:17:50,930 [19316] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:17:50,934 [19316] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:18:12,367 [18872] DEBUG Servicemms_receive - 删除记录
2014-01-21 00:18:12,371 [18872] DEBUG Mms - delete from mms_receiveDetail where [BillNo] = '201307290001'
2014-01-21 00:18:12,504 [18872] DEBUG Mms - delete from mms_receive where  BillNo =  '201307290001'
2014-01-21 00:18:13,015 [16700] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:18:13,065 [16700] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:18:13,067 [16700] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:19:14,325 [16796] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:19:14,325 [16796] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 00:19:14,329 [16796] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 00:19:14,337 [16796] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/21 0:19:14')
2014-01-21 00:19:14,407 [16796] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:19:14,407 [16796] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:19:14,438 [16700] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 00:19:14,916 [19316] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:19:18,646 [16700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:19:18,660 [16700] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:19:18,660 [16700] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:19:18,663 [16700] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:19:18,665 [16700] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:19:29,850 [11408] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:19:29,854 [11408] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:19:29,854 [11408] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:19:29,858 [11408] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:19:29,858 [11408] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:19:30,884 [17172] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:19:30,889 [17172] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:19:30,889 [17172] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:19:30,889 [17172] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:19:30,889 [17172] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:19:45,007 [11408] DEBUG Servicesys_role - 获取实体列表
2014-01-21 00:19:45,011 [11408] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 00:19:49,755 [19316] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 00:19:49,758 [19316] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 00:19:49,804 [17172] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 00:19:49,972 [17172] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-21 00:19:49,974 [19316] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-21 00:20:08,919 [17172] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 00:20:08,921 [17172] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-21 00:20:08,926 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-21 00:20:08,939 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-21 00:20:08,944 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-21 00:20:08,946 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-21 00:20:08,948 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-21 00:20:08,949 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-21 00:20:08,949 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-21 00:20:08,951 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-21 00:20:08,951 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-21 00:20:08,953 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-21 00:20:08,955 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-21 00:20:08,957 [17172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-21 00:20:08,989 [17172] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 00:20:08,990 [17172] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-21 00:20:08,991 [17172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','delete')
2014-01-21 00:20:08,994 [17172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','export')
2014-01-21 00:20:09,060 [17172] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 00:20:09,061 [17172] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-21 00:20:09,063 [17172] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-21 00:20:09,066 [17172] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-21 00:20:09,122 [17172] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 00:20:09,124 [17172] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-21 00:20:27,203 [19316] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:20:27,204 [19316] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-21 00:20:27,206 [19316] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-21 00:20:27,216 [19316] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/21 0:20:27')
2014-01-21 00:20:27,236 [19316] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:20:27,236 [19316] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:20:27,271 [16700] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-21 00:20:27,386 [14096] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:20:29,676 [16700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:20:29,687 [16700] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:20:29,687 [16700] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:20:29,692 [16700] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:20:29,692 [16700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:20:30,142 [8884] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:20:30,143 [8884] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:20:30,145 [8884] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:20:32,347 [16700] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:20:32,347 [16700] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:20:32,401 [14096] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:23:05,370 [11408] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:23:21,619 [18724] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:23:21,619 [18724] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 00:23:21,627 [18724] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 00:23:21,687 [18724] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/21 0:23:21')
2014-01-21 00:23:21,745 [18724] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:23:21,745 [18724] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:23:21,782 [14096] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 00:23:21,912 [16700] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:23:27,273 [18724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 00:23:59,319 [18724] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 00:23:59,320 [18724] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 00:24:16,132 [11408] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 00:25:00,415 [16700] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 00:25:03,636 [18792] DEBUG Servicesys_button - 获取实体列表
2014-01-21 00:25:03,636 [18792] DEBUG Sys - select sys_button.* from sys_button order by ButtonSeq
2014-01-21 00:25:21,619 [14760] DEBUG Servicesys_menu - 设置菜单按钮
2014-01-21 00:25:21,627 [14760] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '1002'
2014-01-21 00:25:21,634 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','add')
2014-01-21 00:25:21,639 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','browse')
2014-01-21 00:25:21,642 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','edit')
2014-01-21 00:25:21,645 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','delete')
2014-01-21 00:25:21,646 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','search')
2014-01-21 00:25:21,646 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','refresh')
2014-01-21 00:25:21,648 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','export')
2014-01-21 00:25:21,648 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','download')
2014-01-21 00:25:21,650 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','print')
2014-01-21 00:25:21,652 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','accredit')
2014-01-21 00:25:21,652 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','audit')
2014-01-21 00:25:21,653 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','inport')
2014-01-21 00:25:21,653 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','copy')
2014-01-21 00:25:21,653 [14760] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','save')
2014-01-21 00:25:28,747 [19316] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:25:28,770 [19316] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:25:28,770 [19316] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:25:28,788 [19316] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:25:28,788 [19316] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:25:29,033 [16700] DEBUG Servicesys_role - 获取实体列表
2014-01-21 00:25:29,034 [16700] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 00:25:33,180 [11408] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 00:25:33,193 [11408] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 00:25:33,289 [18636] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 00:25:33,289 [18636] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-21 00:25:33,433 [11408] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-21 00:25:59,606 [11408] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 00:25:59,614 [11408] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-21 00:25:59,621 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-21 00:25:59,652 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-21 00:25:59,658 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-21 00:25:59,662 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-21 00:25:59,665 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-21 00:25:59,668 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-21 00:25:59,669 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-21 00:25:59,671 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-21 00:25:59,672 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-21 00:25:59,672 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-21 00:25:59,672 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-21 00:25:59,672 [11408] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-21 00:25:59,674 [11408] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 00:25:59,674 [11408] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-21 00:25:59,675 [11408] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 00:25:59,676 [11408] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-21 00:25:59,677 [11408] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-21 00:25:59,681 [11408] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-21 00:25:59,684 [11408] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 00:25:59,684 [11408] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-21 00:26:22,285 [18792] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:26:22,285 [18792] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-21 00:26:22,294 [18792] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-21 00:26:22,320 [18792] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/21 0:26:22')
2014-01-21 00:26:22,391 [18792] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:26:22,392 [18792] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:26:22,427 [14760] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-21 00:26:22,609 [11408] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:26:25,179 [19316] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:26:25,192 [19316] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:26:25,192 [19316] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:26:25,194 [19316] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:26:25,194 [19316] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:26:25,597 [16700] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:26:25,597 [16700] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:26:25,616 [16700] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:26:35,111 [18636] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:26:35,111 [18636] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:26:35,165 [14760] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:27:00,887 [16700] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:27:00,887 [16700] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 00:27:00,893 [16700] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 00:27:00,911 [16700] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/21 0:27:00')
2014-01-21 00:27:00,967 [16700] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:27:00,967 [16700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:27:00,997 [17168] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 00:27:01,126 [14760] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:27:04,980 [16700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:27:05,007 [16700] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:27:05,007 [16700] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:27:05,009 [16700] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:27:05,010 [16700] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:27:05,275 [18792] DEBUG Servicesys_role - 获取实体列表
2014-01-21 00:27:05,275 [18792] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 00:27:06,264 [18792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 00:27:33,338 [16700] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 00:27:33,338 [16700] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 00:27:33,376 [16700] DEBUG Servicesys_user - 获取实体列表
2014-01-21 00:27:33,376 [16700] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 00:27:33,388 [16700] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 00:28:29,708 [16700] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'admin'
2014-01-21 00:28:58,041 [20272] DEBUG Servicesys_user - 设置用户机构
2014-01-21 00:28:58,044 [20272] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'admin'
2014-01-21 00:28:58,046 [20272] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('admin','04')
2014-01-21 00:28:58,050 [20272] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('admin','0405')
2014-01-21 00:29:13,059 [20280] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-21 00:29:13,059 [20280] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'admin'
2014-01-21 00:29:16,525 [18792] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'admin'
2014-01-21 00:29:34,790 [20268] DEBUG Servicesys_user - 设置用户角色
2014-01-21 00:29:34,807 [20268] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'admin'
2014-01-21 00:29:34,820 [20268] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('admin','R3')
2014-01-21 00:29:34,825 [20268] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('admin','R7')
2014-01-21 00:29:48,053 [18792] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:29:48,053 [18792] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-21 00:29:48,056 [18792] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-21 00:29:48,092 [18792] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/21 0:29:48')
2014-01-21 00:29:48,169 [18792] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:29:48,170 [18792] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:29:48,217 [18792] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-21 00:29:48,325 [20280] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:29:50,774 [20280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:29:50,784 [20280] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:29:50,785 [20280] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:29:50,791 [20280] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:29:50,792 [20280] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:29:51,289 [18792] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:29:51,289 [18792] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:29:51,305 [18792] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:29:54,336 [18792] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:29:54,336 [18792] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:29:54,417 [18792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:29:54,443 [18792] DEBUG Servicemms_receive - 获取实体对象
2014-01-21 00:29:54,443 [18792] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210004'
2014-01-21 00:29:54,448 [18792] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-21 00:29:54,488 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:29:54,490 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:29:54,498 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:29:54,499 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210004'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:29:54,556 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:29:54,556 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210004'and ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:29:54,560 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:29:54,560 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:29:54,610 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:29:54,610 [18792] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-21 00:29:54,612 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:29:54,612 [18792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:29:54,613 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:29:54,613 [18792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-21 00:29:54,614 [18792] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:29:54,614 [18792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:29:54,615 [18792] DEBUG Servicesys_code - 获取字段
2014-01-21 00:29:54,616 [18792] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:29:54,618 [18792] DEBUG Servicesys_code - 获取字段
2014-01-21 00:29:54,618 [18792] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:29:56,879 [18792] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:29:56,881 [18792] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210004' order by A.MaterialCode
2014-01-21 00:30:22,704 [16552] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:30:22,704 [16552] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 00:30:22,707 [16552] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 00:30:22,743 [16552] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/21 0:30:22')
2014-01-21 00:30:22,748 [16552] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:30:22,748 [16552] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:30:22,814 [20280] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 00:30:22,890 [19988] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:30:26,906 [20004] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:30:26,915 [20004] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:30:26,915 [20004] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:30:26,916 [20004] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:30:26,916 [20004] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:30:27,226 [16552] DEBUG Servicesys_role - 获取实体列表
2014-01-21 00:30:27,226 [16552] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 00:30:29,843 [16700] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 00:30:29,848 [16700] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 00:30:29,963 [20280] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 00:30:29,963 [20280] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-21 00:30:30,061 [16700] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-21 00:30:45,375 [18792] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 00:30:45,379 [18792] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-21 00:30:45,381 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-21 00:30:45,384 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-21 00:30:45,387 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-21 00:30:45,390 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-21 00:30:45,390 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-21 00:30:45,390 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-21 00:30:45,391 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-21 00:30:45,391 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-21 00:30:45,391 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-21 00:30:45,392 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-21 00:30:45,392 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-21 00:30:45,392 [18792] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-21 00:30:45,393 [18792] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 00:30:45,394 [18792] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-21 00:30:45,395 [18792] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','add')
2014-01-21 00:30:45,400 [18792] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 00:30:45,400 [18792] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-21 00:30:45,401 [18792] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-21 00:30:45,403 [18792] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-21 00:30:45,404 [18792] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 00:30:45,405 [18792] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-21 00:31:01,042 [17372] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:31:01,042 [17372] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-21 00:31:01,043 [17372] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-21 00:31:01,107 [17372] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/21 0:31:01')
2014-01-21 00:31:01,205 [17372] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:31:01,205 [17372] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:31:01,247 [18792] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-21 00:31:01,330 [20004] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:31:42,949 [18792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:31:42,952 [18792] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:31:42,952 [18792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:31:42,952 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:31:42,953 [18792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:31:43,351 [17372] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:31:43,351 [17372] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:31:43,353 [17372] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:31:47,712 [17372] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:31:47,712 [17372] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:31:47,748 [17372] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:31:47,756 [17372] DEBUG Servicemms_receive - 获取实体对象
2014-01-21 00:31:47,756 [17372] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210005'
2014-01-21 00:31:47,758 [17372] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-21 00:31:47,759 [17372] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:31:47,759 [17372] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:31:47,763 [17372] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:31:47,763 [17372] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210005'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:31:47,767 [17372] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:31:47,767 [17372] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210005'and ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:31:47,771 [17372] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:31:47,771 [17372] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:31:47,772 [17372] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:31:47,772 [17372] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-21 00:31:47,773 [17372] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:31:47,773 [17372] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:31:47,774 [17372] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:31:47,774 [17372] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-21 00:31:47,799 [17372] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:31:47,800 [17372] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:31:47,821 [17372] DEBUG Servicesys_code - 获取字段
2014-01-21 00:31:47,821 [17372] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:31:47,824 [17372] DEBUG Servicesys_code - 获取字段
2014-01-21 00:31:47,824 [17372] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:31:48,885 [18792] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:31:48,885 [18792] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210005' order by A.MaterialCode
2014-01-21 00:32:46,893 [18416] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 00:32:46,894 [18416] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2014-01-21 00:32:47,145 [18416] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2014-01-21 00:32:51,500 [20096] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 00:32:51,501 [20096] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00301') order by MerchantsCode
2014-01-21 00:33:19,720 [14096] DEBUG Servicemms_receive - 编辑记录
2014-01-21 00:33:19,729 [14096] DEBUG Servicemms_receive - 获取动态对象
2014-01-21 00:33:19,730 [14096] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210005'
2014-01-21 00:33:19,760 [14096] DEBUG Mms - update mms_receive set [BillDate] = '14/01/21 0:31:47', [DoPerson] = '管理员', [SupplierCode] = 'CG00301', [ReceiveDate] = '14/01/21 0:31:47', [PayKind] = '085', [ProjectCode] = '201306030001', [UpdatePerson] = '管理员', [UpdateDate] = '14/01/21 0:33:19' where  BillNo =  '201401210005'
2014-01-21 00:33:19,863 [14096] DEBUG Mms - insert into mms_receive([BillNo],[BillDate],[DoPerson],[SupplierCode],[ReceiveDate],[PayKind],[ProjectCode],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201401210005','14/01/21 0:31:47','管理员','CG00301','14/01/21 0:31:47','085','201306030001','管理员','14/01/21 0:33:19','管理员','14/01/21 0:33:19')
2014-01-21 00:33:53,973 [18792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:33:53,980 [18792] DEBUG Servicemms_receive - 获取实体对象
2014-01-21 00:33:53,984 [18792] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020014'
2014-01-21 00:33:53,989 [18792] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-21 00:33:53,990 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:33:53,990 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:33:53,990 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:33:53,990 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020014'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:33:54,008 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:33:54,008 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020014'and ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:33:54,014 [18792] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:33:54,014 [18792] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:33:54,021 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:33:54,022 [18792] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-21 00:33:54,022 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:33:54,022 [18792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:33:54,023 [18792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:33:54,024 [18792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-21 00:33:54,025 [18792] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:33:54,025 [18792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:33:54,027 [18792] DEBUG Servicesys_code - 获取字段
2014-01-21 00:33:54,028 [18792] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:33:54,031 [18792] DEBUG Servicesys_code - 获取字段
2014-01-21 00:33:54,031 [18792] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:33:54,649 [14096] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 00:33:54,649 [14096] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('GY100003') order by MerchantsCode
2014-01-21 00:33:54,932 [14096] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:33:54,933 [14096] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020014' order by A.MaterialCode
2014-01-21 00:34:11,233 [12448] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:34:11,233 [12448] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 00:34:11,235 [12448] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 00:34:11,244 [12448] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/21 0:34:11')
2014-01-21 00:34:11,246 [12448] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:34:11,246 [12448] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:34:11,273 [18792] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 00:34:11,380 [12448] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:34:21,086 [12448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 00:34:21,090 [12448] DEBUG Servicesys_user - 获取动态列表
2014-01-21 00:34:21,090 [12448] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 00:34:21,091 [12448] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 00:34:21,091 [12448] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 00:34:21,304 [12448] DEBUG Servicesys_role - 获取实体列表
2014-01-21 00:34:21,304 [12448] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 00:34:29,932 [19484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 00:34:30,178 [20060] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 00:34:30,178 [20060] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 00:34:39,501 [19484] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 00:34:45,276 [19484] DEBUG Servicesys_menu - 设置菜单按钮
2014-01-21 00:34:45,276 [19484] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '1002'
2014-01-21 00:34:45,278 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','browse')
2014-01-21 00:34:45,283 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','edit')
2014-01-21 00:34:45,290 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','delete')
2014-01-21 00:34:45,291 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','search')
2014-01-21 00:34:45,291 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','refresh')
2014-01-21 00:34:45,293 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','export')
2014-01-21 00:34:45,294 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','download')
2014-01-21 00:34:45,296 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','print')
2014-01-21 00:34:45,298 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','accredit')
2014-01-21 00:34:45,299 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','audit')
2014-01-21 00:34:45,299 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','inport')
2014-01-21 00:34:45,300 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','copy')
2014-01-21 00:34:45,301 [19484] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','save')
2014-01-21 00:35:03,140 [18792] DEBUG Servicesys_user - 获取实体对象
2014-01-21 00:35:03,144 [18792] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-21 00:35:03,145 [18792] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-21 00:35:03,220 [18792] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/21 0:35:03')
2014-01-21 00:35:03,304 [18792] DEBUG Servicemms_project - 获取实体对象
2014-01-21 00:35:03,304 [18792] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 00:35:03,367 [14096] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-21 00:35:03,540 [18792] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 00:35:05,611 [19484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 00:35:05,614 [19484] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:35:05,614 [19484] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:35:05,617 [19484] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:35:05,617 [19484] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:35:06,005 [19484] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:35:06,006 [19484] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 00:35:06,008 [19484] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 00:35:07,624 [14096] DEBUG Servicemms_receive - 获取新主键
2014-01-21 00:35:07,624 [14096] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 00:35:07,670 [19484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-21 00:35:07,672 [19484] DEBUG Servicemms_receive - 获取实体对象
2014-01-21 00:35:07,673 [19484] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210006'
2014-01-21 00:35:07,675 [19484] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-21 00:35:07,676 [19484] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:35:07,676 [19484] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:35:07,678 [19484] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:35:07,678 [19484] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210006'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:35:07,692 [19484] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:35:07,692 [19484] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210006'and ProjectCode =  '201306030001' order by BillNo
2014-01-21 00:35:07,696 [19484] DEBUG Servicemms_receive - 获取字段
2014-01-21 00:35:07,696 [19484] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-21 00:35:07,698 [19484] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:35:07,698 [19484] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-21 00:35:07,700 [19484] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:35:07,700 [19484] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 00:35:07,701 [19484] DEBUG Servicesys_code - 获取动态列表
2014-01-21 00:35:07,702 [19484] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-21 00:35:07,704 [19484] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 00:35:07,704 [19484] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 00:35:07,708 [19484] DEBUG Servicesys_code - 获取字段
2014-01-21 00:35:07,708 [19484] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:35:07,709 [19484] DEBUG Servicesys_code - 获取字段
2014-01-21 00:35:07,709 [19484] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-21 00:35:08,616 [19484] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 00:35:08,616 [19484] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210006' order by A.MaterialCode
2014-01-21 00:56:23,260 [22372] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-21 00:56:56,856 [22372] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 00:56:56,856 [22372] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-21 01:02:21,390 [19756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 01:02:21,395 [19756] DEBUG Servicesys_user - 获取动态列表
2014-01-21 01:02:21,395 [19756] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 01:02:21,398 [19756] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 01:02:21,398 [19756] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 01:02:21,586 [22576] DEBUG Servicesys_role - 获取实体列表
2014-01-21 01:02:21,586 [22576] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 01:02:24,347 [19756] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 01:02:24,350 [19756] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Warehouse' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Warehouse'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Warehouse'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Warehouse'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Warehouse'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Warehouse'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Warehouse'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Warehouse'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Warehouse'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Warehouse'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Warehouse'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Warehouse'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Warehouse'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Warehouse'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Warehouse'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 01:02:24,393 [22576] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:02:24,447 [22576] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Warehouse' and B.PermissionCode = A.PermissionCode 
2014-01-21 01:02:24,505 [19756] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Warehouse'
2014-01-21 01:02:40,283 [22576] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 01:02:40,304 [22576] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 01:02:40,307 [22576] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 01:02:46,039 [19756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 01:02:46,322 [19756] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 01:02:46,322 [19756] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 01:02:46,352 [22576] DEBUG Servicesys_user - 获取实体列表
2014-01-21 01:02:46,352 [22576] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 01:02:46,355 [22576] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 01:02:51,543 [17976] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'zfg'
2014-01-21 01:03:01,087 [19756] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-21 01:03:01,088 [19756] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'zzx'
2014-01-21 01:03:41,680 [20756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 01:04:07,439 [19756] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 01:04:07,440 [19756] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 01:04:07,813 [19756] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 01:04:46,269 [22576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-21 01:04:46,279 [22576] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 01:04:46,279 [22576] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 01:04:55,827 [22576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 01:04:56,082 [16844] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 01:04:56,082 [16844] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 01:05:15,584 [23424] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '0103' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 01:05:19,850 [22576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-21 01:05:19,852 [22576] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 01:05:19,852 [22576] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 01:05:23,477 [22576] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '040502'
2014-01-21 01:05:28,238 [22576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-21 01:05:28,461 [22576] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:05:28,461 [22576] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-21 01:05:37,134 [22576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 01:05:37,155 [22576] DEBUG Servicesys_user - 获取动态列表
2014-01-21 01:05:37,155 [22576] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 01:05:37,156 [22576] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 01:05:37,156 [22576] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 01:05:37,331 [23532] DEBUG Servicesys_role - 获取实体列表
2014-01-21 01:05:37,331 [23532] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 01:05:40,290 [23424] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'Guest')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'Guest')
2014-01-21 01:06:07,049 [21692] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 01:06:07,051 [21692] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Buy' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Buy'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Buy'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Buy'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Buy'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Buy'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Buy'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Buy'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Buy'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Buy'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Buy'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Buy'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Buy'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Buy'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Buy'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 01:06:07,099 [23532] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:06:07,099 [23532] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Buy' and B.PermissionCode = A.PermissionCode 
2014-01-21 01:06:07,232 [21692] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Buy'
2014-01-21 01:06:39,725 [21692] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-21 01:06:39,943 [21692] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:06:39,943 [21692] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-21 01:06:41,779 [23532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-21 01:06:41,792 [23532] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 01:06:41,793 [23532] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 01:10:40,034 [19132] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-21 01:10:40,345 [17172] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:10:40,345 [17172] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-21 01:10:47,524 [17172] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-21 01:10:47,528 [17172] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 01:10:47,528 [17172] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 01:10:48,381 [19132] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 01:10:48,642 [17172] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 01:10:48,643 [17172] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 01:10:49,922 [17172] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 01:10:49,924 [17172] DEBUG Servicesys_user - 获取动态列表
2014-01-21 01:10:49,924 [17172] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 01:10:49,924 [17172] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 01:10:49,924 [17172] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 01:10:50,202 [19132] DEBUG Servicesys_role - 获取实体列表
2014-01-21 01:10:50,202 [19132] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 01:10:52,962 [19132] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:10:52,962 [17172] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 01:10:52,963 [17172] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Guest' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Guest'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Guest'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Guest'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Guest'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Guest'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Guest'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Guest'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Guest'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Guest'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Guest'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Guest'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Guest'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Guest'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Guest'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 01:10:53,020 [19132] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Guest' and B.PermissionCode = A.PermissionCode 
2014-01-21 01:10:53,054 [17172] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Guest'
2014-01-21 01:12:16,739 [23344] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 01:12:16,741 [23344] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Guest' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Guest'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Guest'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Guest'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Guest'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Guest'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Guest'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Guest'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Guest'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Guest'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Guest'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Guest'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Guest'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Guest'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Guest'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 01:12:16,773 [19132] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 01:12:16,788 [19132] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Guest' and B.PermissionCode = A.PermissionCode 
2014-01-21 01:12:16,849 [23344] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Guest'
2014-01-21 01:13:23,519 [20720] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 01:13:23,521 [20720] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 01:13:23,522 [20720] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 18:00:41,185 [38100] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 18:00:41,717 [38100] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 18:00:41,790 [38100] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 18:00:41,873 [38100] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 18:11:21,384 [38048] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:11:21,414 [38048] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:11:22,381 [38048] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:11:23,873 [38048] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:11:23')
2014-01-21 18:11:24,745 [38048] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:11:24,751 [38048] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:11:25,109 [38048] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:11:31,371 [38048] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:11:39,153 [38268] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:11:39,231 [38268] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:11:39,232 [38268] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:11:39,234 [38268] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:11:39,234 [38268] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:11:42,114 [38268] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:11:42,117 [38268] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:11:45,592 [38268] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:11:45,592 [38268] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:11:45,598 [39000] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:11:45,601 [39000] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:11:45,976 [39000] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-21 18:14:56,738 [39000] DEBUG Servicesys_role - 编辑记录
2014-01-21 18:14:56,759 [39000] DEBUG Servicesys_role - 获取动态对象
2014-01-21 18:14:56,925 [39000] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-21 18:14:56,953 [39000] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('临时工2','T02','93','临时工2','超级管理员','星期二 18:14:56','超级管理员','星期二 18:14:56')
2014-01-21 18:14:57,536 [34948] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:14:57,536 [34948] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:14:59,286 [39448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:14:59,289 [39448] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:14:59,289 [39448] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:14:59,289 [39448] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:14:59,289 [39448] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:14:59,652 [37436] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:14:59,652 [37436] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:15:01,863 [23096] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:15:01,866 [23096] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:15:01,907 [39448] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:15:01,908 [39448] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:15:02,071 [23096] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:16:41,465 [39448] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:16:41,467 [39448] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:16:41,525 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:16:41,526 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:16:41,528 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:16:41,528 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:16:41,529 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:16:41,529 [39448] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:16:41,532 [39448] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:16:41,534 [39448] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:16:41,538 [39448] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:16:41,539 [39448] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:16:41,542 [39448] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:16:41,543 [39448] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:16:44,181 [39472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:16:45,898 [39472] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:16:45,898 [39472] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:16:46,034 [39472] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:16:46,056 [34948] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:16:46,057 [34948] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:16:49,975 [39324] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:16:49,975 [39324] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) order by UserSeq
2014-01-21 18:16:50,400 [39324] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) ) tb_temp
2014-01-21 18:17:23,917 [39324] DEBUG Servicesys_user - 编辑记录
2014-01-21 18:17:23,917 [39324] DEBUG Servicesys_user - 获取动态对象
2014-01-21 18:17:23,917 [39324] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'
2014-01-21 18:17:23,920 [39324] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('temp001','临时工','临时工','true','超级管理员','星期二 18:17:23','超级管理员','星期二 18:17:23')
2014-01-21 18:17:23,925 [39324] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'temp001'
2014-01-21 18:17:41,279 [39000] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:17:41,639 [37436] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:17:41,639 [37436] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:17:41,644 [37436] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:17:41,655 [13776] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:17:41,655 [13776] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:17:43,233 [34108] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:17:43,233 [34108] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) order by UserSeq
2014-01-21 18:17:43,246 [34108] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) ) tb_temp
2014-01-21 18:18:02,170 [37436] DEBUG Servicesys_user - 编辑记录
2014-01-21 18:18:02,171 [37436] DEBUG Servicesys_user - 获取动态对象
2014-01-21 18:18:02,171 [37436] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'
2014-01-21 18:18:02,172 [37436] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('temp002','临时工2','临时工2','true','超级管理员','星期二 18:18:02','超级管理员','星期二 18:18:02')
2014-01-21 18:18:02,174 [37436] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'temp002'
2014-01-21 18:18:04,992 [37936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:18:05,345 [34948] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:18:05,345 [34948] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:18:05,370 [39324] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:18:05,370 [39324] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:18:05,372 [39324] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:18:06,158 [34852] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:18:06,158 [34852] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) order by UserSeq
2014-01-21 18:18:06,161 [34852] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) ) tb_temp
2014-01-21 18:18:16,762 [39324] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:18:17,088 [39324] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:18:17,089 [39324] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:18:17,107 [34948] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:18:17,108 [34948] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:18:17,109 [34948] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:18:30,674 [37936] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'temp002'
2014-01-21 18:18:41,576 [37436] DEBUG Servicesys_user - 设置用户机构
2014-01-21 18:18:41,576 [37436] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'temp002'
2014-01-21 18:18:41,578 [37436] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('temp002','0401')
2014-01-21 18:18:42,756 [13776] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp002'
2014-01-21 18:18:53,570 [34852] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:18:53,571 [34852] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'temp002'
2014-01-21 18:18:53,573 [34852] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('temp002','T02')
2014-01-21 18:18:58,863 [37436] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-21 18:18:58,863 [37436] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'temp002'
2014-01-21 18:19:16,033 [39472] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'temp002'
2014-01-21 18:19:27,344 [37936] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:19:27,344 [37936] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:19:27,346 [37936] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:19:27,353 [37936] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:19:27')
2014-01-21 18:19:27,355 [37936] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:19:27,368 [37936] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:19:27,383 [34852] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:19:27,636 [34948] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:19:44,504 [39904] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:19:44,505 [39904] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:19:44,507 [39904] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:19:44,523 [39904] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:19:44')
2014-01-21 18:19:44,523 [39904] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:19:44,524 [39904] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:19:44,570 [36900] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:19:44,749 [39608] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:19:48,957 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:19:49,290 [37436] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:19:49,290 [37436] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:19:49,318 [13776] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:19:49,318 [13776] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:19:49,321 [13776] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:20:00,339 [39608] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'temp001'
2014-01-21 18:20:03,934 [39448] DEBUG Servicesys_user - 设置用户机构
2014-01-21 18:20:03,943 [39448] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'temp001'
2014-01-21 18:20:03,943 [39448] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('temp001','0401')
2014-01-21 18:20:05,970 [39904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:20:07,166 [39472] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:20:07,166 [39472] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:20:08,198 [37936] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp001'
2014-01-21 18:20:10,350 [34852] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:20:10,353 [34852] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'temp001'
2014-01-21 18:20:10,353 [34852] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('temp001','T02')
2014-01-21 18:20:18,248 [39472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:20:18,671 [34948] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:20:18,671 [34948] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:20:18,701 [39252] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:20:18,701 [39252] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:20:18,703 [39252] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:20:22,910 [34852] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'temp001'
2014-01-21 18:20:25,602 [39788] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp001'
2014-01-21 18:20:37,215 [34852] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:20:37,215 [34852] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:20:37,222 [34852] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp001' 
2014-01-21 18:20:37,234 [34852] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp001','临时工','fwytech-PC','localhost','上海市','星期二 18:20:37')
2014-01-21 18:20:37,236 [34852] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:20:37,236 [34852] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:20:37,261 [39788] DEBUG Sys - select * from sys_userSetting where UserCode='temp001'
2014-01-21 18:20:37,509 [39788] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp001' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp001'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:20:55,908 [39608] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:20:55,908 [39608] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:20:55,917 [39608] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:20:55,923 [39608] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:20:55')
2014-01-21 18:20:55,937 [39608] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:20:55,937 [39608] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:20:55,962 [39324] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:20:56,115 [39252] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:21:01,154 [34108] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:21:01,157 [34108] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:21:01,157 [34108] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:21:01,158 [34108] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:21:01,158 [34108] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:21:01,426 [39904] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:21:01,427 [39904] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:21:05,707 [37436] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:21:05,709 [37436] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:21:05,738 [34948] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:21:05,738 [34948] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:21:05,765 [37436] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:21:17,685 [39608] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:21:17,687 [39608] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:21:17,688 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:21:17,695 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:21:17,695 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:21:17,696 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:21:17,696 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:21:17,697 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:21:17,699 [39608] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:21:17,699 [39608] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:21:17,699 [39608] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:21:17,700 [39608] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:21:17,700 [39608] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:21:17,700 [39608] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:21:19,223 [39472] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T02')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T02')
2014-01-21 18:22:19,128 [39472] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:22:19,129 [39472] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='undefined' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='undefined'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='undefined'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='undefined'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='undefined'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='undefined'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='undefined'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='undefined'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='undefined'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='undefined'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='undefined'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='undefined'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='undefined'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='undefined'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='undefined'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:22:19,158 [34948] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:22:19,158 [34948] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='undefined' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:22:19,251 [39472] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'undefined'
2014-01-21 18:22:29,992 [39608] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:22:29,992 [39608] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'undefined'
2014-01-21 18:22:29,995 [39608] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('undefined','99')
2014-01-21 18:22:30,564 [39608] ERROR Servicesys_role - 修改角色菜单权限失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<Context>b__2(ErrorEventArgs e) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Models.sys_roleService.<>c__DisplayClass2.<EditRoleMenu>b__0() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Models\sys_role.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2014-01-21 18:22:30,824 [39608] ERROR /api/sys/role/editpermission/undefined - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Models.sys_roleService.EditRoleMenu(String RoleCode, JToken MenuList) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Models\sys_role.cs:行号 15
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.EditPermission(String id, Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 77
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2014-01-21 18:22:41,337 [39472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:22:41,340 [39472] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:22:41,340 [39472] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:22:41,342 [39472] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:22:41,343 [39472] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:22:41,658 [39252] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:22:41,659 [39252] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:23:04,133 [34948] DEBUG Servicesys_role - 编辑记录
2014-01-21 18:23:04,134 [34948] DEBUG Servicesys_role - 获取动态对象
2014-01-21 18:23:04,139 [34948] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-21 18:23:04,141 [34948] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('临时角色','T03','94','临时角色','超级管理员','星期二 18:23:04','超级管理员','星期二 18:23:04')
2014-01-21 18:23:04,203 [34852] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:23:04,203 [34852] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:23:06,771 [39448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:23:06,772 [39448] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:23:06,772 [39448] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:23:06,773 [39448] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:23:06,773 [39448] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:23:07,025 [34948] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:23:07,025 [34948] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:23:08,971 [37436] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:23:08,973 [37436] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T03' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T03'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T03'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T03'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T03'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T03'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T03'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T03'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T03'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T03'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T03'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T03'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T03'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T03'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T03'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:23:09,005 [36900] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:23:09,005 [36900] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T03' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:23:09,090 [37436] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T03'
2014-01-21 18:23:19,953 [34948] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:23:19,957 [34948] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T03'
2014-01-21 18:23:19,959 [34948] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T03','03')
2014-01-21 18:23:19,960 [34948] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T03','0301')
2014-01-21 18:23:19,960 [34948] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T03','0302')
2014-01-21 18:23:19,960 [34948] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T03','0303')
2014-01-21 18:23:19,960 [34948] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T03','0304')
2014-01-21 18:23:19,961 [34948] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:23:19,961 [34948] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T03'
2014-01-21 18:23:19,962 [34948] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:23:19,962 [34948] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T03'
2014-01-21 18:23:19,963 [34948] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:23:19,963 [34948] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T03'
2014-01-21 18:23:27,026 [36900] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:23:27,360 [34948] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:23:27,360 [34948] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:23:27,378 [39000] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:23:27,378 [39000] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:23:27,379 [39000] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:23:50,064 [37564] DEBUG Servicesys_user - 编辑记录
2014-01-21 18:23:50,064 [37564] DEBUG Servicesys_user - 获取动态对象
2014-01-21 18:23:50,064 [37564] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'mytest'
2014-01-21 18:23:50,065 [37564] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('mytest','测试人员','测试人员','true','超级管理员','星期二 18:23:50','超级管理员','星期二 18:23:50')
2014-01-21 18:23:50,067 [37564] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'mytest'
2014-01-21 18:23:54,067 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:23:54,872 [36900] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:23:55,239 [39324] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:23:55,240 [39324] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:23:55,322 [34948] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:23:55,322 [34948] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:23:55,339 [39000] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:23:55,339 [39000] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:23:55,340 [39000] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:24:05,006 [34852] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'mytest'
2014-01-21 18:24:08,788 [39608] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:24:08,789 [39608] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'mytest'
2014-01-21 18:24:08,791 [39608] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('mytest','T03')
2014-01-21 18:24:20,210 [39448] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'mytest'
2014-01-21 18:24:21,617 [37436] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:24:21,617 [37436] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'mytest'
2014-01-21 18:24:21,617 [37436] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('mytest','T03')
2014-01-21 18:24:35,856 [39252] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:24:35,857 [39252] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'mytest'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:24:35,862 [39252] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'mytest' 
2014-01-21 18:24:35,871 [39252] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('mytest','测试人员','fwytech-PC','localhost','上海市','星期二 18:24:35')
2014-01-21 18:24:35,873 [39252] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:24:35,876 [39252] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:24:35,898 [34948] DEBUG Sys - select * from sys_userSetting where UserCode='mytest'
2014-01-21 18:24:36,080 [36900] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'mytest' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'mytest'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:24:49,459 [39472] DEBUG Sys - select * from sys_userSetting where UserCode='mytest'
2014-01-21 18:24:49,629 [39788] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'mytest' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'mytest'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:24:57,938 [39608] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:24:57,938 [39608] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'mytest'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:24:57,939 [39608] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'mytest' 
2014-01-21 18:24:57,946 [39608] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('mytest','测试人员','fwytech-PC','localhost','上海市','星期二 18:24:57')
2014-01-21 18:24:57,947 [39608] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:24:57,948 [39608] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:24:57,977 [37564] DEBUG Sys - select * from sys_userSetting where UserCode='mytest'
2014-01-21 18:24:58,111 [34852] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'mytest' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'mytest'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:25:47,835 [34108] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:25:47,835 [34108] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:25:47,837 [34108] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp001' 
2014-01-21 18:25:47,845 [34108] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp001','测试人员','fwytech-PC','localhost','上海市','星期二 18:25:47')
2014-01-21 18:25:48,010 [34108] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:25:48,010 [34108] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:25:48,049 [34948] DEBUG Sys - select * from sys_userSetting where UserCode='temp001'
2014-01-21 18:25:48,184 [13776] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp001' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp001'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:26:08,130 [39904] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:26:08,131 [39904] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:26:08,132 [39904] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:26:08,146 [39904] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:26:08')
2014-01-21 18:26:08,147 [39904] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:26:08,147 [39904] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:26:08,165 [39324] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:26:08,306 [39904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:26:12,317 [36900] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:26:12,681 [39324] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:26:12,681 [39324] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:26:12,700 [37564] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:26:12,700 [37564] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:26:12,702 [37564] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:26:20,625 [39472] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'mytest'
2014-01-21 18:26:23,072 [39252] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:26:23,074 [39252] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'mytest'
2014-01-21 18:26:23,074 [39252] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('mytest','T03')
2014-01-21 18:26:24,140 [39448] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'mytest'
2014-01-21 18:26:32,522 [39788] DEBUG Servicesys_user - 设置用户机构
2014-01-21 18:26:32,522 [39788] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'mytest'
2014-01-21 18:26:32,524 [39788] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('mytest','0401')
2014-01-21 18:26:48,000 [36900] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:26:48,000 [36900] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'mytest'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:26:48,004 [36900] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'mytest' 
2014-01-21 18:26:48,015 [36900] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('mytest','测试人员','fwytech-PC','localhost','上海市','星期二 18:26:48')
2014-01-21 18:26:48,016 [36900] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:26:48,016 [36900] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:26:48,037 [13776] DEBUG Sys - select * from sys_userSetting where UserCode='mytest'
2014-01-21 18:26:48,179 [34948] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'mytest' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'mytest'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:27:01,805 [36900] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:27:01,805 [36900] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:27:01,807 [36900] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:27:01,817 [36900] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:27:01')
2014-01-21 18:27:01,817 [36900] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:27:01,818 [36900] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:27:01,839 [34852] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:27:01,986 [37436] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:27:08,687 [13776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:27:09,171 [39788] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:27:09,171 [39788] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:27:09,187 [34948] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:27:09,187 [34948] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:27:09,189 [34948] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:27:17,994 [37936] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'mytest'
2014-01-21 18:27:22,377 [39448] DEBUG Servicesys_user - 设置用户机构
2014-01-21 18:27:22,379 [39448] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'mytest'
2014-01-21 18:27:31,454 [37936] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:27:31,454 [37936] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'mytest'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:27:31,455 [37936] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'mytest' 
2014-01-21 18:27:31,461 [37936] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('mytest','测试人员','fwytech-PC','localhost','上海市','星期二 18:27:31')
2014-01-21 18:27:31,462 [37936] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:27:31,462 [37936] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:27:31,488 [39252] DEBUG Sys - select * from sys_userSetting where UserCode='mytest'
2014-01-21 18:27:31,673 [39904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'mytest' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'mytest'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:28:08,222 [34852] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:28:08,222 [34852] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:28:08,226 [34852] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:28:08,236 [34852] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','测试人员','fwytech-PC','localhost','上海市','星期二 18:28:08')
2014-01-21 18:28:08,237 [34852] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:28:08,237 [34852] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:28:08,252 [39252] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:28:08,381 [34948] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:28:11,579 [39904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:28:15,331 [37936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-21 18:28:15,961 [39472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-21 18:28:17,631 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 18:28:18,784 [34948] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 18:28:19,346 [39448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 18:28:20,078 [39000] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:28:20,537 [39904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:28:20,686 [34852] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 18:28:20,686 [34852] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 18:28:20,904 [39904] DEBUG Servicesys_code - 获取实体列表
2014-01-21 18:28:20,905 [39904] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 18:28:20,986 [39904] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 18:28:26,137 [13776] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 18:28:26,137 [13776] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 18:28:26,146 [13776] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 18:28:31,218 [39608] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:28:31,218 [39608] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:28:31,218 [39608] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:28:31,224 [39608] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:28:31')
2014-01-21 18:28:31,225 [39608] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:28:31,225 [39608] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:28:31,242 [37564] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:28:31,389 [13776] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:28:36,866 [39448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:28:36,868 [39448] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:28:36,868 [39448] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:28:36,870 [39448] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:28:36,870 [39448] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:28:37,174 [39000] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:28:37,174 [39000] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:28:45,129 [39472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:28:45,444 [37564] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:28:45,444 [37564] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:28:45,470 [39448] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:28:45,470 [39448] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:28:45,471 [39448] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:28:54,504 [39788] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'temp002'
2014-01-21 18:28:59,227 [34852] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'temp002'
2014-01-21 18:29:01,189 [34852] DEBUG Servicesys_user - 设置用户机构
2014-01-21 18:29:01,190 [34852] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'temp002'
2014-01-21 18:29:03,953 [39904] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp002'
2014-01-21 18:29:05,793 [39000] DEBUG Servicesys_user - 设置用户角色
2014-01-21 18:29:05,794 [39000] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'temp002'
2014-01-21 18:29:05,794 [39000] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('temp002','T02')
2014-01-21 18:29:15,238 [37936] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:29:15,238 [37936] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:29:15,239 [37936] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:29:15,253 [37936] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:29:15')
2014-01-21 18:29:15,254 [37936] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:29:15,254 [37936] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:29:15,272 [39472] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:29:15,403 [36900] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:29:29,896 [37436] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 18:29:30,157 [39472] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 18:29:30,157 [39472] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 18:29:30,229 [37436] DEBUG Servicesys_code - 获取实体列表
2014-01-21 18:29:30,229 [37436] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 18:29:30,231 [37436] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 18:29:31,212 [34948] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 18:29:31,501 [37436] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 18:29:31,501 [37436] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 18:29:31,502 [37436] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 18:29:32,144 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-21 18:29:34,042 [34948] DEBUG Servicesys_log - 获取实体列表
2014-01-21 18:29:34,042 [34948] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-21 18:29:34,104 [39608] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-21 18:29:34,104 [39608] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-21 18:29:34,113 [34948] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-21 18:29:34,113 [39608] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-21 18:29:36,441 [37936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:29:36,456 [37936] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:29:36,456 [37936] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:29:36,512 [37936] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:29:36,512 [37936] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:29:38,670 [39000] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:29:38,672 [39000] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:29:38,753 [39000] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:29:41,820 [34948] DEBUG Servicemms_receive - 获取新主键
2014-01-21 18:29:41,821 [34948] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 18:29:41,865 [37936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:30:02,699 [37936] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:30:02,700 [37936] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:30:02,701 [37936] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:30:02,714 [37936] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:30:02')
2014-01-21 18:30:02,721 [37936] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:30:02,722 [37936] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:30:02,770 [37936] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:30:02,967 [37936] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:30:11,070 [13776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:30:11,084 [13776] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:30:11,084 [13776] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:30:11,085 [13776] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:30:11,086 [13776] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:30:11,419 [37436] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:30:11,419 [37436] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:30:13,417 [39000] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:30:13,716 [39472] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:30:13,716 [39472] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:30:13,746 [39904] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:30:13,746 [39904] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:30:13,750 [39904] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:30:16,726 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:30:16,728 [39252] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:30:16,728 [39252] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:30:16,729 [39252] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:30:16,729 [39252] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:30:17,000 [39000] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:30:17,000 [39000] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:30:20,165 [37436] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:30:20,166 [37436] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:30:20,212 [37436] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:30:20,213 [39252] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:30:20,213 [39252] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:30:34,194 [13776] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:30:34,196 [13776] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:30:34,198 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:30:34,199 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:30:34,199 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:30:34,199 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:30:34,199 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:30:34,199 [13776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:30:34,201 [13776] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:30:34,201 [13776] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:30:34,201 [13776] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','edit')
2014-01-21 18:30:34,204 [13776] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:30:34,205 [13776] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:30:34,205 [13776] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:30:34,205 [13776] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:30:43,216 [39252] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:30:43,218 [39252] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:30:43,221 [39252] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:30:43,227 [39252] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:30:43')
2014-01-21 18:30:43,229 [39252] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:30:43,229 [39252] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:30:43,251 [39788] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:30:43,387 [37564] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:30:45,236 [39448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:30:45,238 [39448] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:30:45,238 [39448] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:30:45,239 [39448] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:30:45,239 [39448] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:30:45,754 [39252] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:30:45,754 [39252] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:30:45,756 [39252] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:30:47,271 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:30:53,839 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:30:57,051 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:31:11,073 [39608] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:31:11,073 [39608] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '123'and IsEnable =  'True'
2014-01-21 18:31:14,575 [39252] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:31:14,575 [39252] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:31:14,576 [39252] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:31:14,584 [39252] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:31:14')
2014-01-21 18:31:14,585 [39252] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:31:14,586 [39252] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:31:14,606 [37356] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:31:14,764 [38940] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:31:38,500 [37356] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:31:38,823 [39608] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:31:38,823 [39608] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:31:38,846 [37356] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:31:38,847 [37356] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:31:38,850 [37356] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:31:39,220 [39608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:31:39,229 [39608] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:31:39,229 [39608] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:31:39,236 [39608] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:31:39,236 [39608] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:31:39,530 [39608] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:31:39,531 [39608] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:31:41,773 [40940] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:31:41,775 [40940] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:31:41,808 [39252] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:31:41,808 [39252] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:31:41,834 [40940] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:31:50,995 [40940] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:31:50,997 [40940] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:31:51,000 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:31:51,002 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:31:51,004 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:31:51,004 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:31:51,004 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:31:51,004 [40940] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:31:51,005 [40940] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:31:51,005 [40940] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:31:51,006 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','browse')
2014-01-21 18:31:51,008 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','edit')
2014-01-21 18:31:51,009 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','delete')
2014-01-21 18:31:51,009 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','search')
2014-01-21 18:31:51,009 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','refresh')
2014-01-21 18:31:51,012 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','export')
2014-01-21 18:31:51,013 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','download')
2014-01-21 18:31:51,015 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','print')
2014-01-21 18:31:51,018 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','accredit')
2014-01-21 18:31:51,018 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','audit')
2014-01-21 18:31:51,019 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','inport')
2014-01-21 18:31:51,019 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','copy')
2014-01-21 18:31:51,019 [40940] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T02','1002','save')
2014-01-21 18:31:51,020 [40940] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:31:51,020 [40940] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:31:51,020 [40940] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:31:51,020 [40940] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:31:59,556 [39252] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:31:59,556 [39252] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:31:59,560 [39252] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:31:59,567 [39252] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:31:59')
2014-01-21 18:31:59,568 [39252] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:31:59,568 [39252] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:31:59,594 [37356] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:31:59,739 [40940] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:32:01,325 [40940] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:32:01,333 [40940] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:32:01,334 [40940] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:32:01,335 [40940] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:32:01,335 [40940] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:32:01,482 [37356] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:32:01,485 [37356] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:32:01,485 [37356] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:32:01,485 [37356] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:32:01,485 [37356] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:32:01,954 [37356] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:32:01,954 [37356] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:32:01,956 [37356] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:32:03,728 [37356] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:32:09,345 [39252] DEBUG Servicemms_receive - 获取新主键
2014-01-21 18:32:09,345 [39252] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 18:32:09,374 [37356] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:33:29,500 [37356] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:33:29,500 [37356] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:33:29,501 [37356] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:33:29,505 [37356] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:33:29')
2014-01-21 18:33:29,506 [37356] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:33:29,506 [37356] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:33:29,687 [39252] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:33:30,221 [37356] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:33:32,328 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:33:32,331 [39252] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:33:32,332 [39252] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:33:32,332 [39252] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:33:32,333 [39252] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:33:33,164 [33444] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:33:33,165 [33444] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:33:33,168 [33444] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:33:35,089 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:33:47,427 [37356] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:33:47,427 [37356] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:33:47,428 [37356] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:33:47,432 [37356] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:33:47')
2014-01-21 18:33:47,433 [37356] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:33:47,433 [37356] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:33:47,464 [36904] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:33:47,916 [40920] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:33:59,301 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:33:59,303 [36904] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:33:59,303 [36904] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:33:59,304 [36904] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:33:59,304 [36904] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:33:59,725 [36904] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:33:59,725 [36904] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:34:03,051 [40920] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:34:03,051 [36904] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:34:03,051 [40920] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:34:03,064 [36904] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:34:03,121 [36904] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:34:10,967 [40920] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:34:10,968 [40920] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:34:10,968 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:34:10,969 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:34:10,970 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:34:10,970 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:34:10,970 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:34:10,971 [40920] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:34:10,972 [40920] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:34:10,972 [40920] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:34:10,973 [40920] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:34:10,974 [40920] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:34:10,974 [40920] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:34:10,974 [40920] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:34:22,985 [36904] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:34:22,985 [36904] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:34:22,986 [36904] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:34:22,992 [36904] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:34:22')
2014-01-21 18:34:22,993 [36904] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:34:22,994 [36904] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:34:23,012 [33444] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:34:23,412 [36420] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:34:24,775 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:34:24,776 [36904] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:34:24,776 [36904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:34:24,776 [36904] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:34:24,776 [36904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:34:24,927 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 18:34:24,928 [36904] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 18:34:24,929 [36904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 18:34:24,929 [36904] DEBUG Servicesys_code - 获取动态列表
2014-01-21 18:34:24,929 [36904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 18:34:25,616 [36904] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:34:25,616 [36904] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:34:25,618 [36904] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:34:27,603 [39252] DEBUG Servicemms_receive - 获取新主键
2014-01-21 18:34:27,603 [39252] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 18:34:27,719 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:34:44,412 [36904] DEBUG Servicemms_receive - 删除记录
2014-01-21 18:34:44,414 [36904] DEBUG Mms - delete from mms_receiveDetail where [BillNo] = '201307210006'
2014-01-21 18:34:44,458 [36904] DEBUG Mms - delete from mms_receive where  BillNo =  '201307210006'
2014-01-21 18:34:44,715 [36904] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:34:44,719 [36904] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:34:44,720 [36904] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 18:34:57,970 [40920] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 18:34:57,970 [40920] DEBUG Mms - select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 18:35:07,141 [36904] DEBUG Servicemms_receive - 获取新主键
2014-01-21 18:35:07,141 [36904] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 18:35:07,264 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/edit')
2014-01-21 18:35:19,422 [39252] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:35:19,422 [39252] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:35:19,423 [39252] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:35:19,430 [39252] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:35:19')
2014-01-21 18:35:19,431 [39252] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:35:19,431 [39252] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:35:19,468 [36904] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:35:19,927 [39252] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:35:25,871 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:35:25,873 [39252] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:35:25,873 [39252] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:35:25,874 [39252] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:35:25,874 [39252] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:35:26,205 [37776] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:35:26,205 [37776] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:35:28,765 [39252] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:35:28,765 [39252] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:35:28,765 [37776] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:35:28,777 [37776] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:35:28,830 [37776] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:35:40,782 [39252] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 18:35:40,783 [39252] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 18:35:40,818 [39252] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 18:35:53,341 [37776] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:35:53,343 [37776] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:35:53,345 [36904] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:35:53,345 [36904] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:35:53,392 [37776] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:36:01,000 [37776] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 18:36:01,001 [37776] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T02'
2014-01-21 18:36:01,001 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','10')
2014-01-21 18:36:01,002 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','1002')
2014-01-21 18:36:01,002 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','99')
2014-01-21 18:36:01,002 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9906')
2014-01-21 18:36:01,002 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9911')
2014-01-21 18:36:01,002 [37776] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T02','9907')
2014-01-21 18:36:01,003 [37776] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 18:36:01,003 [37776] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T02'
2014-01-21 18:36:01,004 [37776] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 18:36:01,004 [37776] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T02'
2014-01-21 18:36:01,004 [37776] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T02','01','0')
2014-01-21 18:36:01,006 [37776] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T02','0102','1')
2014-01-21 18:36:01,008 [37776] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 18:36:01,008 [37776] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T02'
2014-01-21 18:36:12,227 [37776] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:36:12,227 [37776] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:36:12,229 [37776] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 18:36:12,244 [37776] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 18:36:12')
2014-01-21 18:36:12,245 [37776] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:36:12,245 [37776] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:36:12,266 [39252] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 18:36:12,621 [36904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:36:20,386 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 18:36:20,711 [37776] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 18:36:20,711 [37776] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 18:36:20,997 [37776] DEBUG Servicesys_code - 获取实体列表
2014-01-21 18:36:20,997 [37776] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 18:36:20,999 [37776] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 18:36:22,014 [37776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 18:36:22,371 [36904] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 18:36:22,371 [36904] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 18:36:22,374 [36904] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 18:36:22,992 [36904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-21 18:36:23,520 [36904] DEBUG Servicesys_log - 获取实体列表
2014-01-21 18:36:23,521 [36904] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-21 18:36:23,522 [36904] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-21 18:36:23,714 [39252] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-21 18:36:23,714 [39252] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-21 18:36:23,718 [39252] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-21 18:36:26,135 [37776] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 18:36:26,136 [37776] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 18:36:26,136 [37776] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 18:36:30,231 [37012] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 18:36:30,705 [37012] DEBUG Servicesys_code - 获取实体列表
2014-01-21 18:36:30,705 [37012] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 18:36:30,707 [37012] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 18:36:30,722 [39252] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 18:36:30,722 [39252] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 18:36:31,394 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 18:36:31,731 [37776] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 18:36:31,731 [37776] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 18:36:31,732 [37776] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 18:36:34,947 [36904] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 18:36:34,947 [36904] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 18:36:34,951 [36904] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 18:36:45,062 [36904] DEBUG ServiceModelBase - 获取动态列表
2014-01-21 18:36:45,062 [36904] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-21 18:36:45,062 [36904] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-21 18:37:12,703 [37012] DEBUG Servicesys_user - 获取实体对象
2014-01-21 18:37:12,703 [37012] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 18:37:12,704 [37012] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 18:37:12,708 [37012] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 18:37:12')
2014-01-21 18:37:12,709 [37012] DEBUG Servicemms_project - 获取实体对象
2014-01-21 18:37:12,709 [37012] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 18:37:12,727 [36904] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 18:37:13,074 [37012] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 18:37:16,672 [39252] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 18:37:17,036 [39252] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 18:37:17,037 [39252] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 18:37:17,056 [37012] DEBUG Servicesys_user - 获取实体列表
2014-01-21 18:37:17,056 [37012] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 18:37:17,058 [37012] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 18:37:20,017 [37776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 18:37:20,020 [37776] DEBUG Servicesys_user - 获取动态列表
2014-01-21 18:37:20,020 [37776] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 18:37:20,021 [37776] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 18:37:20,021 [37776] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 18:37:20,517 [37012] DEBUG Servicesys_role - 获取实体列表
2014-01-21 18:37:20,517 [37012] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 18:37:21,912 [37012] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:37:21,912 [37776] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:37:21,912 [37776] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R6' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:37:21,928 [37012] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R6' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R6'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R6'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R6'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R6'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R6'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R6'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R6'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R6'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R6'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R6'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R6'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R6'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R6'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R6'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:37:22,053 [37012] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R6'
2014-01-21 18:39:14,758 [37776] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:39:14,758 [37012] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:39:14,759 [37012] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R6' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:39:14,776 [37776] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R6' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R6'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R6'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R6'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R6'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R6'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R6'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R6'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R6'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R6'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R6'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R6'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R6'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R6'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R6'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:39:14,849 [37776] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R6'
2014-01-21 18:46:09,891 [41720] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:46:09,892 [39980] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:46:09,938 [41720] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T03' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:46:09,938 [39980] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T03' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T03'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T03'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T03'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T03'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T03'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T03'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T03'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T03'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T03'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T03'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T03'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T03'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T03'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T03'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:46:10,009 [39980] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T03'
2014-01-21 18:46:19,688 [37396] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:46:19,690 [37396] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:46:19,690 [41716] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:46:19,691 [41716] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:46:19,748 [37396] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 18:47:03,562 [41720] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 18:47:03,563 [37396] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 18:47:03,563 [37396] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T02' and B.PermissionCode = A.PermissionCode 
2014-01-21 18:47:03,576 [41720] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T02' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T02'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T02'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T02'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T02'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T02'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T02'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T02'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T02'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T02'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T02'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T02'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T02'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T02'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T02'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 18:47:03,623 [41720] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T02'
2014-01-21 19:26:21,605 [41952] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 19:26:21,620 [41952] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 19:26:21,623 [41952] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 19:26:21,623 [41952] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-21 19:26:21,857 [41952] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 19:26:28,063 [40080] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 19:26:50,875 [41952] DEBUG Servicesys_user - 获取实体对象
2014-01-21 19:26:50,882 [41952] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp002'and Password =  '1234'and IsEnable =  'True'
2014-01-21 19:26:50,892 [41952] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp002' 
2014-01-21 19:26:50,905 [41952] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp002','临时工2','fwytech-PC','localhost','上海市','星期二 19:26:50')
2014-01-21 19:26:50,906 [41952] DEBUG Servicemms_project - 获取实体对象
2014-01-21 19:26:50,906 [41952] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 19:26:50,927 [42576] DEBUG Sys - select * from sys_userSetting where UserCode='temp002'
2014-01-21 19:26:51,043 [41300] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp002' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp002'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 19:26:53,102 [40080] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/lossreport/Index','/Mms/lossreport')
2014-01-21 19:26:58,124 [41300] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 19:26:58,128 [41300] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 19:26:58,130 [41300] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 19:26:58,130 [41300] DEBUG Servicesys_code - 获取动态列表
2014-01-21 19:26:58,131 [41300] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 19:27:00,275 [41300] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 19:27:00,276 [41300] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 19:27:00,294 [41300] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 19:27:03,873 [41300] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp002'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2014-01-21 19:39:59,916 [36892] DEBUG Servicesys_user - 获取实体对象
2014-01-21 19:39:59,926 [36892] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 19:39:59,927 [36892] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 19:39:59,931 [36892] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 19:39:59')
2014-01-21 19:39:59,932 [36892] DEBUG Servicemms_project - 获取实体对象
2014-01-21 19:39:59,934 [36892] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 19:39:59,956 [43812] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 19:40:00,158 [36892] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 19:40:10,955 [40536] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 19:40:10,965 [40536] DEBUG Servicesys_user - 获取动态列表
2014-01-21 19:40:10,965 [40536] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 19:40:10,967 [40536] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 19:40:10,967 [40536] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 19:40:12,731 [40536] DEBUG Servicesys_role - 获取实体列表
2014-01-21 19:40:12,734 [40536] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 19:41:13,408 [43292] DEBUG Servicesys_role - 编辑记录
2014-01-21 19:41:13,415 [43292] DEBUG Servicesys_role - 获取动态对象
2014-01-21 19:41:13,417 [43292] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-21 19:41:13,422 [43292] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('北风工作人员','bf001','95','北风工作人员','超级管理员','星期二 19:41:13','超级管理员','星期二 19:41:13')
2014-01-21 19:41:13,584 [42884] DEBUG Servicesys_role - 获取实体列表
2014-01-21 19:41:13,588 [42884] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 19:41:21,001 [43844] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 19:41:21,001 [43844] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 19:41:21,004 [42884] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 19:41:21,021 [42884] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 19:41:21,412 [42884] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 19:42:15,653 [43844] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 19:42:15,656 [43844] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 19:42:15,658 [43844] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 19:42:15,661 [43844] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 19:42:15,662 [43844] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 19:42:15,664 [43844] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 19:42:15,665 [43844] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 19:42:15,668 [43844] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 19:42:15,668 [43844] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 19:42:15,671 [43844] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 19:42:15,672 [43844] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 19:45:37,955 [43888] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 19:45:37,956 [43888] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 19:45:37,979 [39100] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 19:45:37,979 [39100] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 19:45:38,014 [43888] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 19:45:47,575 [39100] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 19:45:47,576 [39100] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 19:45:47,578 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 19:45:47,579 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 19:45:47,579 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 19:45:47,580 [39100] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 19:45:47,580 [39100] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 19:45:47,581 [39100] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 19:45:47,581 [39100] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 19:45:47,581 [39100] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 19:45:47,582 [39100] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 19:46:02,775 [43888] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 19:46:02,778 [43888] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 19:46:02,807 [39100] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 19:46:02,807 [39100] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 19:46:02,843 [43888] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 19:46:17,377 [39100] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 19:46:17,377 [39100] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 19:46:17,378 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','10')
2014-01-21 19:46:17,378 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','1002')
2014-01-21 19:46:17,378 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 19:46:17,379 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 19:46:17,379 [39100] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 19:46:17,379 [39100] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 19:46:17,380 [39100] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 19:46:17,380 [39100] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 19:46:17,380 [39100] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 19:46:17,380 [39100] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 19:46:17,381 [39100] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 19:47:18,595 [43756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 19:47:20,407 [43256] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 19:47:20,407 [43256] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 19:47:29,127 [43256] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 19:47:56,407 [44432] DEBUG Servicesys_menu - 设置菜单按钮
2014-01-21 19:47:56,409 [44432] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '1002'
2014-01-21 19:47:56,412 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','browse')
2014-01-21 19:47:56,415 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','edit')
2014-01-21 19:47:56,419 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','delete')
2014-01-21 19:47:56,420 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','search')
2014-01-21 19:47:56,420 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','refresh')
2014-01-21 19:47:56,423 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','download')
2014-01-21 19:47:56,428 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','print')
2014-01-21 19:47:56,429 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','accredit')
2014-01-21 19:47:56,429 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','audit')
2014-01-21 19:47:56,429 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','copy')
2014-01-21 19:47:56,430 [44432] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','save')
2014-01-21 19:48:04,728 [44060] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 19:55:45,815 [28284] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 19:55:45,818 [28284] DEBUG Servicesys_user - 获取动态列表
2014-01-21 19:55:45,818 [28284] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 19:55:45,819 [28284] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 19:55:45,819 [28284] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 19:55:46,069 [43116] DEBUG Servicesys_role - 获取实体列表
2014-01-21 19:55:46,070 [43116] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 19:55:53,764 [43116] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 19:55:53,765 [43116] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 19:55:53,792 [38304] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 19:55:53,802 [38304] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 19:55:53,905 [43116] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 20:02:23,030 [42900] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 20:02:23,038 [42900] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 20:02:23,038 [42900] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','10')
2014-01-21 20:02:23,038 [42900] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','1002')
2014-01-21 20:02:23,038 [42900] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 20:02:23,039 [42900] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 20:02:23,039 [42900] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 20:02:23,039 [42900] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 20:02:23,039 [42900] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 20:02:23,040 [42900] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('bf001','1002','edit')
2014-01-21 20:02:23,048 [42900] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 20:02:23,048 [42900] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 20:02:23,048 [42900] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 20:02:23,048 [42900] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 20:06:41,306 [38572] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 20:06:41,310 [38572] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 20:06:41,330 [45932] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 20:06:41,333 [45932] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 20:06:41,366 [38572] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 20:11:18,629 [41028] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:11:18,638 [41028] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:11:18,639 [41028] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:11:18,640 [41028] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:11:18,640 [41028] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:11:19,363 [45408] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:11:19,363 [45408] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:11:19,365 [45408] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:14:44,666 [47096] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-21 20:14:44,910 [46924] DEBUG Servicesys_menu - 获取动态列表
2014-01-21 20:14:44,910 [46924] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-21 20:15:08,461 [46924] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-21 20:15:49,154 [46360] DEBUG Servicesys_menu - 设置菜单按钮
2014-01-21 20:15:49,154 [46360] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '1002'
2014-01-21 20:15:49,155 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','add')
2014-01-21 20:15:49,158 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','browse')
2014-01-21 20:15:49,158 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','edit')
2014-01-21 20:15:49,158 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','delete')
2014-01-21 20:15:49,159 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','search')
2014-01-21 20:15:49,159 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','refresh')
2014-01-21 20:15:49,160 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','export')
2014-01-21 20:15:49,161 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','download')
2014-01-21 20:15:49,161 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','print')
2014-01-21 20:15:49,161 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','accredit')
2014-01-21 20:15:49,161 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','audit')
2014-01-21 20:15:49,161 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','inport')
2014-01-21 20:15:49,162 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','copy')
2014-01-21 20:15:49,162 [46360] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1002','save')
2014-01-21 20:16:46,638 [46360] DEBUG Servicesys_user - 获取实体对象
2014-01-21 20:16:46,642 [46360] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-21 20:16:46,642 [46360] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-21 20:16:46,647 [46360] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期二 20:16:46')
2014-01-21 20:16:46,648 [46360] DEBUG Servicemms_project - 获取实体对象
2014-01-21 20:16:46,648 [46360] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 20:16:46,679 [46360] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-21 20:16:46,836 [46360] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 20:16:59,783 [46400] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-21 20:16:59,792 [46400] DEBUG Servicesys_user - 获取动态列表
2014-01-21 20:16:59,792 [46400] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-21 20:16:59,798 [46400] DEBUG Servicesys_organize - 获取动态列表
2014-01-21 20:16:59,798 [46400] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-21 20:16:59,969 [46400] DEBUG Servicesys_role - 获取实体列表
2014-01-21 20:16:59,969 [46400] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-21 20:17:03,777 [46400] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 20:17:03,785 [46400] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 20:17:03,808 [46360] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 20:17:03,809 [46360] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 20:17:03,852 [46400] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 20:17:17,626 [46360] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 20:17:17,627 [46360] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 20:17:17,629 [46360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','10')
2014-01-21 20:17:17,630 [46360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','1002')
2014-01-21 20:17:17,630 [46360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 20:17:17,630 [46360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 20:17:17,630 [46360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 20:17:17,631 [46360] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 20:17:17,633 [46360] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 20:17:17,634 [46360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('bf001','1002','edit')
2014-01-21 20:17:17,635 [46360] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 20:17:17,636 [46360] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 20:17:17,636 [46360] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 20:17:17,636 [46360] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 20:17:20,455 [46400] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-21 20:17:20,457 [46400] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-21 20:17:20,488 [46792] DEBUG Servicesys_permission - 获取动态列表
2014-01-21 20:17:20,489 [46792] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-21 20:17:20,534 [46400] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-21 20:17:27,528 [43116] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-21 20:17:27,532 [43116] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-21 20:17:27,534 [43116] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','10')
2014-01-21 20:17:27,535 [43116] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','1002')
2014-01-21 20:17:27,537 [43116] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-21 20:17:27,541 [43116] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-21 20:17:27,541 [43116] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-21 20:17:27,541 [43116] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-21 20:17:27,541 [43116] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-21 20:17:27,542 [43116] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('bf001','1002','edit')
2014-01-21 20:17:27,542 [43116] DEBUG Servicesys_role - 修改角色数据权限
2014-01-21 20:17:27,542 [43116] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-21 20:17:27,542 [43116] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-21 20:17:27,542 [43116] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-21 20:17:34,121 [46400] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 20:17:35,803 [45536] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 20:17:35,804 [45536] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 20:17:35,831 [45212] DEBUG Servicesys_user - 获取实体列表
2014-01-21 20:17:35,832 [45212] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 20:17:35,889 [45212] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 20:18:12,993 [46400] DEBUG Servicesys_user - 编辑记录
2014-01-21 20:18:12,994 [46400] DEBUG Servicesys_user - 获取动态对象
2014-01-21 20:18:12,995 [46400] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'beifeng'
2014-01-21 20:18:12,997 [46400] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('beifeng','北风','北风用户1','true','超级管理员','星期二 20:18:12','超级管理员','星期二 20:18:12')
2014-01-21 20:18:13,028 [46400] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'beifeng'
2014-01-21 20:18:15,233 [43116] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-21 20:18:16,036 [43116] DEBUG Servicesys_organize - 获取实体列表
2014-01-21 20:18:16,036 [43116] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-21 20:18:16,058 [45212] DEBUG Servicesys_user - 获取实体列表
2014-01-21 20:18:16,058 [45212] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-21 20:18:16,061 [45212] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-21 20:18:22,507 [45212] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'beifeng'
2014-01-21 20:18:34,093 [31600] DEBUG Servicesys_user - 设置用户角色
2014-01-21 20:18:34,093 [31600] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'beifeng'
2014-01-21 20:18:34,094 [31600] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('beifeng','bf001')
2014-01-21 20:18:47,673 [46360] DEBUG Servicesys_user - 获取实体对象
2014-01-21 20:18:47,674 [46360] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'beifeng'and Password =  '1234'and IsEnable =  'True'
2014-01-21 20:18:47,680 [46360] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'beifeng' 
2014-01-21 20:18:47,684 [46360] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('beifeng','北风','fwytech-PC','localhost','上海市','星期二 20:18:47')
2014-01-21 20:18:47,687 [46360] DEBUG Servicemms_project - 获取实体对象
2014-01-21 20:18:47,687 [46360] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-21 20:18:47,710 [43116] DEBUG Sys - select * from sys_userSetting where UserCode='beifeng'
2014-01-21 20:18:47,943 [45212] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'beifeng' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'beifeng'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-21 20:18:52,858 [46360] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 20:18:54,534 [46792] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 20:18:54,535 [46792] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 20:18:54,573 [45536] DEBUG Servicesys_code - 获取实体列表
2014-01-21 20:18:54,574 [45536] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 20:18:54,604 [45536] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 20:19:04,588 [45536] DEBUG Servicesys_code - 编辑记录
2014-01-21 20:19:04,589 [45536] DEBUG Servicesys_code - 获取动态对象
2014-01-21 20:19:04,590 [45536] DEBUG Sys - select sys_code.* from sys_code where  Code =  '001'
2014-01-21 20:19:04,603 [45536] DEBUG Sys - update sys_code set [CodeType] = 'MaterialUse', [Value] = 'Structure', [Text] = '结构材料', [ParentCode] = '0', [Description] = '梁、板、柱、墙体11', [IsEnable] = 'true', [IsDefault] = 'false', [Seq] = '1', [UpdatePerson] = '北风', [UpdateDate] = '星期二 20:19:04' where  Code =  '001'
2014-01-21 20:19:06,869 [46792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 20:19:07,102 [45536] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 20:19:07,102 [45536] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 20:19:07,194 [43116] DEBUG Servicesys_code - 获取实体列表
2014-01-21 20:19:07,194 [43116] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 20:19:07,196 [43116] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 20:19:11,292 [46792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:19:11,301 [46792] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:19:11,301 [46792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:19:11,301 [46792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:19:11,301 [46792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:19:11,733 [45536] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:19:11,733 [45536] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:19:11,735 [45536] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:19:14,048 [43116] DEBUG Servicemms_receive - 获取新主键
2014-01-21 20:19:14,051 [43116] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 20:19:14,176 [45536] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:19:19,094 [46792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:19:19,100 [46792] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:19:19,100 [46792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:19:19,108 [46792] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:19:19,109 [46792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:19:19,608 [40924] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:19:19,609 [40924] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:19:19,611 [40924] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:19:25,126 [40924] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:32:08,222 [43784] DEBUG Servicemms_receive - 获取新主键
2014-01-21 20:32:08,226 [43784] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-21 20:32:08,297 [47448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:32:16,599 [43784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:32:23,717 [43784] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:32:23,717 [43784] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  BillNo =  '201307020024'and A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:32:23,722 [43784] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  BillNo =  '201307020024'and A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:32:34,932 [47448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:32:44,028 [47448] DEBUG Servicesys_code - 获取实体列表
2014-01-21 20:32:44,029 [47448] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PartAttr' order by Seq
2014-01-21 20:32:44,079 [47448] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PartAttr' ) tb_temp
2014-01-21 20:33:07,469 [47184] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:33:07,471 [47184] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:33:07,471 [47184] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:33:07,473 [47184] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:33:07,473 [47184] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:33:07,632 [47184] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:33:07,635 [47184] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:33:07,635 [47184] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:33:07,635 [47184] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:33:07,635 [47184] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:33:08,160 [43784] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:33:08,161 [43784] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:33:08,162 [43784] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:33:09,876 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:33:20,628 [47152] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:33:31,458 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2014-01-21 20:33:33,515 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-21 20:33:35,254 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/check/Index','/Mms/check')
2014-01-21 20:33:39,579 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-21 20:33:49,367 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:33:54,173 [47184] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/edit')
2014-01-21 20:34:00,030 [40280] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:34:00,030 [40280] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  BillNo =  '201307020014'and A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:34:00,038 [40280] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  BillNo =  '201307020014'and A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:34:06,606 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-21 20:34:06,615 [40280] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-21 20:34:06,615 [40280] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-21 20:34:06,616 [40280] DEBUG Servicesys_code - 获取动态列表
2014-01-21 20:34:06,616 [40280] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-21 20:34:07,043 [42044] DEBUG Servicemms_receive - 获取动态列表
2014-01-21 20:34:07,043 [42044] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-21 20:34:07,045 [42044] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-21 20:34:08,688 [40280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 20:34:10,545 [47632] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 20:34:10,546 [47632] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 20:34:10,553 [47632] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-21 20:34:11,487 [47432] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-21 20:34:11,689 [47432] DEBUG Servicesys_codeType - 获取动态列表
2014-01-21 20:34:11,689 [47432] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-21 20:34:11,761 [40280] DEBUG Servicesys_code - 获取实体列表
2014-01-21 20:34:11,761 [40280] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-21 20:34:11,763 [40280] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-21 20:37:06,019 [47632] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'beifeng'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-21 20:37:06,312 [45568] DEBUG Servicesys_parameter - 获取实体列表
2014-01-21 20:37:06,312 [45568] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-21 20:37:06,313 [45568] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
