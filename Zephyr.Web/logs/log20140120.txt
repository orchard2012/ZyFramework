2014-01-20 22:23:58,119 [14560] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 22:23:58,611 [14560] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 22:23:58,632 [14560] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 22:23:58,770 [14560] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 22:24:20,308 [22364] DEBUG Servicesys_user - 获取实体对象
2014-01-20 22:24:20,319 [22364] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 22:24:21,713 [22364] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 22:24:21,981 [22364] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','2014/1/20 22:24:21')
2014-01-20 22:24:22,104 [22364] DEBUG Servicemms_project - 获取实体对象
2014-01-20 22:24:22,106 [22364] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 22:24:22,293 [31688] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 22:24:26,452 [31688] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 22:24:40,852 [14560] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 22:24:50,732 [22364] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 22:24:50,732 [26700] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 22:24:50,733 [22364] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 22:24:50,747 [26700] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 22:24:50,836 [26700] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 22:24:54,604 [26700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/project/Index','/Mms/project')
2014-01-20 22:24:54,613 [26700] DEBUG Servicemms_project - 获取实体对象
2014-01-20 22:24:54,613 [26700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 22:24:54,614 [26700] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 22:24:54,637 [26700] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:54,638 [26700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 22:24:54,641 [26700] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:54,641 [26700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 22:24:54,648 [26700] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:54,648 [26700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 22:24:54,651 [26700] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:54,651 [26700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 22:24:54,675 [26700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 22:24:54,676 [26700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PartAttr'
2014-01-20 22:24:54,678 [26700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 22:24:54,678 [26700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'ImagePart'
2014-01-20 22:24:56,394 [31520] DEBUG Servicemms_project - 获取动态列表
2014-01-20 22:24:56,394 [31520] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 22:24:56,491 [31688] DEBUG Servicemms_project - 获取实体对象
2014-01-20 22:24:56,491 [31688] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 22:24:56,492 [31524] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 22:24:56,492 [31688] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 22:24:56,492 [31688] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:56,492 [31524] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 22:24:56,492 [31688] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 22:24:56,492 [31688] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:56,492 [31688] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 22:24:56,492 [31688] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:56,492 [31688] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 22:24:56,492 [31688] DEBUG Servicemms_project - 获取字段
2014-01-20 22:24:56,493 [31688] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 22:24:59,092 [22364] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/warehouse/Index','/Mms/warehouse')
2014-01-20 22:24:59,988 [31520] DEBUG Servicemms_project - 获取动态列表
2014-01-20 22:24:59,988 [31520] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 22:25:00,019 [31520] DEBUG Servicemms_warehouse - 获取实体列表
2014-01-20 22:25:00,020 [31520] DEBUG Mms - select top 20 mms_warehouse.* from mms_warehouse order by WarehouseCode
2014-01-20 22:25:00,054 [31520] DEBUG Mms - select count(*) from ( select mms_warehouse.* from mms_warehouse ) tb_temp
2014-01-20 22:25:06,906 [22364] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/material/Index','/Mms/material')
2014-01-20 22:25:07,911 [31520] DEBUG Servicemms_materialType - 获取动态列表
2014-01-20 22:25:07,912 [31520] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2014-01-20 22:25:07,927 [31544] DEBUG Servicemms_material - 获取实体列表
2014-01-20 22:25:07,927 [31544] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2014-01-20 22:25:08,112 [31544] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2014-01-20 22:25:18,610 [31544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-20 22:25:20,450 [22364] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-20 22:25:20,450 [31480] DEBUG Servicesys_log - 获取实体列表
2014-01-20 22:25:20,450 [22364] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-20 22:25:20,453 [31480] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-20 22:25:20,458 [22364] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-20 22:25:20,873 [31480] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-20 22:25:30,193 [22364] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 22:25:31,172 [31688] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 22:25:31,173 [31688] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 22:25:31,184 [31688] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 22:25:42,700 [30752] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 22:25:43,121 [31544] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 22:25:43,121 [31544] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 22:25:43,122 [31544] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 22:25:57,567 [29912] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-20 22:25:58,645 [22364] DEBUG Servicesys_codeType - 获取动态列表
2014-01-20 22:25:58,645 [22364] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-20 22:25:58,770 [31544] DEBUG Servicesys_code - 获取实体列表
2014-01-20 22:25:58,771 [31544] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-20 22:25:58,783 [31544] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-20 22:26:06,459 [30752] DEBUG Servicesys_codeType - 获取动态列表
2014-01-20 22:26:06,459 [30752] DEBUG Sys - select top 10 sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-20 22:26:06,460 [30752] DEBUG Sys - select count(*) from ( select sys_codeType.* from sys_codeType ) tb_temp
2014-01-20 22:26:15,766 [29912] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 22:26:16,956 [29912] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 22:26:16,957 [29912] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 22:26:16,982 [26700] DEBUG Servicesys_user - 获取实体列表
2014-01-20 22:26:16,982 [26700] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 22:26:16,988 [26700] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 22:26:31,223 [29912] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 22:26:32,215 [14560] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 22:26:32,216 [14560] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 22:26:48,786 [29980] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 22:26:48,804 [29980] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 22:26:48,804 [29980] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 22:26:52,378 [23452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 22:26:53,239 [30768] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 22:26:53,240 [30768] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 22:26:58,445 [31416] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-20 22:26:58,879 [29980] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-20 22:26:58,879 [29980] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-20 22:26:58,881 [29980] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-20 22:26:58,895 [23452] DEBUG Servicesys_log - 获取实体列表
2014-01-20 22:26:58,895 [23452] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-20 22:26:59,042 [23452] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-20 22:27:01,380 [26700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 22:27:01,686 [29912] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 22:27:01,686 [29912] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 22:27:01,686 [29912] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 22:36:55,238 [28772] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 22:36:55,637 [30880] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 22:36:56,012 [24500] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 22:36:56,455 [30880] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 22:36:56,456 [30880] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 22:36:56,457 [30880] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 22:37:28,276 [30800] DEBUG Servicesys_user - 获取实体对象
2014-01-20 22:37:28,276 [30800] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 22:37:28,277 [30800] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 22:37:28,282 [30800] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','2014/1/20 22:37:28')
2014-01-20 22:37:28,286 [30800] DEBUG Servicemms_project - 获取实体对象
2014-01-20 22:37:28,288 [30800] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 22:37:28,312 [30880] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 22:37:28,537 [30984] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 22:39:33,964 [11824] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 22:39:34,315 [31468] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 22:41:30,211 [11824] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 22:41:30,545 [30948] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 22:41:30,545 [30948] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 22:41:30,546 [30948] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 23:04:07,626 [31484] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:04:07,792 [31484] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:04:07,796 [31484] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:04:07,867 [31484] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:04:31,309 [32492] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:05:15,477 [32096] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:05:15,499 [32096] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:05:15,502 [32096] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:05:15,505 [32096] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:05:16,822 [32096] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:05:21,261 [29524] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:06:21,071 [32096] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 23:12:44,916 [25400] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 23:14:59,868 [25400] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 23:16:27,593 [25400] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 20:01:19,699 [10140] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 20:01:20,269 [10140] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 20:01:20,275 [10140] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 20:01:20,470 [10140] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 20:01:20,764 [10140] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 20:01:27,923 [17412] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:01:35,260 [17412] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-20 20:01:37,295 [15744] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-20 20:01:37,295 [17412] DEBUG Servicesys_log - 获取实体列表
2014-01-20 20:01:37,306 [15744] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-20 20:01:37,310 [17412] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-20 20:01:37,328 [15744] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-20 20:01:37,407 [17412] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-20 20:09:08,014 [20048] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 20:09:12,834 [20048] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 20:09:12,835 [20048] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 20:09:12,842 [20048] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 20:10:06,388 [15864] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-20 20:10:07,600 [22300] DEBUG Servicesys_code - 获取实体列表
2014-01-20 20:10:07,600 [22300] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-20 20:10:07,641 [22300] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-20 20:10:07,961 [21944] DEBUG Servicesys_codeType - 获取动态列表
2014-01-20 20:10:07,962 [21944] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-20 20:10:33,494 [20048] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-01-20 20:10:34,003 [21836] DEBUG Servicesys_loginHistory - 获取实体列表
2014-01-20 20:10:34,003 [21836] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2014-01-20 20:10:34,004 [21836] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2014-01-20 20:10:34,018 [22300] DEBUG Servicesys_log - 获取实体列表
2014-01-20 20:10:34,019 [22300] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2014-01-20 20:10:34,020 [22300] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2014-01-20 21:51:19,504 [17756] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:51:19,564 [17756] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:51:19,568 [17756] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:51:19,572 [17756] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:51:20,295 [17756] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 21:51:26,014 [15720] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 21:51:33,076 [22432] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 21:51:34,633 [22432] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 21:51:34,642 [22432] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 21:51:35,964 [22432] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 21:51:36,028 [22432] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 21:51:36,032 [22432] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 21:51:41,298 [15720] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 21:51:42,403 [17640] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 21:51:42,403 [17640] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 21:56:15,422 [22988] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 21:56:15,899 [22628] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 21:56:15,900 [22628] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 19:56:13,909 [53780] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:56:15,336 [53780] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:56:15,339 [53780] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:56:15,954 [53780] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:56:19,440 [53780] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 19:57:39,673 [54196] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:57:39,686 [54196] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:57:39,689 [54196] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:57:39,689 [54196] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:57:40,294 [54196] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 19:57:54,374 [50520] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 19:58:14,151 [50872] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 19:58:28,679 [50872] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 19:58:28,690 [50872] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 19:58:40,051 [50872] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 19:58:45,181 [53548] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 19:58:45,183 [53548] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 20:01:46,211 [50520] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 20:01:48,405 [50520] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 20:01:48,405 [50520] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 20:02:06,395 [54028] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '0102' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 20:02:30,435 [43516] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '0102' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 20:02:36,297 [53540] DEBUG Servicesys_button - 获取实体列表
2014-01-20 20:02:36,297 [53540] DEBUG Sys - select sys_button.* from sys_button order by ButtonSeq
2014-01-20 20:02:53,087 [43516] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '0102' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 20:41:17,616 [54104] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '0102' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 23:21:38,139 [14000] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:21:38,242 [14000] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:21:38,332 [14000] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:21:38,451 [14000] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:21:40,543 [14000] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:21:50,248 [13680] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:24:08,385 [14428] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:24:08,393 [14428] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:24:08,417 [14428] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:24:08,611 [14428] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:24:08')
2014-01-20 23:24:08,791 [14428] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:24:08,792 [14428] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:24:08,998 [14000] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:24:09,202 [14000] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:24:29,014 [14000] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 23:24:30,251 [14428] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 23:24:30,255 [14428] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 23:24:30,558 [14000] DEBUG Servicesys_user - 获取实体列表
2014-01-20 23:24:30,559 [14000] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 23:24:30,892 [14000] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 23:24:41,979 [8056] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'super'
2014-01-20 23:24:59,431 [14428] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'super'
2014-01-20 23:25:15,819 [14000] DEBUG Servicesys_user - 设置用户角色
2014-01-20 23:25:15,913 [14000] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'super'
2014-01-20 23:25:15,994 [14000] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('super','super')
2014-01-20 23:25:19,451 [14000] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-20 23:25:19,463 [14000] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'super'
2014-01-20 23:25:29,383 [15160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:25:29,397 [15160] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:25:29,398 [15160] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:25:29,404 [15160] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:25:29,404 [15160] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:25:30,262 [14496] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:25:30,263 [14496] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:25:34,103 [14000] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:25:34,123 [14000] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:25:34,129 [14428] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:25:34,130 [14428] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:25:34,328 [14000] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-20 23:26:12,823 [15328] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:26:12,824 [15328] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2014-01-20 23:26:12,827 [15328] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2014-01-20 23:26:12,828 [15328] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2014-01-20 23:26:12,831 [15328] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:26:12,831 [15328] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2014-01-20 23:26:12,843 [15328] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:26:12,844 [15328] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2014-01-20 23:26:12,845 [15328] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2014-01-20 23:26:12,849 [15328] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:26:12,850 [15328] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2014-01-20 23:26:15,315 [15328] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:26:15,316 [15328] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:26:15,351 [14428] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:26:15,351 [14428] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:26:15,360 [15328] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-20 23:30:19,832 [16228] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:30:19,832 [16228] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2014-01-20 23:30:19,833 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2014-01-20 23:30:19,833 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2014-01-20 23:30:19,833 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2014-01-20 23:30:19,835 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2014-01-20 23:30:19,835 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2014-01-20 23:30:19,835 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2014-01-20 23:30:19,835 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2014-01-20 23:30:19,835 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2014-01-20 23:30:19,836 [16228] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2014-01-20 23:30:19,836 [16228] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:30:19,837 [16228] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2014-01-20 23:30:19,837 [16228] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:30:19,837 [16228] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2014-01-20 23:30:19,838 [16228] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2014-01-20 23:30:19,843 [16228] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:30:19,843 [16228] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2014-01-20 23:30:45,171 [16232] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:30:45,171 [16232] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:30:45,172 [16232] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:30:45,177 [16232] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:30:45')
2014-01-20 23:30:45,178 [16232] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:30:45,180 [16232] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:30:45,201 [16228] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:30:45,305 [16228] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:30:53,528 [16232] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 23:30:53,755 [16228] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-20 23:30:54,885 [16228] DEBUG Servicesys_parameter - 获取实体列表
2014-01-20 23:30:54,885 [16228] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-20 23:30:55,014 [16228] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-20 23:31:14,977 [14276] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-20 23:31:15,913 [16232] DEBUG Servicesys_codeType - 获取动态列表
2014-01-20 23:31:15,913 [16232] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-20 23:31:15,992 [14276] DEBUG Servicesys_code - 获取实体列表
2014-01-20 23:31:15,993 [14276] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-20 23:31:16,005 [14276] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-20 23:31:36,056 [15560] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 23:31:36,289 [12468] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 23:31:36,289 [12468] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 23:31:36,316 [12436] DEBUG Servicesys_user - 获取实体列表
2014-01-20 23:31:36,316 [12436] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 23:31:36,318 [12436] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 23:31:38,435 [16232] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:31:38,439 [16232] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:31:38,439 [16232] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:31:38,439 [16232] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:31:38,439 [16232] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:31:38,570 [16228] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:31:38,570 [16228] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:31:44,273 [12436] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:31:44,274 [12436] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:31:44,302 [14276] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:31:44,302 [14276] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:31:44,412 [12436] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:31:50,921 [16228] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'R3')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'R3')
2014-01-20 23:32:02,851 [12468] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:32:02,853 [12468] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:32:02,897 [16232] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:32:02,897 [16232] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:32:02,912 [12468] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:32:34,554 [14276] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'admin'
2014-01-20 23:32:39,811 [14276] DEBUG Servicesys_user - 设置用户角色
2014-01-20 23:32:39,812 [14276] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'admin'
2014-01-20 23:32:39,812 [14276] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('admin','R3')
2014-01-20 23:32:58,347 [14276] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:32:58,349 [14276] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:32:58,376 [15560] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:32:58,377 [15560] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:32:58,389 [14276] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:33:30,649 [15560] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:33:30,654 [15560] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:33:30,658 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 23:33:30,663 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 23:33:30,666 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 23:33:30,666 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 23:33:30,667 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 23:33:30,674 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 23:33:30,675 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 23:33:30,675 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 23:33:30,675 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 23:33:30,676 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 23:33:30,676 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 23:33:30,677 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1008')
2014-01-20 23:33:30,678 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1005')
2014-01-20 23:33:30,680 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1004')
2014-01-20 23:33:30,680 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0101')
2014-01-20 23:33:30,680 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100101')
2014-01-20 23:33:30,682 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100201')
2014-01-20 23:33:30,682 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100312')
2014-01-20 23:33:30,682 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100401')
2014-01-20 23:33:30,682 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100501')
2014-01-20 23:33:30,683 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100601')
2014-01-20 23:33:30,684 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100701')
2014-01-20 23:33:30,685 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100801')
2014-01-20 23:33:30,685 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100901')
2014-01-20 23:33:30,686 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101001')
2014-01-20 23:33:30,686 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101101')
2014-01-20 23:33:30,686 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101201')
2014-01-20 23:33:30,686 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101301')
2014-01-20 23:33:30,686 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','11')
2014-01-20 23:33:30,687 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1105')
2014-01-20 23:33:30,687 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1101')
2014-01-20 23:33:30,688 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1102')
2014-01-20 23:33:30,689 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1103')
2014-01-20 23:33:30,689 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1104')
2014-01-20 23:33:30,689 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1109')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','03')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0301')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0302')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0303')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0304')
2014-01-20 23:33:30,690 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:33:30,691 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:33:30,691 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:33:30,691 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:33:30,691 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','99')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9902')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9903')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9910')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9904')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9905')
2014-01-20 23:33:30,692 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9906')
2014-01-20 23:33:30,693 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9911')
2014-01-20 23:33:30,693 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9907')
2014-01-20 23:33:30,694 [15560] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:33:30,694 [15560] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:33:30,695 [15560] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:33:30,695 [15560] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:33:30,697 [15560] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:33:30,697 [15560] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:33:42,560 [15544] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:33:42,564 [15544] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:33:42,593 [14988] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:33:42,593 [14988] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:33:42,603 [15544] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:34:59,361 [15560] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:34:59,367 [15560] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:34:59,369 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:34:59,370 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:34:59,379 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:34:59,379 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:34:59,379 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:34:59,381 [15560] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:34:59,381 [15560] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:34:59,381 [15560] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:34:59,381 [15560] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:34:59,382 [15560] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:34:59,382 [15560] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:35:02,759 [15560] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:35:02,762 [15560] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:35:02,804 [2664] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:35:02,804 [2664] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:35:02,815 [15560] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:36:15,346 [15560] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:36:15,348 [15560] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:36:15,349 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:36:15,349 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:36:15,349 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:36:15,349 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:36:15,350 [15560] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:36:15,350 [15560] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:36:15,350 [15560] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:36:15,350 [15560] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:36:15,351 [15560] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:36:15,351 [15560] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:36:15,351 [15560] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:36:18,764 [15644] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'R3')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'R3')
2014-01-20 23:36:29,635 [15648] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:36:29,639 [15648] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:36:29,665 [15560] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:36:29,665 [15560] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:36:29,679 [15648] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:36:36,830 [15560] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:36:36,831 [15560] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Guest' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Guest'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Guest'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Guest'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Guest'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Guest'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Guest'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Guest'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Guest'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Guest'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Guest'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Guest'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Guest'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Guest'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Guest'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:36:36,856 [5008] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:36:36,856 [5008] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Guest' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:36:36,939 [15560] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Guest'
2014-01-20 23:37:03,470 [15648] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:37:03,471 [15648] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:37:03,500 [5008] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:37:03,500 [5008] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:37:03,514 [15648] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:37:15,202 [5008] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:37:15,207 [5008] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:37:15,209 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','11')
2014-01-20 23:37:15,212 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1105')
2014-01-20 23:37:15,213 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1101')
2014-01-20 23:37:15,213 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1102')
2014-01-20 23:37:15,214 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1103')
2014-01-20 23:37:15,214 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1104')
2014-01-20 23:37:15,214 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1109')
2014-01-20 23:37:15,214 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:37:15,214 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:37:15,220 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:37:15,220 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:37:15,221 [5008] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:37:15,221 [5008] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:37:15,221 [5008] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:37:15,221 [5008] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:37:15,221 [5008] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:37:15,222 [5008] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:37:15,222 [5008] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:37:16,872 [15648] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:37:16,872 [15648] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:37:16,908 [5008] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:37:16,908 [5008] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:37:16,908 [15648] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:37:43,262 [16216] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:37:43,267 [16216] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:37:43,268 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','11')
2014-01-20 23:37:43,268 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1105')
2014-01-20 23:37:43,280 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1101')
2014-01-20 23:37:43,281 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1102')
2014-01-20 23:37:43,282 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1103')
2014-01-20 23:37:43,282 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1104')
2014-01-20 23:37:43,282 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1109')
2014-01-20 23:37:43,282 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:37:43,283 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:37:43,283 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:37:43,283 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:37:43,284 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:37:43,291 [16216] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:37:43,292 [16216] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:37:43,292 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','add')
2014-01-20 23:37:43,295 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','browse')
2014-01-20 23:37:43,298 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','edit')
2014-01-20 23:37:43,306 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','delete')
2014-01-20 23:37:43,308 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','search')
2014-01-20 23:37:43,309 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','refresh')
2014-01-20 23:37:43,312 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','export')
2014-01-20 23:37:43,322 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','download')
2014-01-20 23:37:43,334 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','print')
2014-01-20 23:37:43,337 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','accredit')
2014-01-20 23:37:43,338 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','audit')
2014-01-20 23:37:43,338 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','inport')
2014-01-20 23:37:43,338 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','copy')
2014-01-20 23:37:43,338 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','save')
2014-01-20 23:37:43,339 [16216] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:37:43,339 [16216] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:37:43,339 [16216] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:37:43,339 [16216] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:37:53,013 [14160] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:37:53,013 [14160] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:37:53,019 [14160] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:37:53,023 [14160] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:37:53')
2014-01-20 23:37:53,025 [14160] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:37:53,028 [14160] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:37:53,068 [15648] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:37:53,234 [15648] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:37:56,317 [14160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-20 23:37:56,341 [14160] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:37:56,341 [14160] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:37:56,453 [14160] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-20 23:37:56,453 [14160] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 23:37:57,983 [15672] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-20 23:37:59,075 [15672] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-20 23:37:59,289 [15672] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-20 23:38:22,061 [16216] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:38:22,062 [16216] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:38:22,073 [16216] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:38:22,077 [16216] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:38:22')
2014-01-20 23:38:22,078 [16216] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:38:22,078 [16216] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:38:22,105 [16216] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:38:22,171 [5008] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:38:28,475 [5008] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:38:28,486 [5008] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:38:28,486 [5008] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:38:28,486 [5008] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:38:28,486 [5008] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:38:28,637 [16216] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:38:28,637 [16216] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:38:32,015 [16216] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:38:32,026 [16216] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:38:32,044 [5008] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:38:32,044 [5008] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:38:32,061 [16216] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:39:35,269 [16216] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:39:35,269 [16216] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:39:35,270 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','11')
2014-01-20 23:39:35,270 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1105')
2014-01-20 23:39:35,270 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1101')
2014-01-20 23:39:35,271 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1102')
2014-01-20 23:39:35,271 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1103')
2014-01-20 23:39:35,271 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1104')
2014-01-20 23:39:35,271 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1109')
2014-01-20 23:39:35,272 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 23:39:35,272 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 23:39:35,272 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 23:39:35,272 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 23:39:35,272 [16216] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 23:39:35,273 [16216] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:39:35,273 [16216] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:39:35,395 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','add')
2014-01-20 23:39:35,397 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','browse')
2014-01-20 23:39:35,397 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','edit')
2014-01-20 23:39:35,398 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','delete')
2014-01-20 23:39:35,398 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','search')
2014-01-20 23:39:35,399 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','refresh')
2014-01-20 23:39:35,399 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','download')
2014-01-20 23:39:35,400 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','print')
2014-01-20 23:39:35,402 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','accredit')
2014-01-20 23:39:35,403 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','audit')
2014-01-20 23:39:35,404 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','inport')
2014-01-20 23:39:35,404 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','copy')
2014-01-20 23:39:35,404 [16216] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1105','save')
2014-01-20 23:39:35,405 [16216] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:39:35,406 [16216] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:39:35,406 [16216] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:39:35,406 [16216] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:39:45,848 [16216] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:39:45,849 [16216] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:39:50,874 [13052] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:39:50,875 [13052] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:39:50,876 [13052] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:39:50,881 [13052] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:39:50')
2014-01-20 23:39:50,882 [13052] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:39:50,882 [13052] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:39:50,912 [5008] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:39:51,016 [13052] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:39:55,172 [15848] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-20 23:39:55,188 [15848] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:39:55,188 [15848] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:39:55,189 [15848] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-20 23:39:55,189 [15848] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 23:39:55,320 [5008] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-20 23:39:55,321 [5008] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-20 23:39:55,324 [5008] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-20 23:40:22,607 [13408] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:40:22,607 [13408] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:40:22,610 [13408] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:40:22,615 [13408] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:40:22')
2014-01-20 23:40:22,616 [13408] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:40:22,616 [13408] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:40:22,635 [5008] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:40:22,721 [12240] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:40:26,695 [15848] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 23:40:27,269 [15580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:40:27,273 [15580] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:40:27,273 [15580] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:40:27,273 [15580] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:40:27,274 [15580] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:40:28,048 [16216] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:40:28,048 [16216] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:40:28,194 [15580] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:40:28,195 [15580] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 23:40:31,649 [13408] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:40:31,650 [13408] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:40:31,677 [15580] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:40:31,677 [15580] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:40:31,694 [13408] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:42:17,918 [12240] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:42:17,918 [12240] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:42:17,919 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 23:42:17,919 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 23:42:17,919 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 23:42:17,919 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 23:42:17,919 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 23:42:17,920 [12240] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 23:42:17,921 [12240] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:42:17,921 [12240] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:42:17,921 [12240] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','add')
2014-01-20 23:42:17,922 [12240] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:42:17,922 [12240] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:42:17,922 [12240] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:42:17,923 [12240] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:42:28,404 [15648] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:42:28,405 [15648] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:42:32,967 [13516] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:42:32,967 [13516] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:42:32,969 [13516] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:42:32,975 [13516] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:42:32')
2014-01-20 23:42:32,978 [13516] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:42:32,978 [13516] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:42:33,009 [16216] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:42:33,102 [15564] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:42:36,998 [15564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 23:42:37,016 [15564] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:42:37,017 [15564] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:42:37,020 [15564] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:42:37,020 [15564] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:42:38,462 [8804] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:42:38,463 [8804] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:42:38,477 [8804] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:42:42,205 [13516] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:42:42,206 [13516] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:42:42,338 [12240] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:43:05,364 [15564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:43:12,665 [12240] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:43:12,665 [12240] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:43:12,701 [16296] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:43:25,648 [15648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 23:43:25,657 [15648] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:43:25,657 [15648] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:43:25,658 [15648] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:43:25,658 [15648] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 23:43:25,659 [15648] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:43:25,659 [15648] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 23:43:27,141 [15648] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 23:43:27,144 [15648] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2014-01-20 23:43:27,159 [15648] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 23:43:27,160 [15648] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2014-01-20 23:43:27,532 [16388] DEBUG Servicemms_send - 获取动态列表
2014-01-20 23:43:27,533 [16388] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:43:27,562 [16388] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:43:31,490 [16392] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2014-01-20 23:43:31,504 [16392] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:43:31,504 [16392] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:43:31,505 [16392] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:43:31,505 [16392] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:43:32,455 [16388] DEBUG Servicemms_direct - 获取动态列表
2014-01-20 23:43:32,455 [16388] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:43:32,470 [16388] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:43:34,068 [16216] DEBUG Servicemms_direct - 获取新主键
2014-01-20 23:43:34,069 [16216] DEBUG Mms - select isnull(max(BillNo),0) from mms_direct
2014-01-20 23:43:34,114 [13732] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/direct/edit')
2014-01-20 23:43:44,303 [13544] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:43:44,303 [13544] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:43:44,385 [16216] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:43:57,542 [16388] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 23:43:57,544 [16388] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:43:57,545 [16388] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:43:57,546 [16388] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:43:57,546 [16388] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:43:57,866 [13732] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:43:57,866 [13732] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:43:57,869 [13732] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:44:10,351 [16296] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:44:10,352 [16296] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:44:10,369 [16296] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:44:10,377 [16296] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:44:10')
2014-01-20 23:44:10,378 [16296] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:44:10,378 [16296] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:44:10,408 [15648] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:44:10,558 [16388] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:44:27,770 [13732] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:44:27,774 [13732] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:44:27,774 [13732] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:44:27,782 [13732] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:44:27,782 [13732] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:44:27,930 [12240] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:44:27,930 [12240] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:44:32,199 [13732] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:44:32,200 [13732] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:44:32,229 [16392] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:44:32,229 [16392] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:44:32,241 [13732] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:44:48,509 [15648] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:44:48,510 [15648] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:44:48,510 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 23:44:48,511 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 23:44:48,511 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 23:44:48,511 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 23:44:48,511 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 23:44:48,512 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 23:44:48,512 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 23:44:48,513 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 23:44:48,513 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 23:44:48,514 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 23:44:48,514 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 23:44:48,514 [15648] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 23:44:48,514 [15648] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:44:48,515 [15648] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:44:48,515 [15648] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','add')
2014-01-20 23:44:48,516 [15648] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','edit')
2014-01-20 23:44:48,516 [15648] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:44:48,517 [15648] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:44:48,517 [15648] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:44:48,517 [15648] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:45:01,063 [15648] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:45:01,064 [15648] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:45:01,069 [15648] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:45:01,073 [15648] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:45:01')
2014-01-20 23:45:01,074 [15648] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:45:01,074 [15648] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:45:01,104 [14992] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:45:01,273 [15648] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:45:03,059 [15648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 23:45:03,060 [15648] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:45:03,060 [15648] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:45:03,061 [15648] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:45:03,061 [15648] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:45:03,413 [15648] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:45:03,413 [15648] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:45:03,414 [15648] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:45:05,781 [15648] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:45:05,781 [15648] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:45:05,814 [14992] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:45:10,784 [15648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:45:18,474 [14992] DEBUG Servicemms_receive - 删除记录
2014-01-20 23:45:18,477 [14992] DEBUG Mms - delete from mms_receiveDetail where [BillNo] = '201307220002'
2014-01-20 23:45:18,480 [14992] DEBUG Mms - delete from mms_receive where  BillNo =  '201307220002'
2014-01-20 23:45:18,596 [14992] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:45:18,598 [14992] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:45:18,599 [14992] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:45:32,000 [14832] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:45:32,000 [14832] DEBUG Mms - select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:46:19,611 [15648] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:46:19,611 [15648] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:46:19,613 [15648] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:46:19,618 [15648] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:46:19')
2014-01-20 23:46:19,662 [15648] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:46:19,663 [15648] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:46:19,695 [14828] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:46:19,767 [13952] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:46:23,307 [15640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:46:23,309 [15640] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:46:23,309 [15640] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:46:23,312 [15640] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:46:23,312 [15640] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:46:23,468 [13952] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:46:23,469 [13952] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:46:25,605 [15648] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:46:25,606 [15648] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:46:25,649 [12484] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:46:25,649 [12484] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:46:25,650 [15648] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:46:47,645 [12484] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:46:47,646 [12484] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:46:47,646 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 23:46:47,646 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 23:46:47,646 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 23:46:47,647 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 23:46:47,647 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 23:46:47,647 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 23:46:47,648 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 23:46:47,649 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 23:46:47,649 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 23:46:47,649 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 23:46:47,650 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 23:46:47,650 [12484] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 23:46:47,651 [12484] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:46:47,651 [12484] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:46:47,651 [12484] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','edit')
2014-01-20 23:46:47,652 [12484] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','delete')
2014-01-20 23:46:47,652 [12484] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','export')
2014-01-20 23:46:47,652 [12484] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:46:47,653 [12484] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:46:47,653 [12484] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:46:47,653 [12484] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:47:00,414 [15640] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:47:00,414 [15640] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:47:00,415 [15640] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:47:00,420 [15640] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:47:00')
2014-01-20 23:47:00,421 [15640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:47:00,421 [15640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:47:00,458 [12484] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:47:00,594 [10112] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:47:02,715 [15648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 23:47:02,720 [15648] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:47:02,720 [15648] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:47:02,725 [15648] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:47:02,725 [15648] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:47:03,125 [13952] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:47:03,125 [13952] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:47:03,128 [13952] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:47:04,681 [14828] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:47:04,681 [14828] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:47:04,714 [15648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:47:13,967 [10112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:47:27,211 [15952] DEBUG Servicemms_receive - 删除记录
2014-01-20 23:47:27,214 [15952] DEBUG Mms - delete from mms_receiveDetail where [BillNo] = '201307230001'
2014-01-20 23:47:27,214 [15952] DEBUG Mms - delete from mms_receive where  BillNo =  '201307230001'
2014-01-20 23:47:27,316 [13952] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:47:27,317 [13952] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:47:27,319 [13952] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:47:31,930 [15952] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:47:31,930 [15952] DEBUG Mms - select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:47:53,462 [12484] DEBUG Servicemms_receive - 获取新主键
2014-01-20 23:47:53,462 [12484] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 23:47:53,509 [12484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2014-01-20 23:48:24,845 [12484] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:48:24,845 [12484] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:48:24,847 [12484] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 23:48:24,855 [12484] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','14/01/20 23:48:24')
2014-01-20 23:48:24,856 [12484] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:48:24,856 [12484] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:48:24,885 [14992] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 23:48:25,020 [12484] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:48:29,834 [14992] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 23:48:29,839 [14992] DEBUG Servicesys_user - 获取动态列表
2014-01-20 23:48:29,839 [14992] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 23:48:29,839 [14992] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 23:48:29,839 [14992] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 23:48:30,020 [14992] DEBUG Servicesys_role - 获取实体列表
2014-01-20 23:48:30,021 [14992] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 23:48:31,473 [12484] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 23:48:31,475 [12484] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 23:48:31,516 [14992] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 23:48:31,516 [14992] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 23:48:31,517 [12484] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 23:49:32,712 [14396] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 23:49:32,717 [14396] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 23:49:32,717 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 23:49:32,718 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 23:49:32,719 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 23:49:32,719 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 23:49:32,719 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 23:49:32,719 [14396] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 23:49:32,719 [14396] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 23:49:32,720 [14396] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 23:49:32,720 [14396] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','edit')
2014-01-20 23:49:32,720 [14396] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','delete')
2014-01-20 23:49:32,720 [14396] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','1002','export')
2014-01-20 23:49:32,721 [14396] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 23:49:32,721 [14396] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 23:49:32,721 [14396] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-20 23:49:32,723 [14396] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-20 23:49:32,727 [14396] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 23:49:32,729 [14396] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 23:49:47,444 [13052] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:49:47,444 [13052] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2014-01-20 23:49:51,473 [16824] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:49:51,473 [16824] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:49:51,474 [16824] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:49:51,478 [16824] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:49:51')
2014-01-20 23:49:51,479 [16824] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:49:51,479 [16824] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:49:51,507 [12484] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:49:51,578 [14396] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:49:54,365 [15044] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 23:49:54,371 [15044] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 23:49:54,371 [15044] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 23:49:54,372 [15044] DEBUG Servicesys_code - 获取动态列表
2014-01-20 23:49:54,372 [15044] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 23:49:54,759 [13052] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 23:49:54,759 [13052] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 23:49:54,760 [13052] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 23:50:32,232 [7576] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 23:50:32,233 [7576] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-20 23:50:32,239 [7576] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-20 23:56:07,567 [14092] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:56:07,609 [14092] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:56:07,621 [14092] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:56:07,622 [14092] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 23:56:07,924 [14092] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:56:15,177 [14092] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 23:58:34,991 [16708] DEBUG Servicesys_user - 获取实体对象
2014-01-20 23:58:35,025 [16708] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 23:58:35,085 [16708] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 23:58:35,113 [16708] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','14/01/20 23:58:35')
2014-01-20 23:58:35,158 [16708] DEBUG Servicemms_project - 获取实体对象
2014-01-20 23:58:35,159 [16708] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 23:58:35,290 [16292] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 23:58:35,539 [18384] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:28:47,160 [33696] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 15:28:49,095 [33696] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 15:28:49,210 [33696] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 15:28:49,294 [33696] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 15:28:50,522 [33696] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 15:28:57,645 [29876] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:29:31,295 [29876] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:29:31,304 [29876] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:29:31,526 [29876] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:29:31,695 [29876] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:29:31')
2014-01-20 15:29:31,889 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:29:31,890 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:29:32,000 [27836] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:29:32,257 [34740] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:29:39,446 [33696] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:29:39,520 [33696] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:29:39,520 [33696] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:29:39,521 [33696] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:29:39,522 [33696] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:29:41,377 [33696] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:29:41,379 [33696] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:29:44,148 [33696] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:29:44,154 [34740] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:29:44,178 [33696] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:29:44,216 [34740] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:29:44,413 [33696] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-20 15:30:23,986 [29964] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:30:24,024 [29964] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2014-01-20 15:30:24,038 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2014-01-20 15:30:24,040 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2014-01-20 15:30:24,045 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2014-01-20 15:30:24,046 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2014-01-20 15:30:24,046 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2014-01-20 15:30:24,046 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2014-01-20 15:30:24,047 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2014-01-20 15:30:24,047 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2014-01-20 15:30:24,047 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2014-01-20 15:30:24,048 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2014-01-20 15:30:24,048 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2014-01-20 15:30:24,048 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2014-01-20 15:30:24,048 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2014-01-20 15:30:24,049 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2014-01-20 15:30:24,049 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2014-01-20 15:30:24,049 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2014-01-20 15:30:24,049 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2014-01-20 15:30:24,051 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2014-01-20 15:30:24,052 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2014-01-20 15:30:24,053 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2014-01-20 15:30:24,054 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2014-01-20 15:30:24,054 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2014-01-20 15:30:24,054 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2014-01-20 15:30:24,054 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2014-01-20 15:30:24,054 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2014-01-20 15:30:24,055 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2014-01-20 15:30:24,055 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2014-01-20 15:30:24,055 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2014-01-20 15:30:24,055 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2014-01-20 15:30:24,055 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2014-01-20 15:30:24,056 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2014-01-20 15:30:24,056 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2014-01-20 15:30:24,056 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2014-01-20 15:30:24,056 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2014-01-20 15:30:24,056 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2014-01-20 15:30:24,057 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2014-01-20 15:30:24,059 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2014-01-20 15:30:24,060 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2014-01-20 15:30:24,060 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2014-01-20 15:30:24,060 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2014-01-20 15:30:24,060 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2014-01-20 15:30:24,061 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2014-01-20 15:30:24,061 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2014-01-20 15:30:24,080 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2014-01-20 15:30:24,081 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2014-01-20 15:30:24,081 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2014-01-20 15:30:24,082 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2014-01-20 15:30:24,082 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2014-01-20 15:30:24,082 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2014-01-20 15:30:24,082 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2014-01-20 15:30:24,082 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2014-01-20 15:30:24,083 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2014-01-20 15:30:24,083 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2014-01-20 15:30:24,083 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2014-01-20 15:30:24,083 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2014-01-20 15:30:24,084 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2014-01-20 15:30:24,084 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2014-01-20 15:30:24,084 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2014-01-20 15:30:24,085 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2014-01-20 15:30:24,085 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2014-01-20 15:30:24,085 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2014-01-20 15:30:24,085 [29964] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2014-01-20 15:30:24,090 [29964] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:30:24,091 [29964] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2014-01-20 15:30:24,093 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','browse')
2014-01-20 15:30:24,095 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','edit')
2014-01-20 15:30:24,098 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','delete')
2014-01-20 15:30:24,098 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','search')
2014-01-20 15:30:24,098 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','refresh')
2014-01-20 15:30:24,100 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','export')
2014-01-20 15:30:24,101 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','download')
2014-01-20 15:30:24,103 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','print')
2014-01-20 15:30:24,110 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','accredit')
2014-01-20 15:30:24,111 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','audit')
2014-01-20 15:30:24,111 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','inport')
2014-01-20 15:30:24,111 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','copy')
2014-01-20 15:30:24,111 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','save')
2014-01-20 15:30:24,112 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2014-01-20 15:30:24,114 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2014-01-20 15:30:24,114 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2014-01-20 15:30:24,114 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','search')
2014-01-20 15:30:24,116 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','refresh')
2014-01-20 15:30:24,116 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','download')
2014-01-20 15:30:24,117 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','audit')
2014-01-20 15:30:24,117 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1009','add')
2014-01-20 15:30:24,117 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1009','browse')
2014-01-20 15:30:24,117 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1009','edit')
2014-01-20 15:30:24,117 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1009','delete')
2014-01-20 15:30:24,118 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','add')
2014-01-20 15:30:24,119 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','browse')
2014-01-20 15:30:24,119 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','edit')
2014-01-20 15:30:24,120 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','delete')
2014-01-20 15:30:24,120 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','search')
2014-01-20 15:30:24,120 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','refresh')
2014-01-20 15:30:24,120 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','export')
2014-01-20 15:30:24,121 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','download')
2014-01-20 15:30:24,121 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','print')
2014-01-20 15:30:24,121 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','accredit')
2014-01-20 15:30:24,121 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','audit')
2014-01-20 15:30:24,121 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','inport')
2014-01-20 15:30:24,122 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','copy')
2014-01-20 15:30:24,122 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1010','save')
2014-01-20 15:30:24,122 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','add')
2014-01-20 15:30:24,122 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','edit')
2014-01-20 15:30:24,122 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','delete')
2014-01-20 15:30:24,123 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','search')
2014-01-20 15:30:24,123 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','refresh')
2014-01-20 15:30:24,123 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','export')
2014-01-20 15:30:24,123 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','download')
2014-01-20 15:30:24,124 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','print')
2014-01-20 15:30:24,124 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','accredit')
2014-01-20 15:30:24,124 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','audit')
2014-01-20 15:30:24,124 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','inport')
2014-01-20 15:30:24,125 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','0101','save')
2014-01-20 15:30:24,126 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','add')
2014-01-20 15:30:24,128 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','browse')
2014-01-20 15:30:24,130 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','edit')
2014-01-20 15:30:24,137 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','delete')
2014-01-20 15:30:24,138 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','search')
2014-01-20 15:30:24,138 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','refresh')
2014-01-20 15:30:24,140 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','export')
2014-01-20 15:30:24,140 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','download')
2014-01-20 15:30:24,143 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','print')
2014-01-20 15:30:24,145 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','accredit')
2014-01-20 15:30:24,145 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','audit')
2014-01-20 15:30:24,146 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','inport')
2014-01-20 15:30:24,146 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','copy')
2014-01-20 15:30:24,146 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','101301','save')
2014-01-20 15:30:24,146 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','add')
2014-01-20 15:30:24,146 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','browse')
2014-01-20 15:30:24,147 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','edit')
2014-01-20 15:30:24,147 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','delete')
2014-01-20 15:30:24,147 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','search')
2014-01-20 15:30:24,147 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','refresh')
2014-01-20 15:30:24,148 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','export')
2014-01-20 15:30:24,148 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','download')
2014-01-20 15:30:24,148 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','print')
2014-01-20 15:30:24,148 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','accredit')
2014-01-20 15:30:24,148 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','audit')
2014-01-20 15:30:24,149 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','inport')
2014-01-20 15:30:24,149 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','copy')
2014-01-20 15:30:24,149 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1105','save')
2014-01-20 15:30:24,149 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','add')
2014-01-20 15:30:24,150 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','edit')
2014-01-20 15:30:24,150 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','delete')
2014-01-20 15:30:24,150 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','refresh')
2014-01-20 15:30:24,150 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','download')
2014-01-20 15:30:24,151 [29964] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','audit')
2014-01-20 15:30:24,153 [29964] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:30:24,154 [29964] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2014-01-20 15:30:24,156 [29964] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','1')
2014-01-20 15:30:24,163 [29964] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:30:24,169 [29964] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2014-01-20 15:30:41,475 [7620] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:30:41,476 [7620] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:30:41,477 [7620] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:30:41,480 [7620] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:30:41')
2014-01-20 15:30:41,482 [7620] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:30:41,482 [7620] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:30:41,502 [29964] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:30:41,611 [29964] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:31:02,023 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:31:02,027 [29876] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:31:02,027 [29876] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:31:02,027 [29876] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:31:02,027 [29876] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:31:02,302 [27836] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:31:02,302 [27836] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:31:17,951 [27836] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:31:17,958 [27836] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:31:18,022 [34140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:31:18,036 [34140] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:31:18,119 [27836] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 15:33:32,563 [34740] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:33:32,564 [34740] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 15:33:32,566 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 15:33:32,570 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 15:33:32,572 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 15:33:32,573 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 15:33:32,573 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 15:33:32,573 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 15:33:32,573 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 15:33:32,573 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','03')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0301')
2014-01-20 15:33:32,574 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0302')
2014-01-20 15:33:32,575 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0303')
2014-01-20 15:33:32,575 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0304')
2014-01-20 15:33:32,575 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 15:33:32,575 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 15:33:32,575 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','99')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9902')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9903')
2014-01-20 15:33:32,576 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9910')
2014-01-20 15:33:32,577 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9904')
2014-01-20 15:33:32,577 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9905')
2014-01-20 15:33:32,577 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9906')
2014-01-20 15:33:32,577 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9911')
2014-01-20 15:33:32,577 [34740] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9907')
2014-01-20 15:33:32,578 [34740] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:33:32,578 [34740] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 15:33:32,581 [34740] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:33:32,582 [34740] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 15:33:32,583 [34740] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-20 15:33:32,586 [34740] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-20 15:33:32,599 [34740] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:33:32,599 [34740] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 15:33:34,327 [7620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:33:34,328 [7620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:33:34,357 [34140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:33:34,357 [34140] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:33:34,384 [7620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 15:33:41,501 [34140] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:33:41,502 [34140] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2014-01-20 15:33:41,503 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2014-01-20 15:33:41,503 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1019')
2014-01-20 15:33:41,504 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2014-01-20 15:33:41,509 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2014-01-20 15:33:41,509 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2014-01-20 15:33:41,510 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2014-01-20 15:33:41,510 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2014-01-20 15:33:41,510 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2014-01-20 15:33:41,510 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','03')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0301')
2014-01-20 15:33:41,511 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0302')
2014-01-20 15:33:41,512 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0303')
2014-01-20 15:33:41,512 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0304')
2014-01-20 15:33:41,512 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2014-01-20 15:33:41,513 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2014-01-20 15:33:41,513 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2014-01-20 15:33:41,513 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2014-01-20 15:33:41,513 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2014-01-20 15:33:41,514 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','99')
2014-01-20 15:33:41,514 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9902')
2014-01-20 15:33:41,515 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9903')
2014-01-20 15:33:41,515 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9910')
2014-01-20 15:33:41,515 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9904')
2014-01-20 15:33:41,516 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9905')
2014-01-20 15:33:41,516 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9906')
2014-01-20 15:33:41,516 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9911')
2014-01-20 15:33:41,516 [34140] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9907')
2014-01-20 15:33:41,517 [34140] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:33:41,517 [34140] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2014-01-20 15:33:41,517 [34140] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:33:41,518 [34140] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2014-01-20 15:33:41,518 [34140] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','01','0')
2014-01-20 15:33:41,518 [34140] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('R3','0102','1')
2014-01-20 15:33:41,519 [34140] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:33:41,519 [34140] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2014-01-20 15:33:58,681 [7620] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:33:58,681 [7620] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-20 15:33:58,682 [7620] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-20 15:33:58,687 [7620] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','星期一 15:33:58')
2014-01-20 15:33:58,690 [7620] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:33:58,690 [7620] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:33:58,713 [8144] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-20 15:33:58,873 [8144] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:34:18,499 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:34:18,517 [29876] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:34:18,517 [29876] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:34:18,518 [29876] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:34:18,518 [29876] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:34:18,741 [8144] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:34:18,741 [8144] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:34:21,113 [32944] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:34:21,116 [32944] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:34:21,151 [29876] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:34:21,151 [29876] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:34:21,171 [32944] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 15:34:41,920 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2014-01-20 15:34:47,003 [30144] DEBUG Servicemms_send - 获取动态列表
2014-01-20 15:34:47,003 [30144] DEBUG Mms - select top 20 
        *
     from 
        test_user
     order by UserCode
2014-01-20 15:34:47,078 [30144] DEBUG Mms - select count(*) from ( select 
        *
     from 
        test_user
     ) tb_temp
2014-01-20 15:34:48,435 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/product/Index','/Mms/product')
2014-01-20 15:34:52,372 [8144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-20 15:34:52,388 [8144] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:34:52,389 [8144] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:34:52,425 [8144] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-20 15:34:52,425 [8144] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:34:53,776 [34640] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-20 15:34:54,102 [34640] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-20 15:34:54,617 [34640] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-20 15:35:09,095 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:35:09,128 [7620] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:35:09,128 [7620] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:35:09,160 [7620] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:35:09,160 [7620] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:35:09,409 [8144] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:35:09,410 [8144] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:35:23,032 [29756] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:35:23,032 [29756] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:35:23,038 [29756] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:35:23,044 [29756] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:35:23')
2014-01-20 15:35:23,045 [29756] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:35:23,045 [29756] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:35:23,071 [8144] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:35:23,196 [34140] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:35:27,656 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2014-01-20 15:35:39,634 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 15:35:41,058 [7620] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 15:35:41,058 [7620] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 15:35:42,069 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:35:42,084 [34332] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:35:42,084 [34332] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:35:42,085 [34332] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:35:42,086 [34332] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:35:42,279 [29756] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:35:42,280 [29756] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:35:45,677 [30144] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:35:45,678 [30144] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:35:45,720 [34140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:35:45,720 [34140] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:35:45,740 [30144] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-20 15:35:51,919 [7620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:35:51,922 [7620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:35:51,950 [30144] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:35:51,950 [30144] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:35:51,985 [7620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2014-01-20 15:36:17,341 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:36:18,721 [29876] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:36:18,722 [29876] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:36:18,759 [7620] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:36:18,760 [7620] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:36:18,801 [7620] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:37:17,482 [8144] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:37:17,483 [8144] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) order by UserSeq
2014-01-20 15:37:17,946 [8144] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) ) tb_temp
2014-01-20 15:37:37,283 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:37:37,294 [29876] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:37:37,294 [29876] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:37:37,296 [29876] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:37:37,296 [29876] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:37:37,545 [29756] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:37:37,545 [29756] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:38:45,748 [29756] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:38:45,749 [29756] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='undefined' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='undefined'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='undefined'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='undefined'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='undefined'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='undefined'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='undefined'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='undefined'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='undefined'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='undefined'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='undefined'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='undefined'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='undefined'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='undefined'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='undefined'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:38:45,772 [30144] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:38:45,772 [30144] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='undefined' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:38:45,851 [29756] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'undefined'
2014-01-20 15:39:00,456 [34332] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T2')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T2')
2014-01-20 15:39:10,605 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:39:10,607 [7620] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:39:10,607 [7620] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:39:10,609 [7620] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:39:10,609 [7620] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:39:11,179 [34332] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:39:11,179 [34332] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:39:17,002 [10908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:39:17,009 [10908] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:39:17,009 [10908] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:39:17,009 [10908] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:39:17,009 [10908] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:39:18,359 [29876] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:39:18,360 [29876] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:39:56,382 [29756] DEBUG Servicesys_role - 编辑记录
2014-01-20 15:39:56,392 [29756] DEBUG Servicesys_role - 获取动态对象
2014-01-20 15:39:56,393 [29756] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-20 15:39:56,401 [29756] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('临时工作人员','T1','92','临时确定的一个角色','超级管理员','星期一 15:39:56','超级管理员','星期一 15:39:56')
2014-01-20 15:39:56,457 [32944] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:39:56,457 [32944] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:39:58,389 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:39:58,393 [34700] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:39:58,393 [34700] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:39:58,393 [34700] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:39:58,393 [34700] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:39:58,865 [10908] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:39:58,865 [10908] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:40:01,868 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:40:02,242 [34700] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:40:02,243 [34700] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:40:02,264 [29472] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:40:02,264 [29472] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:40:02,265 [29472] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:41:06,133 [34332] DEBUG Servicesys_user - 编辑记录
2014-01-20 15:41:06,134 [34332] DEBUG Servicesys_user - 获取动态对象
2014-01-20 15:41:06,134 [34332] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'
2014-01-20 15:41:06,137 [34332] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('temp01','临时工','一个临时工作人员','false','超级管理员','星期一 15:41:06','超级管理员','星期一 15:41:06')
2014-01-20 15:41:06,142 [34332] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'temp01'
2014-01-20 15:41:20,156 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:41:20,493 [29136] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:41:20,493 [29136] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:41:20,527 [34640] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:41:20,528 [34640] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:41:20,530 [34640] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:41:25,220 [8144] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp01'
2014-01-20 15:41:39,752 [34332] DEBUG Servicesys_user - 设置用户角色
2014-01-20 15:41:39,754 [34332] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'temp01'
2014-01-20 15:41:39,757 [34332] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('temp01','T1')
2014-01-20 15:41:46,731 [32944] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp01'
2014-01-20 15:42:22,301 [7620] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:42:22,301 [7620] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:42:30,933 [29472] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:42:30,933 [29472] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:42:30,934 [29472] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:42:30,941 [29472] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:42:30')
2014-01-20 15:42:30,942 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:42:30,947 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:42:30,970 [10908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:42:31,196 [34332] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:42:35,597 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:42:36,021 [10548] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:42:36,021 [10548] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:42:36,048 [34700] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:42:36,048 [34700] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:42:36,051 [34700] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:42:47,692 [30144] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'temp01'
2014-01-20 15:42:56,141 [30144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:42:56,141 [30144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:43:02,651 [29876] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:43:02,652 [29876] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:43:02,653 [29876] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:43:02,659 [29876] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:43:02')
2014-01-20 15:43:02,661 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:43:02,661 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:43:02,686 [29136] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:43:02,872 [7620] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:43:12,247 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:43:12,642 [8144] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:43:12,642 [8144] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:43:12,679 [29876] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:43:12,679 [29876] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:43:12,681 [29876] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:43:29,291 [10908] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'temp01'
2014-01-20 15:43:41,715 [29136] DEBUG Servicesys_user - 编辑记录
2014-01-20 15:43:41,715 [29136] DEBUG Servicesys_user - 获取动态对象
2014-01-20 15:43:41,715 [29136] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'
2014-01-20 15:43:41,723 [29136] DEBUG Sys - update sys_user set [UserName] = '临时工', [Description] = '一个临时工作人员', [IsEnable] = 'true', [UpdatePerson] = '超级管理员', [UpdateDate] = '星期一 15:43:41' where  UserCode =  'temp01'
2014-01-20 15:43:44,129 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 15:43:44,541 [8144] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 15:43:44,541 [8144] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 15:43:44,615 [29472] DEBUG Servicesys_user - 获取实体列表
2014-01-20 15:43:44,615 [29472] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 15:43:44,618 [29472] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 15:44:12,827 [34700] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:44:12,828 [34700] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:44:12,832 [34700] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 15:44:12,837 [34700] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 15:44:12')
2014-01-20 15:44:12,839 [34700] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:44:12,839 [34700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:44:12,857 [29876] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 15:44:13,046 [7620] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:44:21,288 [34332] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:44:21,288 [34332] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:44:21,288 [34332] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:44:21,301 [34332] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','临时工','fwytech-PC','localhost','上海市','星期一 15:44:21')
2014-01-20 15:44:21,341 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:44:21,341 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:44:21,361 [34700] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:44:21,537 [29756] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:44:25,523 [30144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:44:25,528 [30144] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:44:25,528 [30144] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:44:25,534 [30144] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:44:25,534 [30144] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:44:25,853 [29756] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:44:25,853 [29756] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:44:30,471 [34640] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:44:30,472 [34640] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:44:30,544 [29472] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:44:30,544 [29472] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:44:30,606 [34640] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 15:44:33,825 [29472] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T1')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T1')
2014-01-20 15:44:36,686 [8144] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:44:36,687 [8144] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:44:36,732 [34700] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:44:36,733 [34700] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:44:36,734 [8144] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 15:45:08,011 [7620] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:45:08,013 [7620] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 15:45:08,014 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 15:45:08,015 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 15:45:08,016 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 15:45:08,016 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 15:45:08,016 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 15:45:08,017 [7620] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:45:08,017 [7620] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 15:45:08,018 [7620] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:45:08,018 [7620] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 15:45:08,018 [7620] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:45:08,018 [7620] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 15:45:22,796 [8144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:45:22,799 [8144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:45:22,801 [8144] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 15:45:22,808 [8144] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 15:45:22')
2014-01-20 15:45:22,809 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:45:22,809 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:45:22,830 [34700] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 15:45:23,018 [32944] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:45:29,068 [8144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/project/Index','/Mms/project')
2014-01-20 15:45:29,081 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:45:29,081 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:45:29,084 [8144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:45:29,104 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:29,106 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:45:29,117 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:29,118 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:45:29,134 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:29,135 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:45:29,136 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:29,137 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:45:29,159 [8144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:45:29,160 [8144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PartAttr'
2014-01-20 15:45:29,164 [8144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:45:29,164 [8144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'ImagePart'
2014-01-20 15:45:31,200 [34140] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:45:31,200 [34140] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:45:31,256 [34700] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:45:31,256 [34700] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:45:31,293 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:45:31,293 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:45:31,295 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:45:31,295 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:31,295 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:45:31,296 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:31,296 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:45:31,297 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:31,297 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:45:31,297 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:31,297 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:45:38,778 [29136] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:45:38,778 [29136] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:45:38,807 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:45:38,807 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:45:38,808 [29472] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:45:38,808 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:38,808 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:45:38,809 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:38,809 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:45:38,810 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:38,810 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:45:38,811 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:45:38,811 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:45:41,607 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/material/Index','/Mms/material')
2014-01-20 15:45:42,948 [10908] DEBUG Servicemms_materialType - 获取动态列表
2014-01-20 15:45:42,948 [10908] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2014-01-20 15:45:42,976 [8144] DEBUG Servicemms_material - 获取实体列表
2014-01-20 15:45:42,976 [8144] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2014-01-20 15:45:42,988 [8144] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2014-01-20 15:45:53,751 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 15:45:54,940 [29136] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 15:45:54,941 [29136] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 15:45:54,941 [34332] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:45:54,942 [34332] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 15:45:54,964 [34332] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 15:46:01,419 [29472] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:46:01,419 [29472] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '001' order by MerchantsCode
2014-01-20 15:46:01,424 [29472] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '001' ) tb_temp
2014-01-20 15:46:10,505 [32944] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:46:10,505 [32944] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '002' order by MerchantsCode
2014-01-20 15:46:10,510 [32944] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '002' ) tb_temp
2014-01-20 15:46:12,285 [29876] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:46:12,286 [29876] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' order by MerchantsCode
2014-01-20 15:46:12,290 [29876] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' ) tb_temp
2014-01-20 15:46:13,583 [34640] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:46:13,584 [34640] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '004' order by MerchantsCode
2014-01-20 15:46:13,586 [34640] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '004' ) tb_temp
2014-01-20 15:47:21,477 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/material/Index','/Mms/material')
2014-01-20 15:47:29,158 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/warehouse/Index','/Mms/warehouse')
2014-01-20 15:47:30,073 [8144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/material/Index','/Mms/material')
2014-01-20 15:47:30,647 [34700] DEBUG Servicemms_materialType - 获取动态列表
2014-01-20 15:47:30,647 [34700] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2014-01-20 15:47:30,723 [10548] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:47:30,723 [10548] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:47:31,165 [34640] DEBUG Servicemms_material - 获取实体列表
2014-01-20 15:47:31,165 [34640] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2014-01-20 15:47:31,167 [34640] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2014-01-20 15:47:31,194 [34640] DEBUG Servicemms_warehouse - 获取实体列表
2014-01-20 15:47:31,194 [34640] DEBUG Mms - select top 20 mms_warehouse.* from mms_warehouse order by WarehouseCode
2014-01-20 15:47:31,202 [34640] DEBUG Mms - select count(*) from ( select mms_warehouse.* from mms_warehouse ) tb_temp
2014-01-20 15:47:33,240 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 15:47:33,621 [10548] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 15:47:33,622 [10548] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 15:47:33,657 [34140] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:47:33,657 [34140] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 15:47:33,660 [34140] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 15:47:34,828 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/project/Index','/Mms/project')
2014-01-20 15:47:34,837 [34700] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:47:34,837 [34700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:47:34,839 [34700] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:47:34,839 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:34,839 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:34,839 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:34,840 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:34,841 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:34,841 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:34,841 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:34,842 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:34,842 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:47:34,842 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PartAttr'
2014-01-20 15:47:34,842 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:47:34,842 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'ImagePart'
2014-01-20 15:47:35,677 [8144] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:47:35,677 [8144] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:47:35,714 [34640] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:47:35,714 [34640] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:47:35,742 [29756] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:47:35,742 [29756] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:47:35,743 [29756] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:47:35,743 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:35,743 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:35,743 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:35,743 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:35,743 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:35,743 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:35,744 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:35,744 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:48,068 [8144] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:47:48,069 [8144] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:47:48,070 [8144] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030001'
2014-01-20 15:47:48,076 [8144] DEBUG Mms - update 
        mms_project
     set [ShortName] = 'dsds001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:47:48' where  ProjectCode =  '201306030001'
2014-01-20 15:47:48,137 [29876] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:47:48,141 [29876] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:47:48,167 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:47:48,167 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:47:48,169 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:47:48,169 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:48,169 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:48,169 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:48,169 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:48,170 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:48,170 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:48,170 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:48,170 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:50,308 [8144] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:47:50,309 [8144] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:47:50,337 [29136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:47:50,337 [29136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:47:50,338 [29136] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:47:50,338 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:50,338 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:47:50,338 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:50,338 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:47:50,338 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:50,338 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:47:50,339 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:50,339 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:47:51,526 [10908] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:47:51,527 [10908] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:47:51,534 [29756] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:47:51,534 [29756] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:47:51,550 [29756] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:47:51,550 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:51,550 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:51,551 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:51,551 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:47:51,551 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:51,551 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:47:51,551 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:47:51,551 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:48:09,624 [34640] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:48:09,624 [34640] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:48:09,626 [34640] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:48:09,637 [34640] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:48:09')
2014-01-20 15:48:09,638 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:48:09,638 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:48:09,661 [34700] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:48:09,906 [7620] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:48:29,503 [29136] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:48:29,506 [29136] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:48:29,506 [29136] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:48:29,512 [29136] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:48:29,512 [29136] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:48:29,831 [29472] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:48:29,832 [29472] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:48:35,497 [8144] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:48:35,498 [8144] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:48:35,535 [29136] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:48:35,535 [29136] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:48:35,616 [8144] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 15:51:09,789 [32944] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:51:09,791 [32944] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 15:51:09,792 [32944] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 15:51:09,793 [32944] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 15:51:09,793 [32944] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 15:51:09,793 [32944] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 15:51:09,793 [32944] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 15:51:09,799 [32944] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:51:09,800 [32944] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 15:51:09,800 [32944] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:51:09,800 [32944] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 15:51:09,800 [32944] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 15:51:09,804 [32944] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 15:51:09,807 [32944] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:51:09,807 [32944] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 15:51:21,286 [29472] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:51:21,286 [29472] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:51:21,295 [29472] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 15:51:21,300 [29472] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 15:51:21')
2014-01-20 15:51:21,301 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:21,304 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:21,327 [7620] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 15:51:21,497 [29136] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:51:26,360 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/project/Index','/Mms/project')
2014-01-20 15:51:26,370 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:26,370 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:26,371 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:26,371 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:26,371 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:26,371 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:26,371 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:26,372 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:26,372 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:26,372 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:26,372 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:26,372 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:51:26,372 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PartAttr'
2014-01-20 15:51:26,372 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:51:26,372 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'ImagePart'
2014-01-20 15:51:27,218 [10908] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:51:27,218 [10908] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:51:27,259 [29876] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:27,259 [29876] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:51:27,290 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:27,290 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:27,291 [8144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:27,291 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:27,291 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:27,291 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:27,291 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:27,291 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:27,291 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:27,292 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:27,292 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:35,566 [7620] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:51:35,566 [7620] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:51:35,568 [7620] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030001'
2014-01-20 15:51:35,569 [7620] DEBUG Mms - update 
        mms_project
     set [ShortName] = 'dsds002', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:51:35' where  ProjectCode =  '201306030001'
2014-01-20 15:51:35,597 [10908] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:51:35,600 [10908] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:51:35,637 [32944] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:35,637 [32944] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:35,638 [32944] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:35,638 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:35,638 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:35,638 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:35,638 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:35,639 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:35,639 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:35,639 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:35,639 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:37,295 [10548] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:37,295 [10548] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:51:37,313 [29756] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:37,313 [29756] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:51:37,314 [29756] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:37,314 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:37,314 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:37,314 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:37,314 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:37,315 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:37,315 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:37,315 [29756] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:37,315 [29756] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:45,938 [29876] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:51:45,938 [29876] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:51:45,951 [29876] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:51:45,954 [29876] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '60', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:51:45' where  ProjectCode =  '201306030001'
2014-01-20 15:51:45,996 [32944] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:51:45,996 [32944] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:51:46,026 [34700] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:46,026 [34700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:51:46,029 [34700] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:46,029 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:46,029 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:46,030 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:46,031 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:46,031 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:46,031 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:46,033 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:46,033 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:47,864 [10908] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:47,864 [10908] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:51:47,884 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:47,885 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:47,885 [34640] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:47,885 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:47,885 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:47,885 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:47,886 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:47,886 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:47,886 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:47,887 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:47,887 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:48,319 [32944] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:48,319 [32944] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:51:48,345 [32944] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:48,345 [32944] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:51:48,347 [32944] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:48,347 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:48,347 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:48,348 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:48,348 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:48,348 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:48,348 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:48,348 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:48,348 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:50,207 [29136] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:50,207 [29136] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:51:50,228 [29136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:50,228 [29136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:51:50,229 [29136] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:50,229 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:50,229 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:50,229 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:50,229 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:50,230 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:50,230 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:51:50,230 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:50,230 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:51:52,462 [7620] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:51:52,462 [7620] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:51:52,482 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:52,482 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:51:52,486 [34640] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:52,486 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:52,486 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:52,490 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:52,490 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:52,490 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:52,490 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:52,491 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:52,491 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:59,680 [34700] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:51:59,680 [34700] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:51:59,683 [34700] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:51:59,687 [34700] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '58', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:51:59' where  ProjectCode =  '201306030001'
2014-01-20 15:51:59,716 [30144] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:51:59,716 [30144] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:51:59,753 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:51:59,754 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:51:59,755 [29472] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:51:59,755 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:59,755 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:59,756 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:59,756 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:51:59,756 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:59,756 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:51:59,756 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:51:59,756 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:02,158 [29756] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:02,159 [29756] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:52:02,176 [29136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:02,176 [29136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:52:02,176 [29136] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:02,176 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:02,177 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:02,177 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:02,177 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:02,177 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:02,177 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:02,177 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:02,177 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:04,618 [34140] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:04,618 [34140] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:52:04,645 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:04,645 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:52:04,649 [8144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:04,649 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:04,649 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:04,649 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:04,649 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:04,649 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:04,649 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:04,649 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:04,649 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:07,066 [7620] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:07,066 [7620] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:52:07,073 [32944] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:07,073 [32944] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:52:07,091 [32944] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:07,091 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:07,091 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:07,096 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:07,096 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:07,096 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:07,096 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:07,096 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:07,097 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:35,221 [29876] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:52:35,221 [29876] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:52:35,226 [29876] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030001'
2014-01-20 15:52:35,227 [29876] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '61', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:52:35' where  ProjectCode =  '201306030001'
2014-01-20 15:52:35,288 [8144] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:52:35,288 [8144] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:52:35,314 [34700] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:35,315 [34700] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:52:35,316 [34700] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:35,316 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:35,317 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:35,317 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:35,317 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:35,317 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:35,317 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:35,318 [34700] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:35,318 [34700] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:36,566 [10548] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:36,567 [10548] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:52:36,585 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:36,585 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:52:36,585 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:36,586 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:36,586 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:36,587 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:36,587 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:36,587 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:36,587 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:36,587 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:36,587 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:38,059 [29136] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:38,060 [29136] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:52:38,066 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:38,066 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:52:38,094 [29876] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:38,094 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:38,094 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:38,096 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:38,096 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:38,097 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:38,097 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:38,097 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:38,097 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:39,486 [30144] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:39,487 [30144] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:52:39,487 [32944] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:39,487 [32944] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:52:39,500 [32944] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:39,500 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:39,500 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:39,503 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:39,503 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:39,503 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:39,503 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:39,504 [32944] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:39,504 [32944] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:46,547 [29756] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:52:46,548 [29756] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:52:46,551 [29756] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:52:46,551 [29756] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '80', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:52:46' where  ProjectCode =  '201306030001'
2014-01-20 15:52:46,583 [30144] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:52:46,583 [30144] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:52:46,619 [7620] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:46,619 [7620] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:52:46,620 [7620] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:46,621 [7620] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:46,621 [7620] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:46,624 [7620] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:46,625 [7620] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:46,626 [7620] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:46,626 [7620] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:46,626 [7620] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:46,626 [7620] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:48,076 [29136] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:48,076 [29136] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:52:48,103 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:48,103 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:52:48,103 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:48,103 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:48,103 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:48,103 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:48,103 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:48,104 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:48,104 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:52:48,104 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:48,104 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:52:55,046 [10548] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:52:55,046 [10548] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:52:55,060 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:52:55,060 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:52:55,061 [34640] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:52:55,061 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:55,061 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:55,061 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:55,061 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:52:55,062 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:55,062 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:52:55,062 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:52:55,062 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:00,446 [29136] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:53:00,446 [29136] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:53:00,446 [29136] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:53:00,448 [29136] DEBUG Mms - update 
        mms_project
     set [ProjectArea] = '厦门市湖里区华荣路111号', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:53:00' where  ProjectCode =  '201306030001'
2014-01-20 15:53:00,477 [34700] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:53:00,477 [34700] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:53:00,503 [30144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:00,503 [30144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:00,504 [30144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:00,504 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:00,504 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:00,505 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:00,505 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:00,506 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:00,507 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:00,507 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:00,507 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:02,413 [29472] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:02,413 [29472] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:53:02,430 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:02,430 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:53:02,431 [29876] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:02,431 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:02,431 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:02,431 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:02,431 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:02,431 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:02,431 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:02,432 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:02,432 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:15,732 [29472] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 15:53:15,733 [29472] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-20 15:53:15,741 [29472] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-20 15:53:28,823 [29876] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:28,823 [29876] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:53:28,853 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:28,854 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:28,893 [34640] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:28,893 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:28,893 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:28,927 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:28,928 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:28,939 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:28,939 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:28,953 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:28,953 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:33,165 [10908] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:53:33,165 [10908] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:53:33,166 [10908] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:53:33,167 [10908] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '80', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:53:33' where  ProjectCode =  '201306030002'
2014-01-20 15:53:33,199 [8144] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:53:33,200 [8144] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:53:33,226 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:33,226 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:33,226 [34640] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:33,227 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:33,227 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:33,227 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:33,227 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:33,227 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:33,228 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:33,228 [34640] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:33,228 [34640] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:35,762 [10548] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:35,762 [10548] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:53:35,781 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:35,781 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:53:35,782 [29472] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:35,782 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:35,782 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:35,783 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:35,783 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:35,783 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:35,783 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:35,783 [29472] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:35,783 [29472] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:37,201 [32944] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:37,201 [32944] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:53:37,223 [29136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:37,224 [29136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:37,224 [29136] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:37,224 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:37,224 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:37,224 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:37,224 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:37,225 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:37,225 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:37,225 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:37,225 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:41,283 [8144] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:53:41,284 [8144] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:53:41,284 [8144] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030002'
2014-01-20 15:53:41,285 [8144] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '81', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:53:41' where  ProjectCode =  '201306030002'
2014-01-20 15:53:41,313 [34140] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:53:41,313 [34140] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:53:41,357 [30144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:41,358 [30144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:41,360 [30144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:41,360 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:41,360 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:41,361 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:41,361 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:41,362 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:41,363 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:41,364 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:41,364 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:43,053 [7620] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:43,053 [7620] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:53:43,071 [29136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:43,071 [29136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:53:43,071 [29136] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:43,071 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:43,071 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:43,072 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:43,072 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:43,074 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:43,074 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:43,076 [29136] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:43,076 [29136] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:44,353 [10548] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:44,353 [10548] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:53:44,354 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:44,354 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:44,358 [8144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:44,358 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:44,358 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:44,359 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:44,359 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:44,360 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:44,360 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:44,366 [8144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:44,402 [8144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:45,890 [32944] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:45,890 [32944] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-20 15:53:45,950 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:45,950 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:53:45,991 [29876] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:45,991 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:45,991 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:46,045 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:46,045 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:46,045 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:46,045 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:46,046 [29876] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:46,046 [29876] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:51,111 [34140] DEBUG Servicemms_direct - 编辑记录
2014-01-20 15:53:51,112 [34140] DEBUG Servicemms_direct - 获取动态对象
2014-01-20 15:53:51,112 [34140] DEBUG Mms - select 
        mms_project
    .* from 
        mms_project
     where  ProjectCode =  '201306030001'
2014-01-20 15:53:51,113 [34140] DEBUG Mms - update 
        mms_project
     set [ActualDuration] = '70', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 15:53:51' where  ProjectCode =  '201306030002'
2014-01-20 15:53:51,143 [10908] DEBUG Servicemms_project - 获取动态列表
2014-01-20 15:53:51,144 [10908] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2014-01-20 15:53:51,173 [30144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:51,173 [30144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:53:51,174 [30144] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:51,174 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:51,174 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:51,175 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:51,175 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030001'and ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:51,176 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:51,176 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030001'and ProjectCode =  '201306030001' order by ProjectCode
2014-01-20 15:53:51,176 [30144] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:51,177 [30144] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030001' order by ProjectCode desc
2014-01-20 15:53:52,285 [29876] DEBUG Servicemms_buildPart - 获取实体列表
2014-01-20 15:53:52,285 [29876] DEBUG Mms - select mms_buildPart.* from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-20 15:53:52,302 [34332] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:53:52,303 [34332] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030002'
2014-01-20 15:53:52,304 [34332] DEBUG Servicemms_project - 获取上一条下一条数据
2014-01-20 15:53:52,304 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:52,304 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:52,304 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:52,304 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode < '201306030002'and ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:52,305 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:52,305 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode >  '201306030002'and ProjectCode =  '201306030002' order by ProjectCode
2014-01-20 15:53:52,305 [34332] DEBUG Servicemms_project - 获取字段
2014-01-20 15:53:52,305 [34332] DEBUG Mms - select top 1 ProjectCode from mms_project where  ProjectCode =  '201306030002' order by ProjectCode desc
2014-01-20 15:53:56,986 [8144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 15:53:57,387 [10908] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 15:53:57,387 [10908] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 15:53:57,405 [32944] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 15:53:57,405 [32944] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 15:53:57,407 [32944] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 15:55:08,356 [34140] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:55:08,356 [34140] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:55:08,357 [34140] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:55:08,369 [34140] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:55:08')
2014-01-20 15:55:08,370 [34140] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:55:08,370 [34140] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:55:08,404 [29136] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:55:08,629 [29136] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:55:13,282 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:55:13,300 [34332] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:55:13,300 [34332] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:55:13,308 [34332] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:55:13,308 [34332] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:55:13,670 [8144] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:55:13,671 [8144] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:55:18,619 [34140] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:55:18,620 [34140] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:55:18,665 [7620] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:55:18,665 [7620] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:55:18,698 [34140] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 15:55:48,394 [8144] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:55:48,395 [8144] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 15:55:48,396 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 15:55:48,397 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 15:55:48,397 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 15:55:48,398 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 15:55:48,413 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 15:55:48,420 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 15:55:48,421 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 15:55:48,421 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 15:55:48,422 [8144] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:55:48,424 [8144] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 15:55:48,424 [8144] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:55:48,424 [8144] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 15:55:48,425 [8144] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 15:55:48,425 [8144] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 15:55:48,425 [8144] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:55:48,426 [8144] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 15:55:57,601 [29472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 15:55:57,615 [29472] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:55:57,615 [29472] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:55:57,619 [29472] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:55:57,619 [29472] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:55:59,362 [8144] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:55:59,362 [8144] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 15:55:59,380 [8144] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 15:56:03,251 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/edit')
2014-01-20 15:56:03,267 [34640] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 15:56:03,268 [34640] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 15:56:03,273 [34640] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 15:56:03,274 [34640] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:56:03,275 [34640] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:56:03,279 [34640] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:56:03,279 [34640] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:56:03,281 [34640] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:56:03,281 [34640] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:56:03,285 [34640] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:56:03,285 [34640] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:56:03,317 [34640] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:03,317 [34640] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 15:56:03,318 [34640] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:03,318 [34640] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:56:03,319 [34640] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:03,319 [34640] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 15:56:03,319 [34640] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:56:03,319 [34640] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:56:03,320 [34640] DEBUG Servicesys_code - 获取字段
2014-01-20 15:56:03,321 [34640] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:56:03,322 [34640] DEBUG Servicesys_code - 获取字段
2014-01-20 15:56:03,322 [34640] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:56:04,566 [8144] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 15:56:04,567 [8144] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 15:56:05,177 [34332] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:56:05,177 [34332] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 15:56:21,770 [10548] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:56:21,774 [10548] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:56:21,775 [10548] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 15:56:21,780 [10548] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 15:56:21')
2014-01-20 15:56:21,781 [10548] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:56:21,781 [10548] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:56:21,806 [7620] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 15:56:22,090 [29472] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:56:26,646 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 15:56:26,654 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:56:26,654 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:56:26,657 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:26,658 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:56:27,202 [8144] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:56:27,203 [8144] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 15:56:27,204 [8144] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 15:56:28,953 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 15:56:37,443 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 15:56:37,453 [29756] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:56:37,453 [29756] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:56:37,453 [29756] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:37,454 [29756] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 15:56:37,454 [29756] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:37,454 [29756] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 15:56:37,623 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 15:56:37,624 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:56:37,625 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:56:37,625 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:37,625 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 15:56:37,625 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:56:37,626 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 15:56:38,529 [29756] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 15:56:38,529 [34332] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 15:56:38,532 [29756] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'temp01'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'temp01'
)
2014-01-20 15:56:38,532 [34332] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'temp01'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'temp01'
)
2014-01-20 15:56:38,552 [29756] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 15:56:38,552 [29756] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'temp01'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'temp01'
)
order by ButtonSeq
2014-01-20 15:56:38,553 [34332] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 15:56:38,554 [34332] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'temp01'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'temp01'
)
order by ButtonSeq
2014-01-20 15:56:38,995 [34332] DEBUG Servicemms_send - 获取动态列表
2014-01-20 15:56:38,995 [34332] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 15:56:39,008 [34332] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 15:56:41,219 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/send/edit')
2014-01-20 15:57:35,460 [29876] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:57:35,460 [29876] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:57:35,461 [29876] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 15:57:35,471 [29876] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 15:57:35')
2014-01-20 15:57:35,472 [29876] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:57:35,472 [29876] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:57:35,492 [10548] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 15:57:35,700 [34640] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:57:45,972 [29136] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 15:57:45,981 [29136] DEBUG Servicesys_user - 获取动态列表
2014-01-20 15:57:45,982 [29136] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 15:57:45,985 [29136] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 15:57:45,986 [29136] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 15:57:46,289 [10908] DEBUG Servicesys_role - 获取实体列表
2014-01-20 15:57:46,290 [10908] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 15:57:52,272 [7620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 15:57:52,273 [7620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 15:57:52,309 [34640] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 15:57:52,309 [34640] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 15:57:52,330 [7620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 15:58:42,431 [7620] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 15:58:42,433 [7620] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 15:58:42,435 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 15:58:42,443 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 15:58:42,445 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 15:58:42,447 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100101')
2014-01-20 15:58:42,450 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100201')
2014-01-20 15:58:42,450 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 15:58:42,450 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 15:58:42,450 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 15:58:42,451 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 15:58:42,451 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 15:58:42,451 [7620] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 15:58:42,452 [7620] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 15:58:42,452 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','browse')
2014-01-20 15:58:42,453 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','edit')
2014-01-20 15:58:42,458 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','delete')
2014-01-20 15:58:42,458 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','search')
2014-01-20 15:58:42,458 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','refresh')
2014-01-20 15:58:42,460 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','export')
2014-01-20 15:58:42,461 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','download')
2014-01-20 15:58:42,462 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','print')
2014-01-20 15:58:42,464 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','accredit')
2014-01-20 15:58:42,464 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','audit')
2014-01-20 15:58:42,465 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','inport')
2014-01-20 15:58:42,465 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','copy')
2014-01-20 15:58:42,465 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','save')
2014-01-20 15:58:42,465 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','add')
2014-01-20 15:58:42,467 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','edit')
2014-01-20 15:58:42,468 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','delete')
2014-01-20 15:58:42,468 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','search')
2014-01-20 15:58:42,468 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','refresh')
2014-01-20 15:58:42,468 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','download')
2014-01-20 15:58:42,468 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','audit')
2014-01-20 15:58:42,469 [7620] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 15:58:42,469 [7620] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 15:58:42,470 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 15:58:42,470 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 15:58:42,474 [7620] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 15:58:42,474 [7620] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 15:58:55,560 [8144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:58:55,560 [8144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:59:16,686 [30144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:59:16,686 [30144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:59:18,069 [10548] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:59:18,069 [10548] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp001'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:59:24,492 [34640] DEBUG Servicesys_user - 获取实体对象
2014-01-20 15:59:24,492 [34640] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 15:59:24,493 [34640] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 15:59:24,497 [34640] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 15:59:24')
2014-01-20 15:59:24,497 [34640] DEBUG Servicemms_project - 获取实体对象
2014-01-20 15:59:24,497 [34640] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 15:59:24,516 [7620] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 15:59:24,740 [34140] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 15:59:27,139 [30144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 15:59:27,152 [30144] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:59:27,152 [30144] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:59:27,153 [30144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:27,153 [30144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:59:27,775 [34700] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:59:27,776 [34700] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 15:59:27,780 [34700] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 15:59:29,229 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 15:59:29,231 [32944] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 15:59:29,232 [32944] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 15:59:29,232 [32944] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 15:59:29,233 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:29,233 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:29,233 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:29,233 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:29,233 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:29,233 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:29,234 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:29,234 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:29,234 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:29,234 [32944] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 15:59:29,234 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:29,235 [32944] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:59:29,235 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:29,235 [32944] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 15:59:29,235 [32944] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:59:29,235 [32944] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:59:29,235 [32944] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:29,236 [32944] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:29,236 [32944] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:29,236 [32944] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:30,096 [29136] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 15:59:30,097 [29136] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 15:59:30,357 [34700] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:59:30,357 [34700] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 15:59:38,782 [8144] DEBUG Servicemms_receive - 获取新主键
2014-01-20 15:59:38,784 [8144] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 15:59:38,873 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 15:59:38,877 [29876] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 15:59:38,877 [29876] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210006'
2014-01-20 15:59:38,877 [29876] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 15:59:38,878 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:38,878 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:38,878 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:38,878 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210006'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:38,879 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:38,880 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210006'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:38,881 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:38,882 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:38,888 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:38,888 [29876] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 15:59:38,889 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:38,889 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:59:38,889 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:38,889 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 15:59:38,889 [29876] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:59:38,890 [29876] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:59:38,891 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:38,891 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:38,891 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:38,891 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:40,007 [10548] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:59:40,007 [10548] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210006' order by A.MaterialCode
2014-01-20 15:59:43,494 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 15:59:43,495 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:59:43,495 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:59:43,496 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:43,496 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:59:44,001 [34640] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:59:44,001 [34640] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 15:59:44,003 [34640] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 15:59:55,356 [34140] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 15:59:55,359 [34140] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 15:59:55,360 [34140] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 15:59:55,360 [34140] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 15:59:55,360 [34140] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:55,360 [34140] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:55,362 [34140] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:55,363 [34140] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:55,363 [34140] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:55,363 [34140] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 15:59:55,364 [34140] DEBUG Servicemms_receive - 获取字段
2014-01-20 15:59:55,364 [34140] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 15:59:55,364 [34140] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:55,364 [34140] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 15:59:55,365 [34140] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:55,365 [34140] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 15:59:55,366 [34140] DEBUG Servicesys_code - 获取动态列表
2014-01-20 15:59:55,366 [34140] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 15:59:55,367 [34140] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 15:59:55,367 [34140] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 15:59:55,367 [34140] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:55,368 [34140] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:55,368 [34140] DEBUG Servicesys_code - 获取字段
2014-01-20 15:59:55,368 [34140] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 15:59:56,161 [29136] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 15:59:56,161 [29136] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 15:59:56,461 [34140] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 15:59:56,461 [34140] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:00:37,339 [30144] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:00:37,341 [30144] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:00:37,342 [30144] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:00:37,344 [30144] DEBUG Mms - update mms_receive set [Remark] = '备注', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:00:37' where  BillNo =  '201306270001'
2014-01-20 16:00:52,554 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:00:52,563 [34332] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:00:52,581 [34332] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020014'
2014-01-20 16:00:52,582 [34332] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:00:52,582 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:52,582 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:00:52,593 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:52,593 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020014'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:00:52,595 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:52,595 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020014'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:00:52,598 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:52,598 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:00:52,599 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:52,599 [34332] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:00:52,600 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:52,600 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:00:52,600 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:52,601 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:00:52,602 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:00:52,602 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:00:52,602 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:00:52,602 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:00:52,603 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:00:52,603 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:00:53,441 [29756] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:00:53,442 [29756] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('GY100003') order by MerchantsCode
2014-01-20 16:00:53,801 [10908] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:00:53,802 [10908] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020014' order by A.MaterialCode
2014-01-20 16:00:56,084 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:00:56,102 [34332] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:00:56,102 [34332] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:00:56,128 [34332] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:00:56,128 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:56,128 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:00:56,128 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:56,128 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:00:56,129 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:56,129 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:00:56,129 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:00:56,129 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:00:56,129 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:56,129 [34332] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:00:56,130 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:56,130 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:00:56,131 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:00:56,131 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:00:56,132 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:00:56,132 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:00:56,135 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:00:56,135 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:00:56,135 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:00:56,135 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:00:56,813 [34700] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:00:56,813 [34700] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:00:57,189 [29756] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:00:57,189 [29756] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:01:09,102 [34140] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:01:09,103 [34140] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:01:09,104 [34140] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:01:09,113 [34140] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:01:09')
2014-01-20 16:01:09,114 [34140] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:01:09,114 [34140] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:01:09,133 [10548] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:01:09,373 [34700] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:01:13,937 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:01:13,940 [7620] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:01:13,940 [7620] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:01:13,941 [7620] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:01:13,941 [7620] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:01:14,258 [29876] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:01:14,258 [29876] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:01:17,645 [29756] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:01:17,646 [29756] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:01:17,710 [29756] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:01:17,731 [34140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:01:17,731 [34140] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:02:17,355 [7620] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 16:02:17,356 [7620] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 16:02:17,358 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 16:02:17,360 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 16:02:17,368 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 16:02:17,369 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100101')
2014-01-20 16:02:17,370 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100201')
2014-01-20 16:02:17,371 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 16:02:17,372 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 16:02:17,372 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 16:02:17,372 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 16:02:17,372 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 16:02:17,374 [7620] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 16:02:17,374 [7620] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 16:02:17,375 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','edit')
2014-01-20 16:02:17,376 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','add')
2014-01-20 16:02:17,377 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','edit')
2014-01-20 16:02:17,377 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','delete')
2014-01-20 16:02:17,377 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','search')
2014-01-20 16:02:17,377 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','refresh')
2014-01-20 16:02:17,378 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','download')
2014-01-20 16:02:17,378 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','audit')
2014-01-20 16:02:17,379 [7620] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 16:02:17,379 [7620] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 16:02:17,379 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 16:02:17,380 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 16:02:17,380 [7620] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 16:02:17,380 [7620] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 16:02:25,660 [8144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:02:25,660 [8144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:02:25,662 [8144] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 16:02:25,667 [8144] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 16:02:25')
2014-01-20 16:02:25,693 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:02:25,693 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:02:25,715 [10908] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 16:02:25,886 [29876] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:02:27,339 [30144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 16:02:27,347 [30144] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:02:27,347 [30144] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:02:27,350 [30144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:27,350 [30144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:02:27,517 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 16:02:27,519 [32944] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:02:27,519 [32944] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:02:27,520 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:27,520 [32944] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:02:28,041 [29876] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:02:28,041 [29876] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 16:02:28,050 [29876] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 16:02:31,478 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:02:31,484 [34700] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:02:31,484 [34700] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:02:31,485 [34700] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:02:31,485 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:31,485 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:31,485 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:31,485 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:31,486 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:31,486 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:31,486 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:31,486 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:31,486 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:31,486 [34700] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:02:31,487 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:31,487 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:02:31,487 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:31,487 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:02:31,489 [34700] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:02:31,490 [34700] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:02:31,493 [34700] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:31,493 [34700] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:02:31,494 [34700] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:31,494 [34700] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:02:32,175 [30144] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:02:32,175 [30144] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:02:32,472 [34332] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:02:32,472 [34332] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:02:38,498 [34140] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:02:38,498 [34140] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:02:38,499 [34140] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:02:38,499 [34140] DEBUG Mms - update mms_receive set [Remark] = '备注01', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:02:38' where  BillNo =  '201306270001'
2014-01-20 16:02:51,610 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:02:51,659 [34700] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:02:51,660 [34700] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020002'
2014-01-20 16:02:51,668 [34700] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:02:51,668 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:51,668 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:51,669 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:51,669 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020002'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:51,670 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:51,671 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020002'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:51,673 [34700] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:51,673 [34700] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:51,673 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:51,674 [34700] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:02:51,674 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:51,674 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:02:51,681 [34700] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:51,681 [34700] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:02:51,685 [34700] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:02:51,686 [34700] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:02:51,687 [34700] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:51,687 [34700] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:02:51,706 [34700] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:51,706 [34700] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:02:52,308 [34140] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:02:52,308 [34140] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2014-01-20 16:02:52,638 [7620] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:02:52,638 [7620] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020002' order by A.MaterialCode
2014-01-20 16:02:59,333 [29472] DEBUG Servicemms_receive - 获取新主键
2014-01-20 16:02:59,333 [29472] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 16:02:59,430 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:02:59,439 [29876] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:02:59,439 [29876] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210007'
2014-01-20 16:02:59,440 [29876] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:02:59,440 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:59,440 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:59,440 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:59,440 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210007'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:59,442 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:59,442 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210007'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:02:59,445 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:02:59,445 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:02:59,446 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:59,446 [29876] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:02:59,447 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:59,447 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:02:59,448 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:02:59,448 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:02:59,448 [29876] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:02:59,448 [29876] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:02:59,448 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:59,448 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:02:59,449 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 16:02:59,449 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:03:00,433 [34640] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:03:00,433 [34640] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210007' order by A.MaterialCode
2014-01-20 16:03:17,893 [7620] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:03:17,893 [7620] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:03:17,895 [7620] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:03:17,899 [7620] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:03:17')
2014-01-20 16:03:17,900 [7620] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:03:17,900 [7620] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:03:17,935 [10908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:03:18,104 [29472] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:03:21,782 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:03:21,787 [32944] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:03:21,787 [32944] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:03:21,788 [32944] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:03:21,788 [32944] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:04:00,257 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 16:04:06,990 [10908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:04:07,000 [10908] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:04:07,000 [10908] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:04:07,002 [10908] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:04:07,002 [10908] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:04:07,280 [29472] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:04:07,281 [29472] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:04:17,252 [29756] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:04:17,254 [29756] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:04:17,300 [29876] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:04:17,300 [29876] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:04:17,317 [29756] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:04:23,269 [10548] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:04:23,272 [10548] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:04:23,332 [10548] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:04:23,384 [30144] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:04:23,384 [30144] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:04:45,274 [8144] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 16:04:45,282 [8144] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 16:04:45,286 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 16:04:45,286 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 16:04:45,286 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 16:04:45,287 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100101')
2014-01-20 16:04:45,287 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100201')
2014-01-20 16:04:45,287 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 16:04:45,287 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 16:04:45,288 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 16:04:45,288 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 16:04:45,288 [8144] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 16:04:45,290 [8144] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 16:04:45,290 [8144] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 16:04:45,291 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','browse')
2014-01-20 16:04:45,291 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','search')
2014-01-20 16:04:45,291 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','refresh')
2014-01-20 16:04:45,291 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','export')
2014-01-20 16:04:45,292 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','download')
2014-01-20 16:04:45,292 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','print')
2014-01-20 16:04:45,292 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','accredit')
2014-01-20 16:04:45,293 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','audit')
2014-01-20 16:04:45,297 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','inport')
2014-01-20 16:04:45,297 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','copy')
2014-01-20 16:04:45,298 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','save')
2014-01-20 16:04:45,298 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','add')
2014-01-20 16:04:45,298 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','edit')
2014-01-20 16:04:45,301 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','delete')
2014-01-20 16:04:45,301 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','search')
2014-01-20 16:04:45,301 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','refresh')
2014-01-20 16:04:45,301 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','download')
2014-01-20 16:04:45,302 [8144] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','audit')
2014-01-20 16:04:45,302 [8144] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 16:04:45,302 [8144] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 16:04:45,302 [8144] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 16:04:45,303 [8144] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 16:04:45,303 [8144] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 16:04:45,303 [8144] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 16:04:54,250 [32944] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:04:54,250 [32944] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:04:54,252 [32944] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:04:54,257 [32944] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:04:54')
2014-01-20 16:04:54,258 [32944] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:04:54,258 [32944] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:04:54,277 [10908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:04:54,443 [10548] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:05:06,703 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:05:06,705 [29876] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:05:06,705 [29876] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:05:06,705 [29876] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:05:06,705 [29876] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:05:06,949 [34700] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:05:06,949 [34700] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:05:19,443 [8144] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:05:19,444 [8144] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:05:19,448 [8144] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 16:05:19,451 [8144] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 16:05:19')
2014-01-20 16:05:19,452 [8144] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:05:19,453 [8144] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:05:19,475 [32944] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 16:05:19,651 [34700] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:05:21,252 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 16:05:21,254 [34640] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:05:21,255 [34640] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:05:21,255 [34640] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:21,256 [34640] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:05:21,755 [34640] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:05:21,756 [34640] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 16:05:21,759 [34640] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 16:05:34,856 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:05:34,857 [34332] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:05:34,857 [34332] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:05:34,858 [34332] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:05:34,858 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:34,858 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:34,859 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:34,859 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:34,860 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:34,860 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:34,860 [34332] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:34,860 [34332] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:34,860 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:34,860 [34332] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:05:34,861 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:34,861 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:05:34,861 [34332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:34,861 [34332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:05:34,861 [34332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:05:34,861 [34332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:05:34,861 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:34,862 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:34,862 [34332] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:34,862 [34332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:35,522 [29756] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:05:35,522 [29756] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:05:35,774 [10908] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:05:35,774 [10908] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:05:41,112 [34332] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:05:41,112 [34332] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:05:41,112 [34332] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:05:41,113 [34332] DEBUG Mms - update mms_receive set [Remark] = '备注02', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:05:41' where  BillNo =  '201306270001'
2014-01-20 16:05:44,313 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:05:44,315 [32944] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:05:44,315 [32944] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020014'
2014-01-20 16:05:44,316 [32944] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:05:44,316 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:44,316 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:44,316 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:44,316 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020014'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:44,316 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:44,317 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020014'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:44,317 [32944] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:44,317 [32944] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:44,317 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:44,317 [32944] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:05:44,318 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:44,318 [32944] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:05:44,318 [32944] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:44,318 [32944] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:05:44,319 [32944] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:05:44,319 [32944] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:05:44,319 [32944] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:44,319 [32944] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:44,320 [32944] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:44,320 [32944] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:45,128 [34140] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:05:45,128 [34140] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('GY100003') order by MerchantsCode
2014-01-20 16:05:45,396 [29756] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:05:45,396 [29756] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020014' order by A.MaterialCode
2014-01-20 16:05:48,546 [30144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:05:48,567 [30144] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:05:48,568 [30144] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:05:48,568 [30144] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:05:48,569 [30144] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:48,569 [30144] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:48,571 [30144] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:48,572 [30144] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:48,572 [30144] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:48,573 [30144] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:48,576 [30144] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:48,576 [30144] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:48,581 [30144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:48,581 [30144] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:05:48,582 [30144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:48,583 [30144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:05:48,583 [30144] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:48,583 [30144] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:05:48,583 [30144] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:05:48,583 [30144] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:05:48,584 [30144] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:48,584 [30144] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:48,585 [30144] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:48,585 [30144] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:49,339 [10908] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:05:49,339 [10908] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:05:49,611 [34332] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:05:49,612 [34332] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:05:55,376 [7620] DEBUG Servicemms_receive - 获取新主键
2014-01-20 16:05:55,377 [7620] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 16:05:55,454 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:05:55,456 [29876] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:05:55,456 [29876] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210008'
2014-01-20 16:05:55,458 [29876] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:05:55,458 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:55,458 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:55,459 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:55,459 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210008'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:55,461 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:55,461 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210008'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:05:55,462 [29876] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:05:55,463 [29876] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:05:55,463 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:55,464 [29876] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:05:55,464 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:55,465 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:05:55,470 [29876] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:05:55,470 [29876] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:05:55,471 [29876] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:05:55,471 [29876] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:05:55,471 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:55,472 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:55,472 [29876] DEBUG Servicesys_code - 获取字段
2014-01-20 16:05:55,472 [29876] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:05:56,494 [34140] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:05:56,495 [34140] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210008' order by A.MaterialCode
2014-01-20 16:05:58,171 [29136] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:05:58,171 [29136] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2014-01-20 16:05:58,176 [29136] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2014-01-20 16:06:00,343 [34140] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:06:00,343 [34140] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:06:08,151 [34640] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:06:08,151 [34640] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2014-01-20 16:06:08,154 [34640] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2014-01-20 16:06:14,888 [29472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:06:14,906 [29472] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:06:14,906 [29472] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201306270001'
2014-01-20 16:06:14,920 [29472] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:06:14,920 [29472] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:14,920 [29472] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:06:14,921 [29472] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:14,921 [29472] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201306270001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:06:14,922 [29472] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:14,922 [29472] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201306270001'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:06:14,922 [29472] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:14,922 [29472] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:06:14,923 [29472] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:14,923 [29472] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:06:14,925 [29472] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:14,925 [29472] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:06:14,925 [29472] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:14,925 [29472] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:06:14,925 [29472] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:06:14,926 [29472] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:06:14,927 [29472] DEBUG Servicesys_code - 获取字段
2014-01-20 16:06:14,927 [29472] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:06:14,928 [29472] DEBUG Servicesys_code - 获取字段
2014-01-20 16:06:14,928 [29472] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:06:15,673 [29472] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:06:15,673 [29472] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:06:15,946 [30144] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:06:15,946 [30144] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306270001' order by A.MaterialCode
2014-01-20 16:06:28,748 [29876] DEBUG Servicemms_receive - 获取新主键
2014-01-20 16:06:28,748 [29876] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2014-01-20 16:06:28,788 [29136] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/edit')
2014-01-20 16:06:28,790 [29136] DEBUG Servicemms_receive - 获取实体对象
2014-01-20 16:06:28,790 [29136] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210009'
2014-01-20 16:06:28,791 [29136] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-01-20 16:06:28,791 [29136] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:28,791 [29136] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:06:28,792 [29136] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:28,792 [29136] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201401210009'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:06:28,793 [29136] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:28,793 [29136] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201401210009'and ProjectCode =  '201306030001' order by BillNo
2014-01-20 16:06:28,795 [29136] DEBUG Servicemms_receive - 获取字段
2014-01-20 16:06:28,795 [29136] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-20 16:06:28,798 [29136] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:28,798 [29136] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-20 16:06:28,800 [29136] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:28,800 [29136] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:06:28,801 [29136] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:06:28,801 [29136] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-20 16:06:28,802 [29136] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:06:28,802 [29136] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:06:28,803 [29136] DEBUG Servicesys_code - 获取字段
2014-01-20 16:06:28,803 [29136] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:06:28,803 [29136] DEBUG Servicesys_code - 获取字段
2014-01-20 16:06:28,803 [29136] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-20 16:06:29,747 [10548] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:06:29,748 [10548] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201401210009' order by A.MaterialCode
2014-01-20 16:06:33,295 [34700] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:06:33,295 [34700] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2014-01-20 16:06:33,303 [34700] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2014-01-20 16:06:34,975 [34332] DEBUG ServiceModelBase - 获取动态列表
2014-01-20 16:06:34,975 [34332] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('DL0012') order by MerchantsCode
2014-01-20 16:07:12,197 [29756] DEBUG Servicemms_materialType - 获取动态列表
2014-01-20 16:07:12,197 [29756] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2014-01-20 16:07:12,276 [29876] DEBUG Servicemms_material - 获取动态列表
2014-01-20 16:07:12,276 [29876] DEBUG Mms - select top 10 A.* from 
    mms_material A
   order by A.MaterialCode
2014-01-20 16:07:12,284 [29876] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   ) tb_temp
2014-01-20 16:07:17,865 [34332] DEBUG Servicemms_receiveDetail - 获取新主键
2014-01-20 16:07:17,866 [34332] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1  and  BillNo =  '201401210009'
2014-01-20 16:07:31,181 [29876] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:07:31,182 [29876] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:07:31,182 [29876] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210009'
2014-01-20 16:07:31,184 [29876] DEBUG Mms - update mms_receive set [BillDate] = '星期一 16:06:28', [DoPerson] = '临时工', [SupplierCode] = 'DL0012', [ContractCode] = '0001', [ReceiveDate] = '星期一 16:06:28', [TotalMoney] = '50', [PayKind] = '085', [OriginalNum] = '0021344', [Remark] = 'test', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:07:31' where  BillNo =  '201401210009'
2014-01-20 16:07:31,232 [29876] DEBUG Mms - insert into mms_receive([BillNo],[BillDate],[DoPerson],[SupplierCode],[ContractCode],[ReceiveDate],[TotalMoney],[PayKind],[OriginalNum],[Remark],[ProjectCode],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201401210009','星期一 16:06:28','临时工','DL0012','0001','星期一 16:06:28','50','085','0021344','test','201306030001','临时工','星期一 16:07:31','临时工','星期一 16:07:31')
2014-01-20 16:07:31,491 [29876] ERROR Servicemms_receive - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 89
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:d0d27c06-8734-47f2-957a-8c80299815d1
2014-01-20 16:07:31,673 [29876] ERROR /api/mms/receive/edit/ - System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , mms_receiveService , RequestWrapper , RequestWrapper , Object )
   在 Zephyr.Areas.Mms.Controllers.MmsBaseApi`4.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Mms\Common\MmsBaseApi.cs:行号 160
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:d0d27c06-8734-47f2-957a-8c80299815d1
2014-01-20 16:07:58,029 [29876] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:07:58,029 [29876] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:07:58,030 [29876] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210009'
2014-01-20 16:07:58,042 [29876] DEBUG Mms - update mms_receive set [BillDate] = '星期一 16:06:28', [DoPerson] = '临时工', [SupplierCode] = 'DL0012', [ContractCode] = '0001', [ReceiveDate] = '星期一 16:06:28', [TotalMoney] = '50', [PayKind] = '085', [OriginalNum] = '', [Remark] = 'test', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:07:58' where  BillNo =  '201401210009'
2014-01-20 16:07:58,048 [29876] DEBUG Mms - insert into mms_receive([BillNo],[BillDate],[DoPerson],[SupplierCode],[ContractCode],[ReceiveDate],[TotalMoney],[PayKind],[OriginalNum],[Remark],[ProjectCode],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201401210009','星期一 16:06:28','临时工','DL0012','0001','星期一 16:06:28','50','085','','test','201306030001','临时工','星期一 16:07:58','临时工','星期一 16:07:58')
2014-01-20 16:07:58,050 [29876] ERROR Servicemms_receive - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 89
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:d0d27c06-8734-47f2-957a-8c80299815d1
2014-01-20 16:07:58,062 [29876] ERROR /api/mms/receive/edit/ - System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , mms_receiveService , RequestWrapper , RequestWrapper , Object )
   在 Zephyr.Areas.Mms.Controllers.MmsBaseApi`4.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Mms\Common\MmsBaseApi.cs:行号 160
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:d0d27c06-8734-47f2-957a-8c80299815d1
2014-01-20 16:08:47,070 [7620] DEBUG Servicemms_receive - 编辑记录
2014-01-20 16:08:47,070 [7620] DEBUG Servicemms_receive - 获取动态对象
2014-01-20 16:08:47,071 [7620] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201401210009'
2014-01-20 16:08:47,071 [7620] DEBUG Mms - update mms_receive set [BillDate] = '星期一 16:06:28', [DoPerson] = '临时工', [SupplierCode] = 'DL0012', [ContractCode] = '0001', [ReceiveDate] = '2014-01-21', [TotalMoney] = '50', [PayKind] = '085', [OriginalNum] = '', [Remark] = 'test', [ProjectCode] = '201306030001', [UpdatePerson] = '临时工', [UpdateDate] = '星期一 16:08:47' where  BillNo =  '201401210009'
2014-01-20 16:08:47,077 [7620] DEBUG Mms - insert into mms_receive([BillNo],[BillDate],[DoPerson],[SupplierCode],[ContractCode],[ReceiveDate],[TotalMoney],[PayKind],[OriginalNum],[Remark],[ProjectCode],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201401210009','星期一 16:06:28','临时工','DL0012','0001','2014-01-21','50','085','','test','201306030001','临时工','星期一 16:08:47','临时工','星期一 16:08:47')
2014-01-20 16:08:47,079 [7620] ERROR Servicemms_receive - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 89
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:f7a071c8-d2cd-4f48-9352-190f52e9bb3d
2014-01-20 16:08:47,097 [7620] ERROR /api/mms/receive/edit/ - System.Data.SqlClient.SqlException (0x80131904): 从字符串转换日期和/或时间时，转换失败。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , mms_receiveService , RequestWrapper , RequestWrapper , Object )
   在 Zephyr.Areas.Mms.Controllers.MmsBaseApi`4.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Mms\Common\MmsBaseApi.cs:行号 160
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:f7a071c8-d2cd-4f48-9352-190f52e9bb3d
2014-01-20 16:09:20,663 [8144] DEBUG Servicemms_receive - 删除记录
2014-01-20 16:09:20,666 [8144] DEBUG Mms - delete from mms_receiveDetail where [BillNo] = '201401210005'
2014-01-20 16:09:20,669 [8144] DEBUG Mms - delete from mms_receive where  BillNo =  '201401210005'
2014-01-20 16:09:20,824 [34700] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:09:20,824 [34700] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 16:09:20,826 [34700] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 16:09:22,967 [29472] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-20 16:09:22,974 [29472] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 16:09:22,974 [29472] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 16:09:22,975 [29472] DEBUG Servicesys_code - 获取动态列表
2014-01-20 16:09:22,975 [29472] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-20 16:09:23,625 [29876] DEBUG Servicemms_receive - 获取动态列表
2014-01-20 16:09:23,625 [29876] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 16:09:23,627 [29876] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 16:10:33,970 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 16:10:52,875 [34140] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:10:52,875 [34140] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:10:52,876 [34140] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:10:52,886 [34140] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:10:52')
2014-01-20 16:10:52,886 [34140] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:10:52,887 [34140] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:10:52,924 [10908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:10:53,185 [29136] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:11:07,582 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 16:11:07,933 [8144] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 16:11:07,933 [8144] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 16:11:07,963 [34332] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 16:11:07,963 [34332] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 16:11:07,964 [34332] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 16:15:14,692 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 16:15:15,264 [8144] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 16:15:15,264 [8144] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 16:15:15,296 [34700] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 16:15:15,297 [34700] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 16:15:15,301 [34700] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 16:16:39,958 [30144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:16:40,044 [30144] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:16:40,044 [30144] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:16:40,065 [30144] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:16:40,065 [30144] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:16:45,858 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:16:45,869 [29876] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:16:45,869 [29876] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:16:45,883 [29876] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:16:45,883 [29876] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:16:46,290 [29876] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:16:46,290 [29876] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:16:49,347 [34140] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:16:49,368 [34140] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:16:49,387 [29472] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:16:49,505 [29472] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:16:49,587 [34140] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:17:48,127 [34700] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 16:17:48,130 [34700] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 16:17:48,242 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 16:17:48,245 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 16:17:48,247 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 16:17:48,247 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100101')
2014-01-20 16:17:48,249 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100201')
2014-01-20 16:17:48,250 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 16:17:48,250 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 16:17:48,250 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 16:17:48,251 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 16:17:48,251 [34700] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 16:17:48,251 [34700] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 16:17:48,252 [34700] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 16:17:48,254 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','browse')
2014-01-20 16:17:48,256 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','search')
2014-01-20 16:17:48,257 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','refresh')
2014-01-20 16:17:48,258 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','export')
2014-01-20 16:17:48,259 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','download')
2014-01-20 16:17:48,260 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','print')
2014-01-20 16:17:48,262 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','accredit')
2014-01-20 16:17:48,262 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','audit')
2014-01-20 16:17:48,263 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','inport')
2014-01-20 16:17:48,263 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','copy')
2014-01-20 16:17:48,265 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','save')
2014-01-20 16:17:48,265 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','add')
2014-01-20 16:17:48,268 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','edit')
2014-01-20 16:17:48,268 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','delete')
2014-01-20 16:17:48,268 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','search')
2014-01-20 16:17:48,269 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','refresh')
2014-01-20 16:17:48,269 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','download')
2014-01-20 16:17:48,269 [34700] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','audit')
2014-01-20 16:17:48,270 [34700] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 16:17:48,270 [34700] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 16:17:48,271 [34700] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 16:17:48,273 [34700] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 16:17:48,275 [34700] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 16:17:48,275 [34700] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 16:17:48,278 [34700] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T1','1204','True','ChargeTel')
2014-01-20 16:17:59,181 [29472] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:17:59,181 [29472] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:17:59,188 [29472] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'temp01' 
2014-01-20 16:17:59,226 [29472] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('temp01','临时工','fwytech-PC','localhost','上海市','星期一 16:17:59')
2014-01-20 16:17:59,289 [29472] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:17:59,289 [29472] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:17:59,362 [34700] DEBUG Sys - select * from sys_userSetting where UserCode='temp01'
2014-01-20 16:17:59,609 [7620] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'temp01' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'temp01'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:18:04,771 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'temp01'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2014-01-20 16:18:05,233 [29472] DEBUG Servicemms_merchants - 获取实体列表
2014-01-20 16:18:05,233 [34332] DEBUG Servicemms_merchantsType - 获取动态列表
2014-01-20 16:18:05,233 [29472] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2014-01-20 16:18:05,245 [34332] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2014-01-20 16:18:05,289 [29472] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2014-01-20 16:18:57,991 [10548] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:18:57,991 [10548] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:18:57,993 [10548] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:18:58,004 [10548] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:18:58')
2014-01-20 16:18:58,007 [10548] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:18:58,007 [10548] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:18:58,036 [8144] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:18:58,293 [34332] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:19:02,512 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:19:02,523 [29756] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:19:02,523 [29756] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:19:02,524 [29756] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:19:02,524 [29756] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:19:02,844 [34700] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:19:02,845 [34700] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:19:05,731 [7620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:19:05,733 [7620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:19:05,795 [34640] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:19:05,795 [34640] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:19:05,902 [7620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:19:29,750 [7620] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 16:19:29,751 [7620] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 16:19:29,753 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','10')
2014-01-20 16:19:29,753 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1002')
2014-01-20 16:19:29,759 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1001')
2014-01-20 16:19:29,763 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100101')
2014-01-20 16:19:29,764 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','100201')
2014-01-20 16:19:29,765 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','12')
2014-01-20 16:19:29,767 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1204')
2014-01-20 16:19:29,769 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1201')
2014-01-20 16:19:29,769 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1202')
2014-01-20 16:19:29,770 [7620] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T1','1203')
2014-01-20 16:19:29,771 [7620] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 16:19:29,771 [7620] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 16:19:29,771 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','browse')
2014-01-20 16:19:29,772 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','search')
2014-01-20 16:19:29,772 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','refresh')
2014-01-20 16:19:29,772 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','export')
2014-01-20 16:19:29,772 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','download')
2014-01-20 16:19:29,773 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','print')
2014-01-20 16:19:29,773 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','accredit')
2014-01-20 16:19:29,773 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','audit')
2014-01-20 16:19:29,774 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','inport')
2014-01-20 16:19:29,775 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','copy')
2014-01-20 16:19:29,775 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1002','save')
2014-01-20 16:19:29,775 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','add')
2014-01-20 16:19:29,776 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','edit')
2014-01-20 16:19:29,776 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','delete')
2014-01-20 16:19:29,777 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','search')
2014-01-20 16:19:29,778 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','refresh')
2014-01-20 16:19:29,779 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','download')
2014-01-20 16:19:29,780 [7620] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T1','1001','audit')
2014-01-20 16:19:29,790 [7620] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 16:19:29,790 [7620] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 16:19:29,791 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','01','0')
2014-01-20 16:19:29,792 [7620] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T1','0102','1')
2014-01-20 16:19:29,793 [7620] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 16:19:29,794 [7620] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 16:19:29,794 [7620] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T1','1204','True','ChargeTel')
2014-01-20 16:21:31,142 [10908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:21:34,502 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:21:34,861 [29136] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 16:21:34,861 [29136] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 16:21:34,897 [29136] DEBUG Servicesys_user - 获取实体列表
2014-01-20 16:21:34,897 [29136] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 16:21:34,900 [29136] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 16:21:41,042 [35388] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'yrh'
2014-01-20 16:21:45,655 [34700] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'yrh'
2014-01-20 16:21:48,514 [29472] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-20 16:21:48,514 [29472] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'yrh'
2014-01-20 16:21:54,465 [29136] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-20 16:21:54,466 [29136] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'temp01'
2014-01-20 16:22:41,067 [29876] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:22:41,068 [29876] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:22:41,072 [29876] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:22:41,075 [29876] DEBUG Sys - delete from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:22:41,251 [29876] ERROR Servicesys_role - 编辑记录失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<Context>b__2(ErrorEventArgs e) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseDeleteBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Delete\BaseDeleteBuilder.cs:行号 18
   在 Zephyr.Core.ServiceBase`1.<Edit>b__4f(RequestWrapper x) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 60
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 119
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2014-01-20 16:22:41,286 [29876] ERROR /api/sys/role/edit - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , sys_roleService , Object , RequestWrapper , Object )
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 70
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2014-01-20 16:22:46,178 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:22:46,181 [34640] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:22:46,181 [34640] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:22:46,184 [34640] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:22:46,184 [34640] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:22:46,516 [34700] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:22:46,517 [34700] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:23:01,591 [29136] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:23:01,591 [29136] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:23:01,593 [29136] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:23:01,594 [29136] DEBUG Sys - delete from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:23:01,599 [29136] ERROR Servicesys_role - 编辑记录失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<Context>b__2(ErrorEventArgs e) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseDeleteBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Delete\BaseDeleteBuilder.cs:行号 18
   在 Zephyr.Core.ServiceBase`1.<Edit>b__4f(RequestWrapper x) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 60
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 119
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2014-01-20 16:23:01,613 [29136] ERROR /api/sys/role/edit - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , sys_roleService , Object , RequestWrapper , Object )
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 70
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2014-01-20 16:23:13,119 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:23:13,122 [34700] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:23:13,122 [34700] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:23:13,129 [34700] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:23:13,129 [34700] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:23:13,431 [34640] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:23:13,431 [34640] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:23:16,932 [8144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 16:23:16,946 [8144] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 16:23:16,946 [8144] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 16:23:19,652 [29876] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 16:23:22,324 [10908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:23:22,331 [10908] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:23:22,331 [10908] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:23:22,332 [10908] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:23:22,332 [10908] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:23:23,924 [29756] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:23:23,924 [29756] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:23:23,987 [34140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:23:23,987 [34140] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 16:23:28,697 [34332] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T1')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T1')
2014-01-20 16:23:33,727 [10548] DEBUG Servicesys_role - 设置角色成员
2014-01-20 16:23:33,729 [10548] DEBUG Sys - delete from sys_userRoleMap where [RoleCode] = 'T1'
2014-01-20 16:23:33,733 [10548] DEBUG Sys - delete from sys_organizeRoleMap where [RoleCode] = 'T1'
2014-01-20 16:23:34,992 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:23:35,419 [34700] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 16:23:35,420 [34700] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 16:23:35,441 [32944] DEBUG Servicesys_user - 获取实体列表
2014-01-20 16:23:35,442 [32944] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 16:23:35,444 [32944] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 16:23:54,349 [32944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:23:56,613 [35388] DEBUG Servicesys_user - 编辑记录
2014-01-20 16:23:56,613 [35388] DEBUG Servicesys_user - 获取动态对象
2014-01-20 16:23:56,614 [35388] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'temp01'
2014-01-20 16:23:56,616 [35388] DEBUG Sys - delete from sys_user where  UserCode =  'temp01'
2014-01-20 16:23:59,354 [34640] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:23:59,357 [34640] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:23:59,357 [34640] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:23:59,366 [34640] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:23:59,366 [34640] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:23:59,976 [34140] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:23:59,976 [34140] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:24:04,341 [10908] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T1')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T1')
2014-01-20 16:24:10,505 [34640] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:24:10,505 [34640] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:24:10,508 [34640] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:24:10,511 [34640] DEBUG Sys - delete from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:24:10,514 [34640] ERROR Servicesys_role - 编辑记录失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<Context>b__2(ErrorEventArgs e) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseDeleteBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Delete\BaseDeleteBuilder.cs:行号 18
   在 Zephyr.Core.ServiceBase`1.<Edit>b__4f(RequestWrapper x) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 60
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 119
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2014-01-20 16:24:10,529 [34640] ERROR /api/sys/role/edit - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , sys_roleService , Object , RequestWrapper , Object )
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 70
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2014-01-20 16:24:13,231 [34700] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:24:13,233 [34700] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:24:13,233 [34700] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:24:13,234 [34700] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:24:13,234 [34700] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:24:13,611 [34332] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:24:13,612 [34332] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:24:15,595 [7620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 16:24:15,598 [7620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T1' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T1'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T1'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T1'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T1'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T1'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T1'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T1'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T1'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T1'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T1'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T1'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T1'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T1'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T1'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 16:24:15,631 [29876] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 16:24:15,631 [29876] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T1' and B.PermissionCode = A.PermissionCode 
2014-01-20 16:24:15,666 [7620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T1'
2014-01-20 16:24:26,272 [30144] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 16:24:26,273 [30144] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T1'
2014-01-20 16:24:26,286 [30144] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 16:24:26,286 [30144] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T1'
2014-01-20 16:24:26,299 [30144] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 16:24:26,299 [30144] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T1'
2014-01-20 16:24:26,301 [30144] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 16:24:26,301 [30144] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T1'
2014-01-20 16:24:33,949 [34140] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:24:33,949 [34140] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:24:33,951 [34140] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:24:33,953 [34140] DEBUG Sys - delete from 
        sys_role
     where  RoleCode =  'T1'
2014-01-20 16:24:34,037 [8144] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:24:34,037 [8144] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:24:47,080 [7620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:24:50,601 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 16:24:50,933 [35388] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 16:24:50,934 [35388] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 16:24:50,960 [34700] DEBUG Servicesys_user - 获取实体列表
2014-01-20 16:24:50,961 [34700] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 16:24:50,963 [34700] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 16:24:55,659 [34332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:24:55,677 [34332] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:24:55,677 [34332] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:24:55,678 [34332] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:24:55,678 [34332] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:25:02,381 [10908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:25:02,383 [10908] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:25:02,385 [10908] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:25:02,391 [10908] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:25:02,391 [10908] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:25:04,098 [29756] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:25:04,100 [29756] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:25:04,100 [29756] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:25:04,104 [29756] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:25:04,104 [29756] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:25:04,440 [34332] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:25:04,440 [34332] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:41:31,030 [34640] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:41:31,141 [34640] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:41:31,148 [34640] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:41:31,152 [34640] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:41:31,600 [34640] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:41:36,793 [29136] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:47:00,498 [31680] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:47:00,510 [31680] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:47:00,520 [31680] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:47:00,521 [31680] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:47:00,521 [31680] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:47:01,987 [36064] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:47:01,991 [36064] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:50:50,660 [34272] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:50,677 [34272] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:50,681 [34272] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:50,682 [34272] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:50,905 [34272] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:50:54,524 [35952] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:51:36,577 [34272] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:51:36,600 [34272] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:51:36,608 [34272] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:51:36,609 [34272] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:51:36,609 [34272] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:51:38,904 [34228] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:51:38,909 [34228] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:52:17,733 [36636] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:52:17,744 [36636] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:52:17,747 [36636] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-20 16:52:17,759 [36636] DEBUG Sys - insert into 
        sys_role
    ([UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('超级管理员','星期一 16:52:17','超级管理员','星期一 16:52:17')
2014-01-20 16:52:17,890 [36636] ERROR Servicesys_role - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'RoleCode'，表 'FwyTech.Sys.dbo.sys_role'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Core.ServiceBase`1.<Edit>b__51(RequestWrapper x) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 62
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 119
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:694af123-a1fb-4083-a827-96b1fefb24c2
2014-01-20 16:52:18,184 [36636] ERROR /api/sys/role/edit - System.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'RoleCode'，表 'FwyTech.Sys.dbo.sys_role'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , sys_roleService , Object , RequestWrapper , Object )
   在 System.Dynamic.UpdateDelegates.UpdateAndExecute4[T0,T1,T2,T3,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3)
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.Edit(Object data) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 70
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:694af123-a1fb-4083-a827-96b1fefb24c2
2014-01-20 16:52:27,477 [26588] DEBUG Servicesys_role - 编辑记录
2014-01-20 16:52:27,478 [26588] DEBUG Servicesys_role - 获取动态对象
2014-01-20 16:52:27,478 [26588] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2014-01-20 16:52:27,479 [26588] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('临时工作人员','T01','92','临时工角色','超级管理员','星期一 16:52:27','超级管理员','星期一 16:52:27')
2014-01-20 16:52:27,626 [35952] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:52:27,703 [35952] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:52:32,647 [34228] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:52:32,653 [34228] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:52:32,654 [34228] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:52:32,658 [34228] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:52:32,659 [34228] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:52:33,606 [34272] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:52:33,606 [34272] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 17:01:08,863 [29412] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:01:08,870 [7696] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:01:08,874 [7696] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:01:08,886 [29412] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:01:08,988 [7696] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:02:48,090 [30452] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:02:48,092 [30452] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:02:48,173 [32140] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:02:48,173 [32140] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:02:48,224 [30452] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:15:44,884 [36224] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 17:15:44,888 [36224] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 17:15:44,891 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 17:15:44,893 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 17:15:44,895 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 17:15:44,896 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 17:15:44,896 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 17:15:44,897 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 17:15:44,897 [36224] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 17:15:44,902 [36224] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 17:15:44,904 [36224] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 17:15:44,908 [36224] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 17:15:44,909 [36224] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 17:15:44,916 [36224] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 17:15:44,918 [36224] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 17:18:14,693 [36224] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:18:14,694 [36224] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:18:14,744 [35200] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:18:14,756 [36224] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:18:14,786 [35200] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:24:22,055 [36552] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 17:24:22,064 [36552] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 17:24:22,065 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 17:24:22,068 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 17:24:22,069 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 17:24:22,070 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 17:24:22,071 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 17:24:22,071 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 17:24:22,072 [36552] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 17:24:22,075 [36552] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 17:24:22,075 [36552] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 17:24:22,076 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 17:24:22,084 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 17:24:22,086 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 17:24:22,089 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 17:24:22,089 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 17:24:22,092 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 17:24:22,095 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 17:24:22,095 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 17:24:22,099 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 17:24:22,100 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 17:24:22,102 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 17:24:22,102 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','add')
2014-01-20 17:24:22,105 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 17:24:22,106 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','delete')
2014-01-20 17:24:22,106 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 17:24:22,106 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 17:24:22,107 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 17:24:22,107 [36552] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 17:24:22,108 [36552] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 17:24:22,109 [36552] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 17:24:22,109 [36552] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 17:24:22,109 [36552] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 17:30:35,747 [29136] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:30:35,754 [29136] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:30:35,788 [28180] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:30:35,794 [28180] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:30:35,814 [29136] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:33:17,279 [33924] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 17:33:17,279 [33924] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 17:33:17,282 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 17:33:17,283 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 17:33:17,284 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 17:33:17,284 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 17:33:17,285 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 17:33:17,285 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 17:33:17,285 [33924] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 17:33:17,286 [33924] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 17:33:17,287 [33924] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 17:33:17,287 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 17:33:17,287 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 17:33:17,288 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 17:33:17,289 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 17:33:17,289 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 17:33:17,292 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 17:33:17,294 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 17:33:17,294 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 17:33:17,295 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 17:33:17,295 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 17:33:17,295 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 17:33:17,296 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','add')
2014-01-20 17:33:17,296 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 17:33:17,297 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','delete')
2014-01-20 17:33:17,297 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 17:33:17,297 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 17:33:17,297 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 17:33:17,298 [33924] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 17:33:17,298 [33924] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 17:33:17,298 [33924] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 17:33:17,299 [33924] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 17:33:17,301 [33924] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 17:33:17,303 [33924] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 17:33:17,303 [33924] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 17:37:19,961 [27756] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:37:19,963 [27756] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:37:19,997 [27880] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:37:20,022 [27756] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:37:20,068 [27880] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:37:34,652 [36144] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:37:34,653 [36144] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:37:34,689 [34472] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:37:34,689 [34472] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:37:34,716 [36144] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:41:33,887 [36828] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-20 17:41:40,347 [36484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-20 17:41:40,857 [36828] DEBUG Servicesys_codeType - 获取动态列表
2014-01-20 17:41:40,858 [36828] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-20 17:41:41,597 [35812] DEBUG Servicesys_code - 获取实体列表
2014-01-20 17:41:41,597 [35812] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-20 17:41:41,781 [35812] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-20 17:43:07,505 [29220] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 17:43:07,508 [29220] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 17:43:07,549 [31876] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 17:43:07,563 [31876] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 17:43:07,575 [29220] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 17:44:36,649 [29220] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 17:44:36,649 [29220] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 17:44:36,652 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 17:44:36,652 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 17:44:36,653 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 17:44:36,654 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 17:44:36,654 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 17:44:36,655 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 17:44:36,655 [29220] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 17:44:36,658 [29220] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 17:44:36,658 [29220] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 17:44:36,659 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 17:44:36,660 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 17:44:36,661 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 17:44:36,661 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 17:44:36,662 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 17:44:36,663 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 17:44:36,663 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 17:44:36,663 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 17:44:36,664 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 17:44:36,664 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 17:44:36,665 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 17:44:36,666 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','add')
2014-01-20 17:44:36,669 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 17:44:36,669 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','delete')
2014-01-20 17:44:36,670 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 17:44:36,670 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 17:44:36,671 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 17:44:36,672 [29220] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 17:44:36,673 [29220] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 17:44:36,674 [29220] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 17:44:36,675 [29220] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 17:44:36,676 [29220] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 17:44:36,676 [29220] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 17:44:36,676 [29220] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 17:44:36,721 [29220] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','9906','True','Text')
2014-01-20 17:49:07,252 [36940] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'T01')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'T01')
2014-01-20 19:39:10,288 [10176] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:39:10,565 [10176] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:39:10,618 [10176] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:39:10,696 [10176] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 19:39:12,102 [10176] DEBUG Sys - select * from sys_userSetting where UserCode='beifeng'
2014-01-20 19:39:18,119 [8392] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'beifeng' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'beifeng'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 19:40:11,937 [3112] DEBUG Servicesys_user - 获取实体对象
2014-01-20 19:40:11,948 [3112] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 19:40:12,005 [3112] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 19:40:12,143 [3112] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 19:40:12')
2014-01-20 19:40:12,285 [3112] DEBUG Servicemms_project - 获取实体对象
2014-01-20 19:40:12,285 [3112] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 19:40:12,372 [8392] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 19:40:12,581 [10724] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 19:40:23,745 [3112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 19:40:23,862 [3112] DEBUG Servicesys_user - 获取动态列表
2014-01-20 19:40:23,863 [3112] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 19:40:23,864 [3112] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 19:40:23,864 [3112] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 19:40:25,020 [6212] DEBUG Servicesys_role - 获取实体列表
2014-01-20 19:40:25,024 [6212] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 19:40:28,459 [12172] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 19:40:28,476 [4852] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 19:40:28,479 [4852] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 19:40:28,479 [12172] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 19:40:28,701 [12172] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 19:47:13,167 [3112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 19:47:18,940 [3112] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 19:47:18,940 [3112] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 19:47:18,993 [10176] DEBUG Servicesys_user - 获取实体列表
2014-01-20 19:47:18,993 [10176] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 19:47:19,118 [10176] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 19:51:55,930 [3112] DEBUG Servicesys_user - 编辑记录
2014-01-20 19:51:55,942 [3112] DEBUG Servicesys_user - 获取动态对象
2014-01-20 19:51:55,984 [3112] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'
2014-01-20 19:51:56,027 [3112] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('bfxb','北风小白','测试人员','true','超级管理员','星期一 19:51:56','超级管理员','星期一 19:51:56')
2014-01-20 19:51:56,075 [3112] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'bfxb'
2014-01-20 19:55:29,988 [3112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 19:55:30,852 [4852] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 19:55:30,853 [4852] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 19:55:30,868 [10176] DEBUG Servicesys_user - 获取实体列表
2014-01-20 19:55:30,869 [10176] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 19:55:30,872 [10176] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 19:55:44,864 [10724] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'bfxb'
2014-01-20 19:59:05,153 [620] DEBUG Servicesys_user - 设置用户角色
2014-01-20 19:59:05,159 [620] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'bfxb'
2014-01-20 19:59:05,251 [620] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('bfxb','T01')
2014-01-20 20:00:45,943 [3112] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'bfxb'
2014-01-20 20:01:02,856 [3112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 20:01:02,864 [3112] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:01:02,865 [3112] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:01:09,714 [12440] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0401'
2014-01-20 20:02:04,566 [10724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 20:02:04,579 [10724] DEBUG Servicesys_user - 获取动态列表
2014-01-20 20:02:04,579 [10724] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 20:02:04,581 [10724] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 20:02:04,581 [10724] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 20:02:04,927 [620] DEBUG Servicesys_role - 获取实体列表
2014-01-20 20:02:04,927 [620] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 20:02:19,624 [11980] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:02:19,653 [11980] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:02:19,680 [12440] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:02:19,680 [12440] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:02:19,938 [11980] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 20:02:34,581 [620] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:02:34,582 [620] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:02:34,648 [6212] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:02:34,648 [6212] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:02:34,880 [620] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-20 20:06:53,897 [3112] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 20:06:53,899 [3112] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-20 20:06:53,919 [3112] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','03')
2014-01-20 20:06:53,985 [3112] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','0301')
2014-01-20 20:06:53,987 [3112] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-20 20:06:53,987 [3112] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-20 20:06:53,987 [3112] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-20 20:06:53,989 [3112] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 20:06:53,990 [3112] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-20 20:06:54,042 [3112] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 20:06:54,042 [3112] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-20 20:06:54,046 [3112] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 20:06:54,047 [3112] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-20 20:06:57,062 [10724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 20:06:57,069 [10724] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:06:57,069 [10724] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:07:02,045 [4852] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0401'
2014-01-20 20:09:06,671 [13812] DEBUG Servicesys_organize - 设置机构角色
2014-01-20 20:09:06,674 [13812] DEBUG Sys - delete from sys_organizeRoleMap where [OrganizeCode] = '0401'
2014-01-20 20:09:06,720 [13812] DEBUG Sys - insert into sys_organizeRoleMap([OrganizeCode],[RoleCode]) values('0401','bf001')
2014-01-20 20:15:35,630 [2352] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 20:15:36,214 [14688] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:15:36,214 [14688] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:15:36,237 [14228] DEBUG Servicesys_user - 获取实体列表
2014-01-20 20:15:36,237 [14228] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 20:15:36,238 [14228] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 20:15:41,174 [14688] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'bfxb'
2014-01-20 20:17:09,661 [5596] DEBUG Servicesys_user - 设置用户机构
2014-01-20 20:17:09,662 [5596] DEBUG Sys - delete from sys_userOrganizeMap where [UserCode] = 'bfxb'
2014-01-20 20:17:09,666 [5596] DEBUG Sys - insert into sys_userOrganizeMap([UserCode],[OrganizeCode]) values('bfxb','0401')
2014-01-20 20:18:28,397 [13508] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-20 20:18:28,397 [13508] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'bfxb'
2014-01-20 20:19:01,492 [11360] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-20 20:19:01,492 [11360] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'super'
2014-01-20 20:21:12,216 [12544] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:21:12,216 [12544] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:21:12,219 [12544] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 20:21:12,227 [12544] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 20:21:12')
2014-01-20 20:21:12,258 [12544] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:21:12,261 [12544] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:21:12,320 [5596] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 20:21:12,591 [5596] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:21:26,274 [6820] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:21:26,274 [6820] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:21:26,277 [6820] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 20:21:26,324 [6820] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 20:21:26')
2014-01-20 20:21:26,380 [6820] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:21:26,380 [6820] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:21:26,414 [12016] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 20:21:26,636 [11732] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:26:51,288 [14744] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:26:51,288 [14744] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:26:51,294 [14744] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 20:26:51,304 [14744] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 20:26:51')
2014-01-20 20:26:51,308 [14744] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:26:51,308 [14744] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:26:51,340 [10452] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 20:26:51,616 [6292] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:26:56,742 [8744] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 20:26:56,799 [8744] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:26:56,799 [8744] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:26:59,025 [13704] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0401'
2014-01-20 20:27:04,470 [13704] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 20:27:04,487 [13704] DEBUG Servicesys_user - 获取动态列表
2014-01-20 20:27:04,488 [13704] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 20:27:04,489 [13704] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 20:27:04,490 [13704] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 20:27:04,840 [6292] DEBUG Servicesys_role - 获取实体列表
2014-01-20 20:27:04,840 [6292] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 20:27:08,348 [14744] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:27:08,354 [14744] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:27:08,406 [5596] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:27:08,420 [5596] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:27:08,614 [14744] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-20 20:27:20,567 [10020] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 20:27:20,568 [10020] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-20 20:27:20,575 [10020] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','03')
2014-01-20 20:27:20,581 [10020] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','0301')
2014-01-20 20:27:20,584 [10020] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','99')
2014-01-20 20:27:20,586 [10020] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9906')
2014-01-20 20:27:20,587 [10020] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','9911')
2014-01-20 20:27:20,592 [10020] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 20:27:20,592 [10020] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-20 20:27:20,595 [10020] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 20:27:20,595 [10020] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-20 20:27:20,598 [10020] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 20:27:20,598 [10020] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-20 20:28:28,745 [14136] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:28:28,749 [14136] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:28:28,812 [13704] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:28:28,812 [13704] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:28:28,950 [14136] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-20 20:29:09,209 [14136] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:29:09,221 [14136] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='bf001' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='bf001'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='bf001'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='bf001'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='bf001'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='bf001'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='bf001'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='bf001'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='bf001'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='bf001'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='bf001'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='bf001'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='bf001'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='bf001'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='bf001'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:29:09,267 [13704] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:29:09,267 [13704] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='bf001' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:29:09,441 [14136] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'bf001'
2014-01-20 20:29:28,713 [14136] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 20:29:28,714 [14136] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'bf001'
2014-01-20 20:29:28,725 [14136] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','03')
2014-01-20 20:29:28,728 [14136] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('bf001','0301')
2014-01-20 20:29:28,732 [14136] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 20:29:28,732 [14136] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'bf001'
2014-01-20 20:29:28,735 [14136] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 20:29:28,735 [14136] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'bf001'
2014-01-20 20:29:28,737 [14136] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 20:29:28,737 [14136] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'bf001'
2014-01-20 20:29:32,507 [14120] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-20 20:29:33,061 [13980] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 20:29:33,104 [13980] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:29:33,105 [13980] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:29:37,347 [14136] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-20 20:29:37,354 [14136] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 20:29:37,354 [14136] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 20:29:38,488 [14136] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:29:38,488 [14136] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-20 20:29:40,534 [13704] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0401'
2014-01-20 20:29:43,923 [14136] DEBUG Servicesys_organize - 设置机构角色
2014-01-20 20:29:43,925 [14136] DEBUG Sys - delete from sys_organizeRoleMap where [OrganizeCode] = '0401'
2014-01-20 20:29:43,933 [14136] DEBUG Sys - insert into sys_organizeRoleMap([OrganizeCode],[RoleCode]) values('0401','bf001')
2014-01-20 20:29:59,696 [14136] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:29:59,696 [14136] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:29:59,702 [14136] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 20:29:59,715 [14136] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 20:29:59')
2014-01-20 20:29:59,720 [14136] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:29:59,724 [14136] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:29:59,744 [14120] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 20:29:59,963 [14120] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:30:18,450 [13980] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'bfxb'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 20:30:18,476 [13980] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 20:30:18,477 [13980] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 20:30:18,548 [13980] DEBUG Servicesys_code - 获取动态列表
2014-01-20 20:30:18,548 [13980] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 20:30:18,567 [13980] DEBUG Servicesys_code - 获取动态列表
2014-01-20 20:30:18,567 [13980] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 20:30:19,831 [13980] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 20:30:19,834 [13980] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
2014-01-20 20:30:19,851 [13980] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 20:30:19,851 [13980] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
order by ButtonSeq
2014-01-20 20:30:20,870 [13336] DEBUG Servicemms_send - 获取动态列表
2014-01-20 20:30:20,871 [13336] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 20:30:20,995 [13336] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 20:34:03,634 [13980] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:34:03,635 [13980] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:34:03,639 [13980] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 20:34:03,650 [13980] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 20:34:03')
2014-01-20 20:34:03,654 [13980] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:34:03,654 [13980] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:34:03,715 [16268] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 20:34:03,957 [13980] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:34:07,569 [13452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 20:34:07,581 [13452] DEBUG Servicesys_user - 获取动态列表
2014-01-20 20:34:07,581 [13452] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 20:34:07,583 [13452] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 20:34:07,583 [13452] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 20:34:07,946 [13452] DEBUG Servicesys_role - 获取实体列表
2014-01-20 20:34:07,947 [13452] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 20:34:15,239 [13452] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:34:15,242 [13452] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:34:15,348 [13980] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:34:15,348 [13980] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:34:15,436 [13452] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 20:36:45,289 [16268] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 20:36:45,289 [16268] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 20:36:45,292 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 20:36:45,295 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 20:36:45,297 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 20:36:45,298 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 20:36:45,298 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 20:36:45,299 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 20:36:45,299 [16268] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 20:36:45,300 [16268] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 20:36:45,301 [16268] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 20:36:45,307 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','add')
2014-01-20 20:36:45,310 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 20:36:45,314 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','edit')
2014-01-20 20:36:45,316 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','delete')
2014-01-20 20:36:45,317 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 20:36:45,317 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 20:36:45,319 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 20:36:45,320 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 20:36:45,322 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 20:36:45,324 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 20:36:45,325 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 20:36:45,325 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 20:36:45,325 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 20:36:45,325 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 20:36:45,325 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 20:36:45,326 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 20:36:45,326 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 20:36:45,326 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 20:36:45,326 [16268] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 20:36:45,327 [16268] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 20:36:45,327 [16268] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 20:36:45,329 [16268] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 20:36:45,331 [16268] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 20:36:45,337 [16268] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 20:36:45,338 [16268] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 20:36:45,342 [16268] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','9906','True','Text')
2014-01-20 20:42:06,521 [16048] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:42:06,521 [16048] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:42:06,525 [16048] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 20:42:06,533 [16048] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 20:42:06')
2014-01-20 20:42:06,535 [16048] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:42:06,541 [16048] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:42:06,567 [16048] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 20:42:06,832 [14140] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:42:09,367 [15572] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'bfxb'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 20:42:09,381 [15572] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 20:42:09,381 [15572] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 20:42:09,395 [15572] DEBUG Servicesys_code - 获取动态列表
2014-01-20 20:42:09,395 [15572] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 20:42:09,410 [15572] DEBUG Servicesys_code - 获取动态列表
2014-01-20 20:42:09,410 [15572] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 20:42:09,446 [15572] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 20:42:09,453 [15572] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
2014-01-20 20:42:09,478 [15572] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 20:42:09,481 [15572] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
order by ButtonSeq
2014-01-20 20:42:10,169 [15572] DEBUG Servicemms_send - 获取动态列表
2014-01-20 20:42:10,169 [15572] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 20:42:10,192 [15572] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 20:54:58,282 [14576] DEBUG Servicesys_user - 获取实体对象
2014-01-20 20:54:58,290 [14576] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 20:54:58,293 [14576] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 20:54:58,302 [14576] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 20:54:58')
2014-01-20 20:54:58,305 [14576] DEBUG Servicemms_project - 获取实体对象
2014-01-20 20:54:58,312 [14576] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 20:54:58,345 [16676] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 20:54:58,673 [5364] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 20:55:06,051 [5364] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 20:55:06,066 [5364] DEBUG Servicesys_user - 获取动态列表
2014-01-20 20:55:06,066 [5364] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 20:55:06,067 [5364] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 20:55:06,067 [5364] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 20:55:06,391 [15676] DEBUG Servicesys_role - 获取实体列表
2014-01-20 20:55:06,391 [15676] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 20:55:12,825 [14576] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 20:55:12,829 [14576] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 20:55:12,967 [16972] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 20:55:12,971 [16972] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 20:55:12,976 [14576] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 20:57:04,373 [16360] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 20:57:04,376 [16360] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 20:57:04,380 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 20:57:04,383 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 20:57:04,386 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 20:57:04,389 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 20:57:04,390 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 20:57:04,391 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 20:57:04,392 [16360] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 20:57:04,395 [16360] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 20:57:04,395 [16360] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 20:57:04,397 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','add')
2014-01-20 20:57:04,400 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 20:57:04,402 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','edit')
2014-01-20 20:57:04,404 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','delete')
2014-01-20 20:57:04,405 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 20:57:04,405 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 20:57:04,406 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 20:57:04,407 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 20:57:04,409 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 20:57:04,412 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 20:57:04,413 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 20:57:04,413 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 20:57:04,413 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 20:57:04,415 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 20:57:04,415 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 20:57:04,416 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 20:57:04,416 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 20:57:04,417 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 20:57:04,417 [16360] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 20:57:04,419 [16360] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 20:57:04,419 [16360] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 20:57:04,422 [16360] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 20:57:04,424 [16360] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 20:57:04,426 [16360] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 20:57:04,426 [16360] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 20:57:04,428 [16360] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','9906','True','Text')
2014-01-20 21:01:42,223 [16440] DEBUG Servicesys_user - 获取实体对象
2014-01-20 21:01:42,223 [16440] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 21:01:42,226 [16440] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 21:01:42,235 [16440] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 21:01:42')
2014-01-20 21:01:42,237 [16440] DEBUG Servicemms_project - 获取实体对象
2014-01-20 21:01:42,237 [16440] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 21:01:42,263 [13036] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 21:01:42,493 [15676] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 21:01:44,252 [16332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'bfxb'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 21:01:44,268 [16332] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 21:01:44,269 [16332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 21:01:44,271 [16332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:01:44,271 [16332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 21:01:44,275 [16332] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:01:44,275 [16332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 21:01:44,289 [16332] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:01:44,291 [16332] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
2014-01-20 21:01:44,309 [16332] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:01:44,311 [16332] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
order by ButtonSeq
2014-01-20 21:01:44,989 [14976] DEBUG Servicemms_send - 获取动态列表
2014-01-20 21:01:44,989 [14976] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 21:01:45,004 [14976] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 21:02:04,417 [14976] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'bfxb'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 21:02:04,420 [14976] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 21:02:04,420 [14976] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 21:02:04,421 [14976] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:02:04,421 [14976] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 21:02:04,421 [14976] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:02:04,421 [14976] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 21:02:04,435 [14976] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:02:04,436 [14976] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
2014-01-20 21:02:04,438 [14976] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:02:04,440 [14976] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
order by ButtonSeq
2014-01-20 21:02:04,976 [15676] DEBUG Servicemms_send - 获取动态列表
2014-01-20 21:02:04,976 [15676] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 21:02:04,980 [15676] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 21:02:16,101 [15676] DEBUG Servicesys_user - 获取实体对象
2014-01-20 21:02:16,101 [15676] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 21:02:16,103 [15676] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 21:02:16,121 [15676] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 21:02:16')
2014-01-20 21:02:16,127 [15676] DEBUG Servicemms_project - 获取实体对象
2014-01-20 21:02:16,128 [15676] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 21:02:16,146 [15460] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 21:02:16,398 [5364] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 21:02:20,988 [15460] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-20 21:02:21,499 [13036] DEBUG Servicesys_organize - 获取实体列表
2014-01-20 21:02:21,499 [13036] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-20 21:02:21,532 [15676] DEBUG Servicesys_user - 获取实体列表
2014-01-20 21:02:21,533 [15676] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-20 21:02:21,556 [15676] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-20 21:02:22,062 [14976] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 21:02:22,065 [14976] DEBUG Servicesys_user - 获取动态列表
2014-01-20 21:02:22,065 [14976] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 21:02:22,066 [14976] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 21:02:22,066 [14976] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 21:02:22,481 [16440] DEBUG Servicesys_role - 获取实体列表
2014-01-20 21:02:22,481 [16440] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 21:02:27,147 [16440] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 21:02:27,148 [16440] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 21:02:27,207 [15676] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 21:02:27,213 [16440] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 21:02:27,236 [15676] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 21:03:11,719 [15676] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 21:03:11,719 [15676] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 21:03:11,720 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 21:03:11,721 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 21:03:11,721 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 21:03:11,722 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 21:03:11,722 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 21:03:11,724 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 21:03:11,724 [15676] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 21:03:11,726 [15676] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 21:03:11,726 [15676] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 21:03:11,727 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','add')
2014-01-20 21:03:11,729 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 21:03:11,730 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','edit')
2014-01-20 21:03:11,730 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','delete')
2014-01-20 21:03:11,731 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 21:03:11,732 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 21:03:11,732 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 21:03:11,732 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 21:03:11,733 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 21:03:11,733 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 21:03:11,733 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 21:03:11,734 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 21:03:11,734 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 21:03:11,734 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 21:03:11,735 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 21:03:11,736 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 21:03:11,736 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 21:03:11,736 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 21:03:11,736 [15676] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 21:03:11,737 [15676] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 21:03:11,737 [15676] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 21:03:11,738 [15676] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 21:03:11,738 [15676] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 21:03:11,739 [15676] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 21:03:11,739 [15676] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 21:03:11,740 [15676] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','1001','True','TotalMoney')
2014-01-20 21:03:11,743 [15676] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','1001','True','BillNo')
2014-01-20 21:03:11,746 [15676] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','9906','True','Text')
2014-01-20 21:03:25,671 [16360] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 21:03:25,672 [16360] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='T01' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='T01'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='T01'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='T01'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='T01'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='T01'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='T01'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='T01'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='T01'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='T01'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='T01'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='T01'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='T01'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='T01'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='T01'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 21:03:25,710 [15460] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 21:03:25,711 [15460] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='T01' and B.PermissionCode = A.PermissionCode 
2014-01-20 21:03:25,773 [16360] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'T01'
2014-01-20 21:03:30,457 [17260] DEBUG Servicesys_role - 修改角色菜单权限
2014-01-20 21:03:30,457 [17260] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'T01'
2014-01-20 21:03:30,458 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','10')
2014-01-20 21:03:30,459 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1002')
2014-01-20 21:03:30,459 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','1001')
2014-01-20 21:03:30,459 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','99')
2014-01-20 21:03:30,460 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9906')
2014-01-20 21:03:30,460 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9911')
2014-01-20 21:03:30,462 [17260] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('T01','9907')
2014-01-20 21:03:30,466 [17260] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-01-20 21:03:30,467 [17260] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'T01'
2014-01-20 21:03:30,468 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','add')
2014-01-20 21:03:30,468 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','browse')
2014-01-20 21:03:30,469 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','edit')
2014-01-20 21:03:30,469 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','delete')
2014-01-20 21:03:30,470 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','search')
2014-01-20 21:03:30,470 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','refresh')
2014-01-20 21:03:30,470 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','export')
2014-01-20 21:03:30,471 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','download')
2014-01-20 21:03:30,471 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','print')
2014-01-20 21:03:30,471 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','accredit')
2014-01-20 21:03:30,472 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','audit')
2014-01-20 21:03:30,472 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','inport')
2014-01-20 21:03:30,472 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','copy')
2014-01-20 21:03:30,472 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1002','save')
2014-01-20 21:03:30,473 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','edit')
2014-01-20 21:03:30,473 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','search')
2014-01-20 21:03:30,473 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','refresh')
2014-01-20 21:03:30,474 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','download')
2014-01-20 21:03:30,474 [17260] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('T01','1001','audit')
2014-01-20 21:03:30,475 [17260] DEBUG Servicesys_role - 修改角色数据权限
2014-01-20 21:03:30,475 [17260] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'T01'
2014-01-20 21:03:30,476 [17260] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','01','0')
2014-01-20 21:03:30,477 [17260] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('T01','0102','1')
2014-01-20 21:03:30,478 [17260] DEBUG Servicesys_role - 修改角色数据列权限
2014-01-20 21:03:30,479 [17260] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'T01'
2014-01-20 21:03:30,479 [17260] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','1001','True','TotalMoney')
2014-01-20 21:03:30,480 [17260] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','1001','True','BillNo')
2014-01-20 21:03:30,480 [17260] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('T01','9906','True','Text')
2014-01-20 21:03:38,518 [14976] DEBUG Servicesys_user - 获取实体对象
2014-01-20 21:03:38,518 [14976] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'bfxb'and Password =  '1234'and IsEnable =  'True'
2014-01-20 21:03:38,520 [14976] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'bfxb' 
2014-01-20 21:03:38,540 [14976] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('bfxb','北风小白','fwytech-PC','localhost','上海市','星期一 21:03:38')
2014-01-20 21:03:38,541 [14976] DEBUG Servicemms_project - 获取实体对象
2014-01-20 21:03:38,542 [14976] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 21:03:38,565 [17260] DEBUG Sys - select * from sys_userSetting where UserCode='bfxb'
2014-01-20 21:03:38,790 [16360] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'bfxb' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'bfxb'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 21:03:40,340 [14976] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'bfxb'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-20 21:03:40,345 [14976] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-20 21:03:40,345 [14976] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-20 21:03:40,351 [14976] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:03:40,351 [14976] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-20 21:03:40,352 [14976] DEBUG Servicesys_code - 获取动态列表
2014-01-20 21:03:40,352 [14976] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-20 21:03:40,372 [14976] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:03:40,373 [14976] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
2014-01-20 21:03:40,374 [14976] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-20 21:03:40,374 [14976] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'bfxb'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'bfxb'
)
order by ButtonSeq
2014-01-20 21:03:41,004 [14784] DEBUG Servicemms_send - 获取动态列表
2014-01-20 21:03:41,004 [14784] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-20 21:03:41,009 [14784] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-20 21:05:32,221 [17260] DEBUG Servicesys_user - 获取实体对象
2014-01-20 21:05:32,221 [17260] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 21:05:32,223 [17260] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 21:05:32,234 [17260] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 21:05:32')
2014-01-20 21:05:32,235 [17260] DEBUG Servicemms_project - 获取实体对象
2014-01-20 21:05:32,235 [17260] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 21:05:32,267 [13036] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 21:05:32,482 [14976] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 21:05:36,269 [14576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 21:05:36,282 [14576] DEBUG Servicesys_user - 获取动态列表
2014-01-20 21:05:36,282 [14576] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 21:05:36,283 [14576] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 21:05:36,283 [14576] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 21:05:36,629 [16172] DEBUG Servicesys_role - 获取实体列表
2014-01-20 21:05:36,629 [16172] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 21:05:39,388 [15460] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-20 21:05:39,398 [15460] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='Manage' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='Manage'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='Manage'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='Manage'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='Manage'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='Manage'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='Manage'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='Manage'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='Manage'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='Manage'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='Manage'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='Manage'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='Manage'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='Manage'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='Manage'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-20 21:05:39,461 [16360] DEBUG Servicesys_permission - 获取动态列表
2014-01-20 21:05:39,461 [16360] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='Manage' and B.PermissionCode = A.PermissionCode 
2014-01-20 21:05:39,587 [15460] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'Manage'
2014-01-20 16:50:32,524 [13000] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:34,992 [13000] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:35,074 [13000] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:35,426 [13000] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 16:50:36,760 [13000] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:50:43,919 [6208] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:51:07,272 [2852] DEBUG Servicesys_user - 获取实体对象
2014-01-20 16:51:07,280 [2852] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-20 16:51:07,892 [2852] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-20 16:51:08,314 [2852] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','星期一 16:51:08')
2014-01-20 16:51:08,623 [2852] DEBUG Servicemms_project - 获取实体对象
2014-01-20 16:51:08,624 [2852] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-20 16:51:09,265 [13000] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 16:51:09,361 [13000] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-20 16:52:23,311 [11144] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-20 16:52:23,900 [11144] DEBUG Servicesys_user - 获取动态列表
2014-01-20 16:52:23,901 [11144] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-20 16:52:23,909 [11144] DEBUG Servicesys_organize - 获取动态列表
2014-01-20 16:52:23,909 [11144] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-20 16:52:25,264 [9796] DEBUG Servicesys_role - 获取实体列表
2014-01-20 16:52:25,267 [9796] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-20 16:53:11,061 [13000] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 16:53:12,093 [11144] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 16:53:12,094 [11144] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 17:00:10,268 [14164] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 17:00:10,584 [9220] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 17:00:10,584 [9220] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 17:04:40,867 [13364] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:04:44,980 [9220] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:05:06,048 [11444] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:05:55,805 [9220] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:06:31,430 [10196] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:08:40,932 [13364] DEBUG Servicesys_menu - 设置菜单按钮
2014-01-20 17:08:40,995 [13364] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '1001'
2014-01-20 17:08:41,265 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','add')
2014-01-20 17:08:41,375 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','edit')
2014-01-20 17:08:41,396 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','delete')
2014-01-20 17:08:41,399 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','search')
2014-01-20 17:08:41,414 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','refresh')
2014-01-20 17:08:41,425 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','download')
2014-01-20 17:08:41,428 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','print')
2014-01-20 17:08:41,430 [13364] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('1001','audit')
2014-01-20 17:10:29,016 [6780] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-20 17:10:59,652 [6780] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-20 17:11:01,270 [13416] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 17:11:01,271 [13416] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 17:14:38,378 [6692] DEBUG Servicesys_menu - 编辑记录
2014-01-20 17:14:38,412 [6692] DEBUG Servicesys_menu - 获取动态对象
2014-01-20 17:14:38,424 [6692] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '9b849678-b1f5-4dae-910f-382418f75afe'
2014-01-20 17:14:38,480 [6692] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('测试菜单','9962','98','icon-color','/sys/test','true','true','','超级管理员','星期一 17:14:38','超级管理员','星期一 17:14:38')
2014-01-20 17:14:38,574 [6692] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"9b849678-b1f5-4dae-910f-382418f75afe","MenuName":"测试菜单","MenuCode":"9962","ParentCode":"98","IconClass":"icon-color","URL":"/sys/test","IsVisible":"true","IsEnable":"true","MenuSeq":""}],"updated":[],"_changed":true}}','星期一 17:14:38')
2014-01-20 17:14:38,929 [11920] DEBUG Servicesys_menu - 获取动态列表
2014-01-20 17:14:38,929 [11920] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-20 21:43:55,803 [16772] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:43:55,890 [16772] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:43:55,905 [16772] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:43:55,908 [16772] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-20 21:43:58,608 [16772] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-20 21:44:09,807 [9956] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
