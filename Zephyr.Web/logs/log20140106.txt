2014-01-06 17:17:02,940 [38876] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:17:17,543 [38876] ERROR Servicesys_user - 获取实体对象失败
System.Data.SqlClient.SqlException (0x80131904): 在与 SQL Server 建立连接时出现与网络相关的或特定于实例的错误。未找到或无法访问服务器。请验证实例名称是否正确并且 SQL Server 已配置为允许远程连接。 (provider: Named Pipes Provider, error: 40 - 无法打开到 SQL Server 的连接) ---> System.ComponentModel.Win32Exception (0x80004005): 拒绝访问。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QuerySingle(Action`2 customMapper) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 129
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass70.<GetModel>b__6f() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 51
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:00000000-0000-0000-0000-000000000000
2014-01-06 17:17:17,662 [38876] ERROR /login/doAction - System.Data.SqlClient.SqlException (0x80131904): 在与 SQL Server 建立连接时出现与网络相关的或特定于实例的错误。未找到或无法访问服务器。请验证实例名称是否正确并且 SQL Server 已配置为允许远程连接。 (provider: Named Pipes Provider, error: 40 - 无法打开到 SQL Server 的连接) ---> System.ComponentModel.Win32Exception (0x80004005): 拒绝访问。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModel(ParamQuery param) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 51
   在 Zephyr.Models.sys_userService.Login(JObject request) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Sys\Models\sys_user.cs:行号 24
   在 Zephyr.Controllers.LoginController.DoAction(JObject request) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Controllers\LoginController.cs:行号 42
   在 lambda_method(Closure , ControllerBase , Object[] )
   在 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   在 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
   在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)
ClientConnectionId:00000000-0000-0000-0000-000000000000
2014-01-06 17:17:54,754 [38876] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-06 17:17:55,005 [38876] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-06 17:17:55,008 [38876] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-06 17:17:55,082 [38876] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-01-06 17:18:01,697 [39984] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:18:01,705 [39984] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '123'and IsEnable =  'True'
2014-01-06 17:18:06,596 [38876] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:18:06,596 [38876] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '123456'and IsEnable =  'True'
2014-01-06 17:18:10,273 [39984] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:18:10,273 [39984] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-06 17:23:17,062 [42592] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:23:17,063 [42592] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  'admin'and IsEnable =  'True'
2014-01-06 17:25:58,439 [42584] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:25:58,440 [42584] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2014-01-06 17:25:58,743 [42584] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-01-06 17:25:58,993 [42584] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','fwytech-PC','localhost','上海市','2014/1/6 17:25:58')
2014-01-06 17:25:59,122 [42584] DEBUG Servicemms_project - 获取实体对象
2014-01-06 17:25:59,125 [42584] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-06 17:25:59,243 [38504] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-01-06 17:26:14,591 [41920] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 17:26:25,462 [33184] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-06 17:26:26,979 [27556] DEBUG Servicesys_parameter - 获取实体列表
2014-01-06 17:26:26,981 [27556] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-06 17:26:27,051 [27556] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-06 17:26:36,245 [24216] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-06 17:26:37,234 [38504] DEBUG Servicesys_codeType - 获取动态列表
2014-01-06 17:26:37,234 [38504] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-06 17:26:37,270 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:26:37,270 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-06 17:26:37,293 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-06 17:27:01,690 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:01,690 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'ImagePart' order by Seq
2014-01-06 17:27:01,692 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'ImagePart' ) tb_temp
2014-01-06 17:27:08,130 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:08,130 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'StockState' order by Seq
2014-01-06 17:27:08,132 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'StockState' ) tb_temp
2014-01-06 17:27:10,143 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:10,143 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'aaa' order by Seq
2014-01-06 17:27:10,145 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'aaa' ) tb_temp
2014-01-06 17:27:11,784 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:11,784 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'BillingUnit' order by Seq
2014-01-06 17:27:11,786 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'BillingUnit' ) tb_temp
2014-01-06 17:27:14,471 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:14,471 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'Education' order by Seq
2014-01-06 17:27:14,473 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'Education' ) tb_temp
2014-01-06 17:27:17,290 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:17,291 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PartAttr' order by Seq
2014-01-06 17:27:17,293 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PartAttr' ) tb_temp
2014-01-06 17:27:23,665 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:23,665 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PersonType' order by Seq
2014-01-06 17:27:23,667 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PersonType' ) tb_temp
2014-01-06 17:27:27,028 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:27,028 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'Sex' order by Seq
2014-01-06 17:27:27,030 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'Sex' ) tb_temp
2014-01-06 17:27:28,884 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:28,884 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'MaterialUse' order by Seq
2014-01-06 17:27:28,887 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'MaterialUse' ) tb_temp
2014-01-06 17:27:31,172 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:31,172 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'KeyProjects' order by Seq
2014-01-06 17:27:31,173 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'KeyProjects' ) tb_temp
2014-01-06 17:27:32,665 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:32,665 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'FundSource' order by Seq
2014-01-06 17:27:32,667 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'FundSource' ) tb_temp
2014-01-06 17:27:34,224 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:34,224 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'BusinessType' order by Seq
2014-01-06 17:27:34,227 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'BusinessType' ) tb_temp
2014-01-06 17:27:39,473 [38504] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:39,473 [38504] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'QualificationLevel' order by Seq
2014-01-06 17:27:39,475 [38504] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'QualificationLevel' ) tb_temp
2014-01-06 17:27:42,108 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:42,108 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'area' order by Seq
2014-01-06 17:27:42,110 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'area' ) tb_temp
2014-01-06 17:27:48,042 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:48,042 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'QualityRequire' order by Seq
2014-01-06 17:27:48,044 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'QualityRequire' ) tb_temp
2014-01-06 17:27:49,214 [41996] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:49,214 [41996] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'DisposalType' order by Seq
2014-01-06 17:27:49,217 [41996] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'DisposalType' ) tb_temp
2014-01-06 17:27:50,337 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:50,338 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PouringWay' order by Seq
2014-01-06 17:27:50,339 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PouringWay' ) tb_temp
2014-01-06 17:27:52,259 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:52,259 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PayType' order by Seq
2014-01-06 17:27:52,261 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PayType' ) tb_temp
2014-01-06 17:27:53,272 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:53,272 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'ApprovalStatus' order by Seq
2014-01-06 17:27:53,276 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'ApprovalStatus' ) tb_temp
2014-01-06 17:27:54,768 [39948] DEBUG Servicesys_code - 获取实体列表
2014-01-06 17:27:54,769 [39948] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'Pricing' order by Seq
2014-01-06 17:27:54,770 [39948] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'Pricing' ) tb_temp
2014-01-06 17:28:04,313 [39948] DEBUG Servicesys_codeType - 获取动态列表
2014-01-06 17:28:04,313 [39948] DEBUG Sys - select top 10 sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-06 17:28:04,315 [39948] DEBUG Sys - select count(*) from ( select sys_codeType.* from sys_codeType ) tb_temp
2014-01-06 17:28:54,620 [39948] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-06 17:28:55,774 [41996] DEBUG Servicesys_user - 获取实体列表
2014-01-06 17:28:55,774 [41996] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-06 17:28:55,782 [41996] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-06 17:28:55,784 [12752] DEBUG Servicesys_organize - 获取实体列表
2014-01-06 17:28:55,784 [12752] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-06 17:30:13,610 [41996] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'scy'
2014-01-06 17:30:30,245 [41996] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'scy'
2014-01-06 17:30:35,726 [39948] DEBUG Servicesys_userSetting - 获取实体列表
2014-01-06 17:30:35,727 [39948] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'scy'
2014-01-06 17:32:18,912 [41344] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'super'
2014-01-06 17:33:12,776 [41344] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'super'
2014-01-06 17:33:24,604 [41344] DEBUG Servicesys_user - 获取实体对象
2014-01-06 17:33:24,605 [41344] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2014-01-06 17:33:24,606 [41344] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2014-01-06 17:33:24,622 [41344] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','fwytech-PC','localhost','上海市','2014/1/6 17:33:24')
2014-01-06 17:33:24,625 [41344] DEBUG Servicemms_project - 获取实体对象
2014-01-06 17:33:24,628 [41344] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2014-01-06 17:33:24,642 [36724] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 17:33:24,939 [36724] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 17:33:31,348 [41344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-06 17:33:31,361 [41344] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:33:31,361 [41344] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:33:31,407 [41344] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 17:33:31,408 [41344] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 17:33:32,880 [36724] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-06 17:33:33,322 [36724] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-06 17:33:33,648 [36724] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-06 17:34:41,867 [42704] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/receivesummary')
2014-01-06 17:34:42,466 [41344] DEBUG Mms - 
Select T.*
From
( 
    --收料单
    Select mms_receive.BillNo As SrcBillNo,'receive' As SrcBillType,mms_receive.ContractCode As ContractCode,
	    mms_receive.SupplierCode,mms_receive.OriginalNum,mms_receive.ReceiveDate As TakeDate,
	    mms_receiveDetail.MaterialCode,mms_receiveDetail.Unit,mms_receiveDetail.UnitPrice,
	    mms_receiveDetail.Num,mms_receiveDetail.Money,mms_receiveDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_receive.BillNo+'receive'+mms_receiveDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_receiveDetail
    Left join mms_receive ON mms_receiveDetail.BillNo=mms_receive.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_receive.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_receiveDetail.MaterialCode
    Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ContractCode As ContractCode,
	    mms_direct.SupplierCode,mms_direct.OriginalNum,mms_direct.ArriveDate As TakeDate,
	    mms_directDetail.MaterialCode,mms_directDetail.Unit,mms_directDetail.UnitPrice,
	    mms_directDetail.Num,mms_directDetail.Money,mms_directDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退货
    Select mms_return.BillNo As SrcBillNo,'return' As SrcBillType,mms_return.ContractCode As ContractCode,
	    mms_return.SupplierCode,'' AS OriginalNum,mms_return.ReturnDate As TakeDate,
	    mms_returnDetail.MaterialCode,mms_returnDetail.Unit,mms_returnDetail.UnitPrice,
	    -mms_returnDetail.Num,-mms_returnDetail.Money,mms_returnDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_return.BillNo+'return'+mms_returnDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_returnDetail
    Left join mms_return ON mms_returnDetail.BillNo=mms_return.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_return.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_returnDetail.MaterialCode
    Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentIn.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentIn.ContractCode As ContractCode,
	    mms_rentIn.SupplierCode,'' as OriginalNum,mms_rentIn.RentInDate As TakeDate,
	    mms_rentInDetail.MaterialCode,mms_rentInDetail.Unit,mms_rentInDetail.UnitPrice,
	    mms_rentInDetail.Num,'0' as Money,mms_rentInDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_rentIn.BillNo+'rentIn'+mms_rentInDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_rentInDetail
    Left join mms_rentIn ON mms_rentInDetail.BillNo=mms_rentIn.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentIn.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_rentInDetail.MaterialCode
    Where mms_rentIn.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'
) as T
Where 1=1 
                
2014-01-06 17:34:42,736 [41344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/receivesummary')
2014-01-06 17:34:56,699 [41344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/sendsummary')
2014-01-06 17:34:56,704 [41344] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 17:34:56,704 [41344] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 17:34:57,275 [42928] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2014-01-06 17:34:57,461 [41344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/sendsummary')
2014-01-06 17:34:57,462 [41344] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 17:34:57,463 [41344] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 17:34:59,519 [42928] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehousequery')
2014-01-06 17:34:59,525 [42928] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:34:59,526 [42928] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:34:59,947 [42928] DEBUG Mms - 
Select mms_warehouseStock.*,mms_material.MaterialName,mms_material.Model,mms_warehouse.WarehouseName,
    mms_warehouseStock.WarehouseCode+'_'+mms_material.MaterialCode as id,'' AS name
From mms_warehouseStock
Left join mms_warehouse on mms_warehouseStock.WarehouseCode=mms_warehouse.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStock.MaterialCode
Where mms_warehouse.ProjectCode='201306030001' 

                
2014-01-06 17:35:00,089 [41344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehousequery')
2014-01-06 17:35:00,092 [41344] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:35:00,092 [41344] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:35:04,972 [41576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehouseaccount')
2014-01-06 17:35:05,508 [41576] DEBUG Mms - 
Select mms_warehouseStockHistory.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStockHistory.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where  mms_warehouse.ProjectCode='201306030001' 
order by mms_warehouseStockHistory.CreateDate desc
                
2014-01-06 17:35:09,311 [41964] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/materialwarnning')
2014-01-06 17:35:09,686 [42928] DEBUG Mms - 
Select mms_materialWarnning.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_materialWarnning
Left join mms_material on mms_material.MaterialCode=mms_materialWarnning.MaterialCode
Where mms_materialWarnning.ProjectCode='201306030001' 
                
2014-01-06 17:35:09,693 [41344] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode=''
                
2014-01-06 17:35:21,080 [41964] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-06 17:35:21,286 [42704] DEBUG Servicesys_organize - 获取实体列表
2014-01-06 17:35:21,287 [42704] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-06 17:35:21,434 [41576] DEBUG Servicesys_user - 获取实体列表
2014-01-06 17:35:21,434 [41576] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-06 17:35:21,435 [41576] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-06 17:35:23,575 [38716] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-06 17:35:23,582 [38716] DEBUG Servicesys_user - 获取动态列表
2014-01-06 17:35:23,582 [38716] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-06 17:35:23,583 [38716] DEBUG Servicesys_organize - 获取动态列表
2014-01-06 17:35:23,583 [38716] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-06 17:35:24,474 [42704] DEBUG Servicesys_role - 获取实体列表
2014-01-06 17:35:24,474 [42704] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-06 17:50:14,492 [14048] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-06 17:50:14,495 [14048] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-06 17:50:14,545 [43148] DEBUG Servicesys_permission - 获取动态列表
2014-01-06 17:50:14,548 [43148] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-06 17:50:14,667 [14048] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-06 17:53:20,028 [28408] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-06 17:53:21,289 [28408] DEBUG Servicesys_permission - 获取动态列表
2014-01-06 17:53:21,290 [28408] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-06 17:53:31,785 [43296] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-01-06 17:53:31,791 [43296] DEBUG Servicesys_organize - 获取实体列表
2014-01-06 17:53:31,791 [43296] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-06 17:53:53,759 [40436] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-01-06 17:53:54,686 [28408] DEBUG Servicesys_menu - 获取动态列表
2014-01-06 17:53:54,686 [28408] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-01-06 17:54:36,373 [40436] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1019' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2014-01-06 17:55:21,742 [44120] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2014-01-06 17:55:34,568 [44544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2014-01-06 17:55:34,575 [44544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:55:34,578 [44544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:55:34,579 [44544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:55:34,579 [44544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 17:55:35,765 [44544] DEBUG Servicemms_direct - 获取动态列表
2014-01-06 17:55:35,766 [44544] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 17:55:35,779 [44544] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 17:56:31,602 [44120] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 17:56:31,612 [44120] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:56:31,612 [44120] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:56:32,823 [44564] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 17:56:32,823 [44564] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 17:56:32,839 [44564] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 17:57:16,191 [44904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/edit')
2014-01-06 17:57:16,214 [44904] DEBUG Servicemms_refund - 获取实体对象
2014-01-06 17:57:16,215 [44904] DEBUG Mms - select mms_refund.* from mms_refund where  BillNo =  '201307050002'
2014-01-06 17:57:16,221 [44904] DEBUG Servicemms_refund - 获取上一条下一条数据
2014-01-06 17:57:16,234 [44904] DEBUG Servicemms_refund - 获取字段
2014-01-06 17:57:16,235 [44904] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo
2014-01-06 17:57:16,237 [44904] DEBUG Servicemms_refund - 获取字段
2014-01-06 17:57:16,237 [44904] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo < '201307050002'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 17:57:16,251 [44904] DEBUG Servicemms_refund - 获取字段
2014-01-06 17:57:16,251 [44904] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo >  '201307050002'and ProjectCode =  '201306030001' order by BillNo
2014-01-06 17:57:16,253 [44904] DEBUG Servicemms_refund - 获取字段
2014-01-06 17:57:16,253 [44904] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 17:57:16,275 [44904] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:57:16,275 [44904] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 17:57:16,276 [44904] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:57:16,276 [44904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:57:17,707 [44564] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 17:57:17,708 [44564] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00508') order by MerchantsCode
2014-01-06 17:57:17,740 [44904] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 17:57:17,740 [44904] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.UnitPrice as SrcUnitPrice,C.Num as SrcNum
     from 
        mms_refundDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
        left join mms_sendDetail C on C.BillNo =  A.SrcBillNo and C.RowId = A.SrcRowId
     where  A.BillNo =  '201307050002' order by A.MaterialCode
2014-01-06 17:57:54,493 [44184] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/return/Index','/Mms/return')
2014-01-06 17:57:54,500 [44184] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:57:54,500 [44184] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:57:54,500 [44184] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:57:54,500 [44184] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 17:57:54,501 [44184] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:57:54,501 [44184] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-06 17:57:55,848 [44192] DEBUG Servicemms_return - 获取动态列表
2014-01-06 17:57:55,848 [44192] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 17:57:55,860 [44192] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 17:58:16,095 [44904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/lossreport/Index','/Mms/lossreport')
2014-01-06 17:58:16,101 [44904] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:58:16,101 [44904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:58:17,402 [44180] DEBUG Servicemms_lossReport - 获取动态列表
2014-01-06 17:58:17,402 [44180] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 17:58:17,415 [44180] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 17:58:27,088 [44564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/lossreport/edit')
2014-01-06 17:58:27,094 [44564] DEBUG Servicemms_lossReport - 获取实体对象
2014-01-06 17:58:27,094 [44564] DEBUG Mms - select mms_lossReport.* from mms_lossReport where  BillNo =  '201306060002'
2014-01-06 17:58:27,096 [44564] DEBUG Servicemms_lossReport - 获取上一条下一条数据
2014-01-06 17:58:27,097 [44564] DEBUG Servicemms_lossReport - 获取字段
2014-01-06 17:58:27,097 [44564] DEBUG Mms - select top 1 BillNo from mms_lossReport where  ProjectCode =  '201306030001' order by BillNo
2014-01-06 17:58:27,099 [44564] DEBUG Servicemms_lossReport - 获取字段
2014-01-06 17:58:27,099 [44564] DEBUG Mms - select top 1 BillNo from mms_lossReport where  BillNo < '201306060002'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 17:58:27,101 [44564] DEBUG Servicemms_lossReport - 获取字段
2014-01-06 17:58:27,101 [44564] DEBUG Mms - select top 1 BillNo from mms_lossReport where  BillNo >  '201306060002'and ProjectCode =  '201306030001' order by BillNo
2014-01-06 17:58:27,103 [44564] DEBUG Servicemms_lossReport - 获取字段
2014-01-06 17:58:27,103 [44564] DEBUG Mms - select top 1 BillNo from mms_lossReport where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 17:58:27,117 [44564] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:58:27,117 [44564] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 17:58:27,117 [44564] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:58:27,117 [44564] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:58:28,173 [44564] DEBUG Servicemms_lossReportDetail - 获取动态列表
2014-01-06 17:58:28,173 [44564] DEBUG Mms - select 
        A.*, C.MaterialName,C.Model,C.Material,D.Num as StockNum,D.UnitPrice as StockUnitPrice
     from 
        mms_LossReportDetail A
        left join mms_LossReport B on B.BillNo = A.BillNo
        left join mms_material C on C.MaterialCode = A.MaterialCode
        left join mms_warehouseStock D on D.WarehouseCode = B.WarehouseCode and D.MaterialCode = A.MaterialCode
     where  A.BillNo =  '201306060002' order by A.RowId
2014-01-06 17:59:20,950 [44564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2014-01-06 17:59:20,957 [44564] DEBUG Servicesys_code - 获取动态列表
2014-01-06 17:59:20,957 [44564] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 17:59:20,957 [44564] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:59:20,957 [44564] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:59:22,382 [44312] DEBUG Servicemms_transfer - 获取动态列表
2014-01-06 17:59:22,382 [44312] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 17:59:22,395 [44312] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 17:59:50,661 [44904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/Index','/Mms/rentin')
2014-01-06 17:59:50,667 [44904] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 17:59:50,667 [44904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 17:59:51,760 [44996] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 17:59:51,761 [44996] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2014-01-06 17:59:51,770 [44996] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2014-01-06 18:00:03,724 [44996] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/edit')
2014-01-06 18:00:03,731 [44996] DEBUG Servicemms_rentIn - 获取实体对象
2014-01-06 18:00:03,731 [44996] DEBUG Mms - select mms_rentIn.* from mms_rentIn where  BillNo =  '201307230002'
2014-01-06 18:00:03,734 [44996] DEBUG Servicemms_rentIn - 获取上一条下一条数据
2014-01-06 18:00:03,735 [44996] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:00:03,735 [44996] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030001' order by BillNo
2014-01-06 18:00:03,737 [44996] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:00:03,737 [44996] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo < '201307230002'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 18:00:03,740 [44996] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:00:03,740 [44996] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo >  '201307230002'and ProjectCode =  '201306030001' order by BillNo
2014-01-06 18:00:03,744 [44996] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:00:03,744 [44996] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 18:00:03,760 [44996] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:00:03,760 [44996] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:00:03,760 [44996] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:00:03,760 [44996] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:00:03,761 [44996] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:00:03,761 [44996] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'BillingUnit'
2014-01-06 18:00:03,761 [44996] DEBUG Servicesys_code - 获取字段
2014-01-06 18:00:03,761 [44996] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'MaterialUse'and IsEnable =  'True'and IsDefault =  'True'
2014-01-06 18:00:04,921 [44564] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:00:04,921 [44564] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2014-01-06 18:00:05,049 [44964] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 18:00:05,050 [44964] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.MerchantsName as UseUnitName
     from 
        mms_rentInDetail A
        left join mms_material B on B.MaterialCode      = A.MaterialCode
        left join mms_merchants C on C.MerchantsCode    = A.UseUnit
     where  BillNo =  '201307230002' order by A.MaterialCode
2014-01-06 18:00:17,188 [44312] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentoff/Index','/Mms/rentoff')
2014-01-06 18:00:17,196 [44312] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:00:17,196 [44312] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:00:18,448 [44312] DEBUG Servicemms_rentOff - 获取动态列表
2014-01-06 18:00:18,448 [44312] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOff A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2014-01-06 18:00:18,457 [44312] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOff A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2014-01-06 18:00:28,442 [44312] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentoff/edit')
2014-01-06 18:00:28,454 [44312] DEBUG Servicemms_rentOff - 获取实体对象
2014-01-06 18:00:28,455 [44312] DEBUG Mms - select mms_rentOff.* from mms_rentOff where  BillNo =  '201306140001'
2014-01-06 18:00:28,458 [44312] DEBUG Servicemms_rentOff - 获取上一条下一条数据
2014-01-06 18:00:28,459 [44312] DEBUG Servicemms_rentOff - 获取字段
2014-01-06 18:00:28,459 [44312] DEBUG Mms - select top 1 BillNo from mms_rentOff where  ProjectCode =  '201306030001' order by BillNo
2014-01-06 18:00:28,461 [44312] DEBUG Servicemms_rentOff - 获取字段
2014-01-06 18:00:28,461 [44312] DEBUG Mms - select top 1 BillNo from mms_rentOff where  BillNo < '201306140001'and ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 18:00:28,463 [44312] DEBUG Servicemms_rentOff - 获取字段
2014-01-06 18:00:28,463 [44312] DEBUG Mms - select top 1 BillNo from mms_rentOff where  BillNo >  '201306140001'and ProjectCode =  '201306030001' order by BillNo
2014-01-06 18:00:28,465 [44312] DEBUG Servicemms_rentOff - 获取字段
2014-01-06 18:00:28,465 [44312] DEBUG Mms - select top 1 BillNo from mms_rentOff where  ProjectCode =  '201306030001' order by BillNo desc
2014-01-06 18:00:28,489 [44312] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:00:28,489 [44312] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:00:28,491 [44312] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:00:28,491 [44312] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:00:29,748 [44312] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:00:29,748 [44312] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2014-01-06 18:00:29,874 [44964] DEBUG Servicemms_rentOff - 获取动态列表
2014-01-06 18:00:29,874 [44964] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_rentOffDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201306140001' order by A.MaterialCode
2014-01-06 18:01:09,813 [44996] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentout/Index','/Mms/rentout')
2014-01-06 18:01:09,818 [44996] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:01:09,819 [44996] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:01:10,956 [44564] DEBUG Servicemms_rentOut - 获取动态列表
2014-01-06 18:01:10,956 [44564] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOut A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     where  isnull(IsTotal,0)<>1 order by A.BillNo
2014-01-06 18:01:11,058 [44564] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOut A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     where  isnull(IsTotal,0)<>1 ) tb_temp
2014-01-06 18:01:31,267 [44808] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/deal/Index','/Mms/deal')
2014-01-06 18:01:31,273 [44808] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:01:31,274 [44808] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'DisposalType'
2014-01-06 18:01:31,274 [44808] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:01:31,274 [44808] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'DisposalWay'
2014-01-06 18:01:32,524 [44564] DEBUG Servicemms_deal - 获取动态列表
2014-01-06 18:01:32,524 [44564] DEBUG Mms - select top 20 
        A.*, B.ProjectName
     from 
        mms_deal A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 18:01:32,530 [44564] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName
     from 
        mms_deal A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 18:01:37,419 [44044] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/repair/Index','/Mms/repair')
2014-01-06 18:01:37,428 [44044] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:01:37,428 [44044] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:01:38,653 [44312] DEBUG Servicemms_repair - 获取动态列表
2014-01-06 18:01:38,654 [44312] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_repair A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.RepairUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 18:01:38,665 [44312] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_repair A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.RepairUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 18:01:42,369 [44044] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/check/Index','/Mms/check')
2014-01-06 18:01:42,375 [44044] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:01:42,375 [44044] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:01:43,476 [44996] DEBUG Servicemms_check - 获取动态列表
2014-01-06 18:01:43,476 [44996] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_check A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  1=1and A.ProjectCode =  '201306030001' order by A.BillNo
2014-01-06 18:01:43,486 [44996] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_check A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  1=1and A.ProjectCode =  '201306030001' ) tb_temp
2014-01-06 18:01:47,745 [44564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2014-01-06 18:01:48,850 [44564] DEBUG Servicepsi_purchase - 获取动态列表
2014-01-06 18:01:48,850 [44564] ERROR Servicepsi_purchase - 获取动态列表失败
System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.Db.Context(String ConnName) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 48
   在 Zephyr.Core.ServiceBase`1.get_db() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 135
   在 Zephyr.Core.ServiceBase`1.BuilderParse(ParamQuery param) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseUtils.cs:行号 53
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass63.<GetDynamicList>b__62() 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2014-01-06 18:01:48,913 [44564] ERROR /api/psi/purchase - System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Get(RequestWrapper query) 位置 e:\private\项目源码\萧勤源码\Zephyr.Net框架源码20131022\source20131022\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 146
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2014-01-06 18:01:54,271 [44564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-06 18:01:54,272 [44564] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:01:54,272 [44564] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:01:54,272 [44564] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 18:01:54,273 [44564] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 18:01:54,554 [44808] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-06 18:01:54,559 [44808] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-06 18:01:54,563 [44808] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-06 18:02:03,708 [44044] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-06 18:02:03,712 [44044] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-06 18:02:03,714 [44044] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-01-06 18:03:27,100 [44312] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/receivesummary')
2014-01-06 18:03:27,600 [45448] DEBUG Mms - 
Select T.*
From
( 
    --收料单
    Select mms_receive.BillNo As SrcBillNo,'receive' As SrcBillType,mms_receive.ContractCode As ContractCode,
	    mms_receive.SupplierCode,mms_receive.OriginalNum,mms_receive.ReceiveDate As TakeDate,
	    mms_receiveDetail.MaterialCode,mms_receiveDetail.Unit,mms_receiveDetail.UnitPrice,
	    mms_receiveDetail.Num,mms_receiveDetail.Money,mms_receiveDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_receive.BillNo+'receive'+mms_receiveDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_receiveDetail
    Left join mms_receive ON mms_receiveDetail.BillNo=mms_receive.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_receive.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_receiveDetail.MaterialCode
    Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ContractCode As ContractCode,
	    mms_direct.SupplierCode,mms_direct.OriginalNum,mms_direct.ArriveDate As TakeDate,
	    mms_directDetail.MaterialCode,mms_directDetail.Unit,mms_directDetail.UnitPrice,
	    mms_directDetail.Num,mms_directDetail.Money,mms_directDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退货
    Select mms_return.BillNo As SrcBillNo,'return' As SrcBillType,mms_return.ContractCode As ContractCode,
	    mms_return.SupplierCode,'' AS OriginalNum,mms_return.ReturnDate As TakeDate,
	    mms_returnDetail.MaterialCode,mms_returnDetail.Unit,mms_returnDetail.UnitPrice,
	    -mms_returnDetail.Num,-mms_returnDetail.Money,mms_returnDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_return.BillNo+'return'+mms_returnDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_returnDetail
    Left join mms_return ON mms_returnDetail.BillNo=mms_return.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_return.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_returnDetail.MaterialCode
    Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentIn.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentIn.ContractCode As ContractCode,
	    mms_rentIn.SupplierCode,'' as OriginalNum,mms_rentIn.RentInDate As TakeDate,
	    mms_rentInDetail.MaterialCode,mms_rentInDetail.Unit,mms_rentInDetail.UnitPrice,
	    mms_rentInDetail.Num,'0' as Money,mms_rentInDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_rentIn.BillNo+'rentIn'+mms_rentInDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_rentInDetail
    Left join mms_rentIn ON mms_rentInDetail.BillNo=mms_rentIn.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentIn.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_rentInDetail.MaterialCode
    Where mms_rentIn.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'
) as T
Where 1=1 
                
2014-01-06 18:03:27,736 [45452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/receivesummary')
2014-01-06 18:03:42,941 [45452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/sendsummary')
2014-01-06 18:03:42,953 [45452] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 18:03:42,954 [45452] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 18:03:43,539 [44044] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2014-01-06 18:03:43,660 [44312] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/sendsummary')
2014-01-06 18:03:43,661 [44312] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 18:03:43,661 [44312] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2014-01-06 18:03:48,560 [45452] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2014-01-06 18:05:28,841 [45608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehousequery')
2014-01-06 18:05:28,843 [45608] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:05:28,844 [45608] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:05:29,394 [45556] DEBUG Mms - 
Select mms_warehouseStock.*,mms_material.MaterialName,mms_material.Model,mms_warehouse.WarehouseName,
    mms_warehouseStock.WarehouseCode+'_'+mms_material.MaterialCode as id,'' AS name
From mms_warehouseStock
Left join mms_warehouse on mms_warehouseStock.WarehouseCode=mms_warehouse.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStock.MaterialCode
Where mms_warehouse.ProjectCode='201306030001' 

                
2014-01-06 18:05:29,525 [45448] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehousequery')
2014-01-06 18:05:29,526 [45448] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:05:29,526 [45448] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2014-01-06 18:05:38,107 [45076] DEBUG Mms - 
Select mms_warehouseStock.*,mms_material.MaterialName,mms_material.Model,mms_warehouse.WarehouseName,
    mms_warehouseStock.WarehouseCode+'_'+mms_material.MaterialCode as id,'' AS name
From mms_warehouseStock
Left join mms_warehouse on mms_warehouseStock.WarehouseCode=mms_warehouse.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStock.MaterialCode
Where mms_warehouse.ProjectCode='201306030001'  And mms_warehouse.WarehouseCode='201306030001'

                
2014-01-06 18:05:46,357 [45556] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehouseaccount')
2014-01-06 18:05:46,900 [44044] DEBUG Mms - 
Select mms_warehouseStockHistory.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStockHistory.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where  mms_warehouse.ProjectCode='201306030001' 
order by mms_warehouseStockHistory.CreateDate desc
                
2014-01-06 18:05:53,104 [45608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/materialwarnning')
2014-01-06 18:05:53,276 [44044] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/materialwarnning')
2014-01-06 18:05:53,579 [45076] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode=''
                
2014-01-06 18:05:53,822 [45448] DEBUG Mms - 
Select mms_materialWarnning.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_materialWarnning
Left join mms_material on mms_material.MaterialCode=mms_materialWarnning.MaterialCode
Where mms_materialWarnning.ProjectCode='201306030001' 
                
2014-01-06 18:05:54,944 [44044] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010102'
                
2014-01-06 18:05:55,144 [45608] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010102'
                
2014-01-06 18:05:56,269 [45448] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010104'
                
2014-01-06 18:05:56,469 [45528] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010104'
                
2014-01-06 18:05:57,993 [45608] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010101'
                
2014-01-06 18:05:58,154 [45076] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010101'
                
2014-01-06 18:06:07,763 [45528] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:06:07,763 [45528] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-06 18:06:07,773 [45528] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-06 18:06:22,287 [45076] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:06:33,665 [45076] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:06:33,685 [45076] DEBUG Sys - update sys_userSetting set [SettingValue] = 'menubutton' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:06:33,689 [45076] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:06:36,720 [45528] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:06:37,129 [45160] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:06:46,851 [45076] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:06:54,959 [45100] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:06:54,960 [45100] DEBUG Sys - update sys_userSetting set [SettingValue] = 'tree' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:06:55,026 [45100] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:06:59,832 [45100] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:07:00,196 [45076] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:07:17,396 [45612] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/balanceaccount')
2014-01-06 18:07:17,399 [45612] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:07:17,402 [45612] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:07:17,448 [45612] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 18:07:17,448 [45612] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-06 18:07:17,640 [45516] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030002'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030002'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030002'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030002'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-01-06 18:07:17,748 [45516] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
                                                                 --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030002'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030002'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030002'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030002'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-01-06 18:07:17,861 [45516] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030002'
group by mms_warehouseStockHistory.MaterialCode

2014-01-06 18:07:24,386 [45516] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/sendsummary')
2014-01-06 18:07:24,387 [45516] DEBUG Servicemms_buildPart - 获取动态列表
2014-01-06 18:07:24,387 [45516] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030002'
2014-01-06 18:07:24,958 [45172] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030002'

) as T
Where 1=1 

                
2014-01-06 18:07:30,222 [45516] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030002'

) as T
Where 1=1 

                
2014-01-06 18:07:33,259 [45828] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002' And mms_send.BuildPartCode='4'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002' And mms_direct.BuildPartCode='4'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002' And 1=0

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002' And mms_rentin.BuildPartCode='4'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002' And 1=0

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030002' And 1=0

) as T
Where 1=1 

                
2014-01-06 18:07:36,140 [45160] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030002' And mms_send.BuildPartCode='6'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030002' And mms_direct.BuildPartCode='6'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030002' And 1=0

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030002' And mms_rentin.BuildPartCode='6'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030002' And 1=0

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030002' And 1=0

) as T
Where 1=1 

                
2014-01-06 18:07:41,274 [45828] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/report/warehouseaccount')
2014-01-06 18:07:41,760 [45160] DEBUG Mms - 
Select mms_warehouseStockHistory.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStockHistory.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where  mms_warehouse.ProjectCode='201306030002' 
order by mms_warehouseStockHistory.CreateDate desc
                
2014-01-06 18:07:51,304 [45160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/repair/Index','/Mms/repair')
2014-01-06 18:07:51,306 [45160] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:07:51,306 [45160] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:07:51,762 [45828] DEBUG Servicemms_repair - 获取动态列表
2014-01-06 18:07:51,763 [45828] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_repair A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.RepairUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:07:51,776 [45828] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_repair A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.RepairUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:08:22,056 [45612] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/Index','/Mms/rentin')
2014-01-06 18:08:22,059 [45612] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:08:22,059 [45612] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:08:22,447 [45828] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 18:08:22,448 [45828] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2014-01-06 18:08:22,448 [45828] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2014-01-06 18:08:24,785 [45828] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/edit')
2014-01-06 18:08:24,787 [45828] DEBUG Servicemms_rentIn - 获取实体对象
2014-01-06 18:08:24,787 [45828] DEBUG Mms - select mms_rentIn.* from mms_rentIn where  BillNo =  '201307230002'
2014-01-06 18:08:24,787 [45828] DEBUG Servicemms_rentIn - 获取上一条下一条数据
2014-01-06 18:08:24,787 [45828] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:08:24,787 [45828] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:08:24,803 [45828] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:08:24,803 [45828] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo < '201307230002'and ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:08:24,804 [45828] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:08:24,804 [45828] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo >  '201307230002'and ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:08:24,809 [45828] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:08:24,809 [45828] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:08:24,810 [45828] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:08:24,811 [45828] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:08:24,811 [45828] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:08:24,811 [45828] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:08:24,811 [45828] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:08:24,811 [45828] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'BillingUnit'
2014-01-06 18:08:24,812 [45828] DEBUG Servicesys_code - 获取字段
2014-01-06 18:08:24,812 [45828] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'MaterialUse'and IsEnable =  'True'and IsDefault =  'True'
2014-01-06 18:08:25,824 [45828] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:08:25,824 [45828] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2014-01-06 18:08:25,988 [45828] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 18:08:25,988 [45828] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.MerchantsName as UseUnitName
     from 
        mms_rentInDetail A
        left join mms_material B on B.MaterialCode      = A.MaterialCode
        left join mms_merchants C on C.MerchantsCode    = A.UseUnit
     where  BillNo =  '201307230002' order by A.MaterialCode
2014-01-06 18:08:36,783 [45612] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:08:36,790 [45612] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:08:36,790 [45612] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:08:37,277 [45612] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:08:37,277 [45612] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:08:37,298 [45612] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:08:44,442 [45828] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:09:00,582 [43244] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:09:00,605 [43244] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:09:00,666 [43244] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:09:03,371 [45612] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:09:03,791 [45828] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:09:33,403 [45888] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/staff/Index','/Mms/staff')
2014-01-06 18:09:33,408 [45888] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:09:33,408 [45888] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PersonType'
2014-01-06 18:09:34,121 [45888] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/staff'
2014-01-06 18:09:34,164 [45888] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '9960'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
2014-01-06 18:09:34,205 [45888] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/staff'
2014-01-06 18:09:34,205 [45888] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '9960' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
order by ButtonSeq
2014-01-06 18:09:34,844 [45612] DEBUG ServiceREMP_Staff - 获取动态列表
2014-01-06 18:09:34,844 [45612] DEBUG Mms - select top 20 * from REMP_Staff order by EMPSID
2014-01-06 18:09:35,115 [45612] DEBUG Mms - select count(*) from ( select * from REMP_Staff ) tb_temp
2014-01-06 18:09:42,038 [45888] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/liy/Index','/Mms/liy')
2014-01-06 18:09:42,093 [45888] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:09:42,094 [45888] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:09:43,165 [45888] DEBUG Servicetest_liy - 获取动态列表
2014-01-06 18:09:43,165 [45888] DEBUG Mms - select top 20 * from test_liy order by ID
2014-01-06 18:09:43,217 [45888] DEBUG Mms - select count(*) from ( select * from test_liy ) tb_temp
2014-01-06 18:12:30,518 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2014-01-06 18:12:30,521 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:30,521 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:30,522 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:30,522 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 18:12:31,016 [40124] DEBUG Servicemms_direct - 获取动态列表
2014-01-06 18:12:31,016 [40124] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:31,024 [40124] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:12:33,601 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:12:33,603 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:33,604 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:34,111 [44924] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:12:34,111 [44924] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:34,118 [44924] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:12:38,167 [44924] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/return/Index','/Mms/return')
2014-01-06 18:12:38,169 [44924] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:38,169 [44924] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:38,169 [44924] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:38,169 [44924] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:12:38,169 [44924] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:38,170 [44924] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-06 18:12:38,736 [45888] DEBUG Servicemms_return - 获取动态列表
2014-01-06 18:12:38,737 [45888] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:38,792 [45888] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:12:41,885 [44924] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/lossreport/Index','/Mms/lossreport')
2014-01-06 18:12:41,886 [44924] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:41,887 [44924] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:42,370 [42600] DEBUG Servicemms_lossReport - 获取动态列表
2014-01-06 18:12:42,371 [42600] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:42,377 [42600] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:12:44,553 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2014-01-06 18:12:44,557 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:44,557 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:12:44,558 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:44,558 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:45,177 [45888] DEBUG Servicemms_transfer - 获取动态列表
2014-01-06 18:12:45,177 [45888] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:45,187 [45888] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:12:50,218 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-06 18:12:50,226 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:12:50,227 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:12:50,229 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:50,229 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:12:50,229 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:12:50,230 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:12:51,135 [41544] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:12:51,146 [41544] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
2014-01-06 18:12:51,161 [41544] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:12:51,161 [41544] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
order by ButtonSeq
2014-01-06 18:12:51,764 [45828] DEBUG Servicemms_send - 获取动态列表
2014-01-06 18:12:51,765 [45828] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:12:51,776 [45828] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:02,312 [41544] DEBUG Servicemms_send - 获取动态列表
2014-01-06 18:13:02,312 [41544] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.WarehouseCode =  '201306030003'and PriceKind =  '092'and A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:13:02,321 [41544] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.WarehouseCode =  '201306030003'and PriceKind =  '092'and A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:07,577 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-06 18:13:07,629 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:13:07,629 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:13:07,630 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:07,630 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 18:13:09,070 [41544] DEBUG Servicemms_receive - 获取动态列表
2014-01-06 18:13:09,070 [41544] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:13:09,099 [41544] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:18,487 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-06 18:13:18,488 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:13:18,489 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:13:18,489 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:18,489 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:13:18,489 [41544] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:18,489 [41544] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:13:18,506 [41544] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:13:18,507 [41544] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
2014-01-06 18:13:18,507 [41544] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:13:18,508 [41544] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
order by ButtonSeq
2014-01-06 18:13:19,080 [40124] DEBUG Servicemms_send - 获取动态列表
2014-01-06 18:13:19,080 [40124] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:13:19,081 [40124] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:23,410 [41544] DEBUG Servicemms_send - 获取动态列表
2014-01-06 18:13:23,410 [41544] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.WarehouseCode =  '201306030003'and A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:13:23,479 [41544] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.WarehouseCode =  '201306030003'and A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:31,620 [40124] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2014-01-06 18:13:31,621 [40124] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:13:31,621 [40124] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:13:31,621 [40124] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:31,621 [40124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 18:13:32,227 [41544] DEBUG Servicemms_direct - 获取动态列表
2014-01-06 18:13:32,227 [41544] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:13:32,227 [41544] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:13:46,288 [40124] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/edit')
2014-01-06 18:13:46,296 [40124] DEBUG Servicemms_direct - 获取实体对象
2014-01-06 18:13:46,296 [40124] DEBUG Mms - select mms_direct.* from mms_direct where  BillNo =  '201307220010'
2014-01-06 18:13:46,300 [40124] DEBUG Servicemms_direct - 获取上一条下一条数据
2014-01-06 18:13:46,302 [40124] DEBUG Servicemms_direct - 获取字段
2014-01-06 18:13:46,302 [40124] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:13:46,304 [40124] DEBUG Servicemms_direct - 获取字段
2014-01-06 18:13:46,304 [40124] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo < '201307220010'and ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:13:46,306 [40124] DEBUG Servicemms_direct - 获取字段
2014-01-06 18:13:46,306 [40124] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo >  '201307220010'and ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:13:46,308 [40124] DEBUG Servicemms_direct - 获取字段
2014-01-06 18:13:46,308 [40124] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:13:46,324 [40124] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:46,324 [40124] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:13:46,324 [40124] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:46,324 [40124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 18:13:46,325 [40124] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:46,325 [40124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-06 18:13:46,325 [40124] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:13:46,325 [40124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:13:46,325 [40124] DEBUG Servicesys_code - 获取字段
2014-01-06 18:13:46,325 [40124] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-06 18:13:46,327 [40124] DEBUG Servicesys_code - 获取字段
2014-01-06 18:13:46,327 [40124] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2014-01-06 18:13:47,804 [45264] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:13:47,804 [45264] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00304') order by MerchantsCode
2014-01-06 18:13:47,806 [43192] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:13:47,809 [43192] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00519') order by MerchantsCode
2014-01-06 18:13:47,844 [45380] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:13:47,845 [45380] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('6') order by BuildPartCode
2014-01-06 18:13:47,976 [45800] DEBUG Servicemms_direct - 获取动态列表
2014-01-06 18:13:47,976 [45800] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_directDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307220010' order by A.MaterialCode
2014-01-06 18:14:45,091 [45264] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:14:45,098 [45264] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:14:45,098 [45264] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:14:45,241 [41544] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:14:45,243 [41544] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:14:45,243 [41544] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:14:45,769 [46660] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:14:45,769 [46660] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:14:45,777 [46660] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:14:48,128 [46664] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/edit')
2014-01-06 18:14:48,134 [46664] DEBUG Servicemms_refund - 获取实体对象
2014-01-06 18:14:48,134 [46664] DEBUG Mms - select mms_refund.* from mms_refund where  BillNo =  '201306050001'
2014-01-06 18:14:48,135 [46664] DEBUG Servicemms_refund - 获取上一条下一条数据
2014-01-06 18:14:48,135 [46664] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:14:48,135 [46664] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:14:48,136 [46664] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:14:48,136 [46664] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo < '201306050001'and ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:14:48,137 [46664] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:14:48,137 [46664] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo >  '201306050001'and ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:14:48,139 [46664] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:14:48,139 [46664] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:14:48,154 [46664] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:14:48,154 [46664] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:14:48,155 [46664] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:14:48,155 [46664] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:14:49,366 [40124] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:14:49,366 [40124] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00503') order by MerchantsCode
2014-01-06 18:14:49,497 [45264] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:14:49,497 [45264] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.UnitPrice as SrcUnitPrice,C.Num as SrcNum
     from 
        mms_refundDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
        left join mms_sendDetail C on C.BillNo =  A.SrcBillNo and C.RowId = A.SrcRowId
     where  A.BillNo =  '201306050001' order by A.MaterialCode
2014-01-06 18:15:04,667 [46680] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/return/Index','/Mms/return')
2014-01-06 18:15:04,672 [46680] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:15:04,673 [46680] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:15:04,673 [46680] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:04,673 [46680] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:15:04,674 [46680] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:04,674 [46680] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-06 18:15:05,322 [46676] DEBUG Servicemms_return - 获取动态列表
2014-01-06 18:15:05,322 [46676] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:15:05,333 [46676] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:15:14,734 [46664] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/return/Index','/Mms/return')
2014-01-06 18:15:14,735 [46664] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:15:14,735 [46664] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:15:14,736 [46664] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:14,736 [46664] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:15:14,736 [46664] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:14,736 [46664] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2014-01-06 18:15:15,290 [40124] DEBUG Servicemms_return - 获取动态列表
2014-01-06 18:15:15,290 [40124] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:15:15,291 [40124] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName
     from 
        mms_return A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:15:17,971 [45264] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/lossreport/Index','/Mms/lossreport')
2014-01-06 18:15:17,977 [45264] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:15:17,977 [45264] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:15:18,469 [40124] DEBUG Servicemms_lossReport - 获取动态列表
2014-01-06 18:15:18,469 [40124] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:15:18,475 [40124] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:15:20,014 [46664] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2014-01-06 18:15:20,071 [46664] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:20,071 [46664] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:15:20,073 [46664] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:15:20,073 [46664] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:15:20,693 [46676] DEBUG Servicemms_transfer - 获取动态列表
2014-01-06 18:15:20,694 [46676] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:15:20,706 [46676] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:15:22,553 [46676] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/Index','/Mms/rentin')
2014-01-06 18:15:22,562 [46676] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:15:22,562 [46676] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:15:23,056 [45264] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 18:15:23,057 [45264] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2014-01-06 18:15:23,090 [45264] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2014-01-06 18:15:24,999 [46668] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/rentin/edit')
2014-01-06 18:15:25,007 [46668] DEBUG Servicemms_rentIn - 获取实体对象
2014-01-06 18:15:25,007 [46668] DEBUG Mms - select mms_rentIn.* from mms_rentIn where  BillNo =  '201306060001'
2014-01-06 18:15:25,009 [46668] DEBUG Servicemms_rentIn - 获取上一条下一条数据
2014-01-06 18:15:25,009 [46668] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:15:25,009 [46668] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:15:25,012 [46668] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:15:25,012 [46668] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo < '201306060001'and ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:15:25,026 [46668] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:15:25,027 [46668] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo >  '201306060001'and ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:15:25,028 [46668] DEBUG Servicemms_rentIn - 获取字段
2014-01-06 18:15:25,028 [46668] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:15:25,032 [46668] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:25,032 [46668] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:15:25,036 [46668] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:25,036 [46668] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:15:25,037 [46668] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:15:25,037 [46668] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'BillingUnit'
2014-01-06 18:15:25,038 [46668] DEBUG Servicesys_code - 获取字段
2014-01-06 18:15:25,038 [46668] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'MaterialUse'and IsEnable =  'True'and IsDefault =  'True'
2014-01-06 18:15:26,142 [46664] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:15:26,143 [46660] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:15:26,143 [46664] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00302') order by MerchantsCode
2014-01-06 18:15:26,143 [46660] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('3') order by BuildPartCode
2014-01-06 18:15:26,344 [46676] DEBUG Servicemms_rentIn - 获取动态列表
2014-01-06 18:15:26,344 [46676] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.MerchantsName as UseUnitName
     from 
        mms_rentInDetail A
        left join mms_material B on B.MaterialCode      = A.MaterialCode
        left join mms_merchants C on C.MerchantsCode    = A.UseUnit
     where  BillNo =  '201306060001' order by A.MaterialCode
2014-01-06 18:17:11,636 [44092] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-01-06 18:17:11,969 [44432] DEBUG Servicesys_organize - 获取实体列表
2014-01-06 18:17:11,969 [44432] DEBUG Sys - select sys_organize.* from sys_organize
2014-01-06 18:17:11,971 [45404] DEBUG Servicesys_user - 获取实体列表
2014-01-06 18:17:12,113 [45404] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2014-01-06 18:17:12,221 [45404] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-01-06 18:17:15,948 [46532] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'scy'
2014-01-06 18:17:20,950 [46664] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'scy'
2014-01-06 18:17:26,062 [44432] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-06 18:17:26,070 [44432] DEBUG Servicesys_user - 获取动态列表
2014-01-06 18:17:26,070 [44432] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-06 18:17:26,071 [44432] DEBUG Servicesys_organize - 获取动态列表
2014-01-06 18:17:26,072 [44432] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-06 18:17:26,361 [44432] DEBUG Servicesys_role - 获取实体列表
2014-01-06 18:17:26,362 [44432] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-06 18:17:28,407 [46532] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-06 18:17:28,409 [46532] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-06 18:17:28,439 [44432] DEBUG Servicesys_permission - 获取动态列表
2014-01-06 18:17:28,440 [44432] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-06 18:17:28,571 [46532] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-06 18:17:51,353 [46532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-01-06 18:17:51,364 [46532] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:17:51,364 [46532] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:17:51,366 [46532] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:17:51,366 [46532] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2014-01-06 18:17:51,927 [45340] DEBUG Servicemms_receive - 获取动态列表
2014-01-06 18:17:51,927 [45340] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:17:51,997 [45340] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:17:59,743 [46532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-01-06 18:17:59,749 [46532] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:17:59,749 [46532] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:17:59,749 [46532] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:17:59,750 [46532] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2014-01-06 18:17:59,750 [46532] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:17:59,750 [46532] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2014-01-06 18:17:59,768 [46532] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:17:59,770 [46532] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
2014-01-06 18:17:59,853 [46532] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-01-06 18:17:59,854 [46532] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
order by ButtonSeq
2014-01-06 18:18:00,500 [46464] DEBUG Servicemms_send - 获取动态列表
2014-01-06 18:18:00,500 [46464] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:18:00,510 [46464] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:18:03,457 [46532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:18:03,464 [46532] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:18:03,464 [46532] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:18:04,049 [44432] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:18:04,049 [44432] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:18:04,058 [44432] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:18:06,275 [45340] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/edit')
2014-01-06 18:18:06,281 [45340] DEBUG Servicemms_refund - 获取实体对象
2014-01-06 18:18:06,281 [45340] DEBUG Mms - select mms_refund.* from mms_refund where  BillNo =  '201306050001'
2014-01-06 18:18:06,284 [45340] DEBUG Servicemms_refund - 获取上一条下一条数据
2014-01-06 18:18:06,285 [45340] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:18:06,285 [45340] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:18:06,286 [45340] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:18:06,286 [45340] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo < '201306050001'and ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:18:06,287 [45340] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:18:06,287 [45340] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo >  '201306050001'and ProjectCode =  '201306030002' order by BillNo
2014-01-06 18:18:06,288 [45340] DEBUG Servicemms_refund - 获取字段
2014-01-06 18:18:06,288 [45340] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030002' order by BillNo desc
2014-01-06 18:18:06,289 [45340] DEBUG Servicesys_code - 获取动态列表
2014-01-06 18:18:06,289 [45340] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2014-01-06 18:18:06,291 [45340] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:18:06,291 [45340] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:18:07,434 [45340] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:18:07,434 [45340] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00503') order by MerchantsCode
2014-01-06 18:18:07,570 [44432] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:18:07,570 [44432] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.UnitPrice as SrcUnitPrice,C.Num as SrcNum
     from 
        mms_refundDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
        left join mms_sendDetail C on C.BillNo =  A.SrcBillNo and C.RowId = A.SrcRowId
     where  A.BillNo =  '201306050001' order by A.MaterialCode
2014-01-06 18:18:25,044 [46532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2014-01-06 18:18:31,546 [46732] DEBUG Sys - SELECT Name as TableName FROM sys.tables order by Name
2014-01-06 18:18:31,546 [46464] DEBUG Sys - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('undefined')
ORDER BY sys.columns.column_id
2014-01-06 18:18:32,413 [46796] DEBUG Sys - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('undefined')
ORDER BY sys.columns.column_id
2014-01-06 18:20:23,754 [36804] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:20:28,244 [45336] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:20:28,247 [45336] DEBUG Sys - update sys_userSetting set [SettingValue] = 'menubutton' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:20:28,249 [45336] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:20:32,224 [45188] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:20:32,578 [36804] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:20:39,705 [45072] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:20:45,445 [47068] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:20:45,446 [47068] DEBUG Sys - update sys_userSetting set [SettingValue] = 'tree' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:20:45,449 [47068] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:20:47,347 [46796] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:20:47,750 [46736] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:22:27,877 [45336] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:22:33,216 [43204] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'super' and [SettingCode] = 'theme'
2014-01-06 18:22:33,220 [43204] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'super' and [SettingCode] = 'navigation'
2014-01-06 18:22:33,223 [43204] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'super' and [SettingCode] = 'gridrows'
2014-01-06 18:22:34,473 [45336] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:22:34,900 [46796] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-01-06 18:22:39,198 [45784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2014-01-06 18:22:39,205 [45784] DEBUG Servicemms_warehouse - 获取动态列表
2014-01-06 18:22:39,208 [45784] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030002'
2014-01-06 18:22:39,711 [46156] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:22:39,711 [46156] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' order by A.BillNo
2014-01-06 18:22:39,719 [46156] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030002' ) tb_temp
2014-01-06 18:23:00,613 [44048] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:23:00,614 [44048] DEBUG Mms - select top 10 BillNo from mms_refund where  BillNo like '1%'
2014-01-06 18:23:01,146 [45784] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:23:01,146 [45784] DEBUG Mms - select top 10 BillNo from mms_refund where  BillNo like '11%'
2014-01-06 18:23:01,393 [43204] DEBUG Servicemms_refund - 获取动态列表
2014-01-06 18:23:01,393 [43204] DEBUG Mms - select top 10 BillNo from mms_refund where  BillNo like '111%'
2014-01-06 18:23:07,554 [45784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-01-06 18:23:07,568 [45784] DEBUG Servicesys_user - 获取动态列表
2014-01-06 18:23:07,568 [45784] DEBUG Sys - select UserCode,UserName from sys_user
2014-01-06 18:23:07,595 [45784] DEBUG Servicesys_organize - 获取动态列表
2014-01-06 18:23:07,595 [45784] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-01-06 18:23:07,912 [45456] DEBUG Servicesys_role - 获取实体列表
2014-01-06 18:23:07,912 [45456] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-01-06 18:23:09,502 [46988] DEBUG Servicesys_permission - 获取动态列表
2014-01-06 18:23:09,502 [46360] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-01-06 18:23:09,502 [46988] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-01-06 18:23:09,507 [46360] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-01-06 18:23:09,634 [46360] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-01-06 18:23:26,124 [45784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-01-06 18:23:26,438 [45336] DEBUG Servicesys_permission - 获取动态列表
2014-01-06 18:23:26,438 [45336] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-01-06 18:23:59,516 [45456] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2014-01-06 18:24:02,378 [44484] DEBUG ServiceModelBase - 获取动态列表
2014-01-06 18:24:02,378 [44484] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2014-01-06 18:24:02,379 [44484] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2014-01-06 20:50:53,782 [58748] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-01-06 20:51:06,041 [59204] DEBUG Servicesys_parameter - 获取实体列表
2014-01-06 20:51:06,091 [59204] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2014-01-06 20:51:06,212 [59204] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-01-06 20:53:32,637 [59128] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-01-06 20:53:33,649 [59048] DEBUG Servicesys_codeType - 获取动态列表
2014-01-06 20:53:33,668 [59048] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-01-06 20:53:33,955 [58676] DEBUG Servicesys_code - 获取实体列表
2014-01-06 20:53:33,955 [58676] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-01-06 20:53:34,072 [58676] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-01-06 20:53:39,900 [59128] DEBUG Servicesys_code - 获取实体列表
2014-01-06 20:53:39,905 [59128] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'ImagePart' order by Seq
2014-01-06 20:53:39,920 [59128] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'ImagePart' ) tb_temp
2014-01-06 20:53:41,505 [59048] DEBUG Servicesys_code - 获取实体列表
2014-01-06 20:53:41,505 [59048] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'StockState' order by Seq
2014-01-06 20:53:41,544 [59048] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'StockState' ) tb_temp
2014-01-06 20:55:23,535 [58756] DEBUG Servicesys_code - 获取实体列表
2014-01-06 20:55:23,536 [58756] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'QualificationLevel' order by Seq
2014-01-06 20:55:23,596 [58756] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'QualificationLevel' ) tb_temp
2014-01-06 20:55:25,325 [59332] DEBUG Servicesys_code - 获取实体列表
2014-01-06 20:55:25,325 [59332] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'BuildingCategories' order by Seq
2014-01-06 20:55:25,330 [59332] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'BuildingCategories' ) tb_temp
